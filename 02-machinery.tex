\chapter{Geometric Preliminaries}

\section{Null Conjugate Points}
((Leave this here?))
\begin{definition}[Null Conjugate Point]
    Let $\gamma_{q,w}:[0,b]\to M$ be a null geodesic. We then call $p=\gamma_{q,w}(b)$ a \emph{null conjugate point} if there exists a nontrivial variation $\x:[0,b]\times(-\varepsilon,\varepsilon) \to M$ of $\gamma_{q,w}$ through null geodesics such that $\x_v(b,0)=0$.
\end{definition}

We have the following useful characterization:
\begin{proposition}
    Let $\gamma_{q,w}:[0,b]\to M$ be a null geodesic. Then $p=\gamma_{q,w}(b)$ is a null conjugate point if and only if $\exp_q:L_qM\to M$ is singular at $bw$, i.e. if there exists a nonzero $\xi\in T_{bw}(L_qM)$ such that $d\exp_q(\xi)=0$.
\end{proposition}
\begin{proof}
    We begin by proving the backwards direction and to that end assume that there exist a nonzero $\xi\in T_{bw}(L_qM)$ such that $d\exp_q(\xi)=0$. By the construction of the tangent space there thus exists a non-constant path $\xi:(-\varepsilon,\varepsilon)\to L_qM$ with $\xi(0)=bw$. This allows us to construct the variation $\x(u,v)=\exp_q(\frac{u}{b}\xi(v))$ which has $\x(t,0)=\gamma_{q,w}(t)$ and is a variation through null geodesics. Finally we have $\x_v(b,0)=d\exp_q(\xi)=0$ by the chain rule.

    For the other direction we first note that by definition $\x(u,v)=\exp_q(u\x_u(0,v))$ and $\x_u(0,v)\in L_qM$ as $\x$ is a variation through \emph{null} geodesics. 
    Now again by the chain rule we have $0=\x_v(b,0) = d\exp_q\rvert_{bw} \circ \frac{d}{dv}(bx_u(0,v))\rvert_{v=0}$. But since $\xi := \frac{d}{dv}(bx_u(0,v))\rvert_{v=0} \in T_{bw}(L_qM)$ we are done.
\end{proof}

Null conjugate points are also conformal invariants:
\begin{proposition}
    Let $\Phi:(M,g)\to (N,h)$ be a conformal diffeomorphism and $\gamma:[0,b]\to M$ a null geodesic. Then $\gamma(b)$ is a null conjugate point of $\gamma$ if and only if $\Psi(\gamma(b))$ is a null conjugate point of $\Psi \circ \gamma$.
\end{proposition}
\begin{proof}
    ((Cite relevant prop))
    Because of the symmetry of the situation we only need to prove one direction and suppose that $\gamma(b)$ is a null conjugate point of $\gamma$. We thus have a variation $\x$ of $\gamma$ through null geodesics. But since $\Phi$ maps null geodesics to null geodesics, $\Phi\circ \x$ is a variation of $\Phi \circ \gamma$ through null geodesics in $N$, which implies that $\Phi(\gamma(b))$ is a null conjugate point of $\Phi \circ \gamma$.
\end{proof}

\section{Geometry of the Light Cone Observations}
From now on $(M,g), K, V, p^+,p^-$ be as in theorem \ref{thm:intreconstr} (we suppress the indices to simplify notation). ((More explanation))

\subsection{Parameterization of Observations}
\begin{lemma}\label{lem:Kcharact}
    We have:
    \begin{enumerate}[label={\textnormal{(\arabic*)}}]
        \item $K=\jp\setminus I^-(p^+)$,
        \item There exists a surjective smooth map $\Theta:S^{n-1}\times[0,1] \to K$ such that the curves $\mu_a:=t\mapsto\Theta(a,t), a\in S^n$ are null geodesics, 
        \[\Theta(S^{n-1}\times\{1\}) = \{p^+\}, \quad R:=\Theta(S^{n-1}\times\{0\}) = K \setminus I^+(p^-)\]
        and $\Theta:S^{n-1}\times[0,1)\to K\setminus p^+$ is a diffeomorphism.
        \item $\mc{L}^-_{p^+}\cap V = \emptyset$ and $\mc{L}^-_{p} \cap V = \emptyset \quad \forall p\in R$.
        % \item There exist $0<t_-<t_+<1$ such that the restriction $\Psi\rvert_{S^n\times[t_-,t_+]}$ is a diffeomorphism onto its image and that for all $v \in S^n$, we have 
        % \[
        % \Psi(v,t_-) \notin \bigcup_{q\in \overline{V}} J^+(q), \quad \Psi(v,t_+) \in \bigcap_{q\in \overline{V}} J^+(q).
        % \]
    \end{enumerate}
\end{lemma}
\begin{proof}
(1) We first rewrite $\jp\setminus I^-(p^+)=(J^-(p^+)\setminus I^-(p^+))\cap J^+(p^-)$ and immediately get $(J^-(p^+)\setminus I^-(p^+))\cap J^+(p^-)\subset \mc{L}^-_{p^+}\cap J^+(p^-)=K$ as $J^-(p^+)\setminus I^-(p^+)\subset \mc{L}^-_{p^+}$. For the other inclusion we note that by assumption for $p\in K$ we have $\tau(p,p^+)=0$ and $p\in \mc{L}_{p^-}^-$. This implies $p\in J^-(p^+)\setminus I^-(p^+)$. Furthermore $p\in K$ also implies $p\in J^+(p^-)$. Putting this together we get $p\in (J^-(p^+)\setminus I^-(p^+))\cap J^+(p^-)$ proving the equality.

For (2) we first note that $p^-\notin K$ because $p^+\gg p^-$ implies $\tau(p^-,p^+)>0$ which would make $p^-$ a cut point were it in $K$, violating our assumption. Thus also $p^-\notin \mc{L}^-(p^+)$. This implies that $\mc{L}^-_{p^+}$ and $\mc{L}^+_{p^-}$ are transversal.

Next we note that the exponential map
\[
    \exp_{p^+}:L^-_{p^+}M \simeq \sn \times \R_+ \to \mc{L}^-_{p^+}
\]
is smooth and surjective. 

We now aim to construct a smooth surjecive map $\theta:\sn \times [0,1] \to \exp^{-1}_{p^+}(K)$ which is a diffeomorphism on $\sn \times [0,1)$. To that end we look at the set of \emph{unit null directions} 
\[
    CL^-_{p^+}M:=\{v\in L^-_{p^+}M \mid \lVert v \rVert_{g^+}=1\}\simeq \sn
\] 
for some riemannian metric $g^+$ on $M$. By ((Leavescompact)) for a given null direction $v \in CL^-_{p^+}M$ there exists a $s_v>0$ such that $\gamma_{p^+,v}(s_v) \in J^+(p^-)$ but $\gamma_{p^+,v}(s') \notin J^+(p^-)$ for all $s'>s_v$. Furthermore for any $s'\le s_\mu$ we have $\gamma_{p^+,v}(s')\in J^+(p^-)$ because we can append the lightlike path from $p^-$ to $\gamma_{p^+,v}(s_v)\in J^+(p^-)$ to $\gamma_{p^+,v}\rvert_{[s',s_v]}$ and get a lightlike path from $p^-$ to $\gamma_{p^+,v}(s')$. We also have $\gamma_{p^+,v}(t_v)\notin I^+(p^-)$ because $I^+(p^-)$ is open which would imply the existence of a $t'>t_v$ such that $\gamma_{p^+,v}(t')\in I^+(p^-)\subset J^+(p^-)$ violating the maximality of $t_v$. Finally, because $\exp_{p^+}$ is transverse to $\mc{L}^+_{p^-}$, $exp_{p^+}^-1(\mc{L}^+_{p^-})$ is a smooth submanifold of $L^-_{p^+}M$, by lemma \ref{lem:transmap}. This implies that the map that $v\mapsto t_v$ is smooth.

We now define 
\begin{align*}
    \theta:\sn\times[0,1] &\to \exp^{-1}_{p^+}(K)\\
    (v,t)&\mapsto (1-t)s_vv
\end{align*}
where we used $CL^-_{p^+}\simeq\sn$ to identify $v\in \sn$ with the corresponding $v\in CL^-_{p^+}$.
Using the results from the above paragraph it follows that $\theta$ is well-defined and has the desired properties. 

We now set $\Theta:=\exp_{p^+}\circ \; \theta$, which satisfies all properties in (2) and are done with this part.

Finally, for part $(3)$ we assume there exists a $p\in \mc{L}^-_{p^+}\cap V$. Recall that $V\subset \interior{\jp}=I^+(p^-)\cap I^-(p^+)$. We thus have $p\in I^+(p^-)\subset J^+(p^-)$, which together with $p\in \mc{L}^-_{p^+}$ implies $p\in K$. But now we have $p\in I^-(p^+)$ and $p\in K$, a contradiction to (1).

Now we assume that there exists a $p_0\in R$ and $p\in \mc{L}^-_{p_0}\cap V$. Any $p_0\in R$ must be in $\mc{L}^\pm_{p^-}$. If $p\in \mc{L}^-_{p^-}$ it cannot be in $I^+(p^-)$. Thus $p\in \mc{L}^+_{p^-}$. Furthermore we have $p\in I^-(p^+)\subset J^-(p^+)$ and $\tau(p^-,p)>0$ because $p\in I^+(p^-)$. But this implies that $p^-$ has a cut point in $\mc{L}^+_{p^-}\cap J^-(p^+)$. A contradiction because $p^-$ and $p^+$ were assumed to be suitable.
\end{proof}

Note that this implies that $K$ is a smooth $n$-dimensional submanifold of $M$ at any point away from its boundary. We will often treat $K$ itself as a submanifold when it is clear that we are working away from the boundary. This is often the case as by (3) no null geodesic originating from the interior of $\jp$ can reach $p^+$ or $R$, i.e. the boundary of $K$.

Furthermore by the properties of $\Theta$ we have 
\begin{align}
    \mu_a([0,1])\cap \mu_{a'}([0,1]) &= \{p^+\} \text{ for } a\neq a'\in \sn \text{ and }\\
    \bigcup_{a\in \sn}\mu_a([0,1]) &= K
\end{align}
% The next proposition allows us to endow $K$ with a number of \enquote{laboratory frames} we will use to conveniently describe the light cone observations on $K$.
% \begin{proposition}[Laboratory Frames]
% Let $(M_j,g_j), K_j, V_j, p_j^+,p_j^-, \Phi$ be as in the statement of theorem \ref{thm:babycase}
% Then there exists a family of future pointing, null geodesics $\mu_a^{(1)}:[0,1]\to K_1$ indexed by $a\in \mathcal{A}$ where $\mathcal{A}$ is a metric space. Furthermore we can require the map $[0,1]\times\mathcal{A}\to K_1; (s,a)\mapsto \mu^{(1)}_a(s)$ to be open ((almost, needed?)) and continuous. If we then take $\mu^{(2)}_a\coloneqq\Phi(\mu^{(1)}_a)$ we can achieve
% \begin{equation}\label{eq:frameunion}
% K_j = \bigcup_{a\in \mathcal{A}}\mu^{(j)}_a([0,1]).
% \end{equation}
% \end{proposition}
% \begin{proof}
% ((TODO))
% \end{proof}

% \begin{remark}\label{rmk:data}To simplify notation we will continue with the construction on just one Lorentzian manifold $(M,g)$ of dimension $1+n$ and assume that we are given the following data to construct the required conformal diffeomorphism ((explain better)) from theorem \ref{thm:babycase}.

% \begin{enumerate}
%     \item A the quasi-manifold $K$,
%     \item the conformal class of $g\rvert_K$ (but not only restricted to tangent vectors in $K$ ((i think??)) ),
%     \item the paths $\mu_a:[0,1]\to K, a\in \mathcal{A}$,
%     \item the set $\mathcal{P}_K(V)$ where $V$ is open and $\overline{V}\subset \operatorname{int} J(p^-,p^+)$ is compact.
% \end{enumerate}
% Note that these data are invariant under conformal diffeomorphism, and any map we construct from it will thus also be invariant. We also remark that $\overline{V}\subset \operatorname{int} J(p^-,p^+)$ implies that $q\notin K$ for any $q\in \overline{V}$. 
% \end{remark}

\subsection{Geometry of Light Observation Sets}


\begin{lemma}\label{prop:transversality}
For any $q\in V$ the restriction of the exponential map to null vectors $\exp_q:L^+_qM\to M$ is \emph{transverse} to $K$, i.e. for all $w\in L^+_qM$ such that $\gamma_{q,w}(1) = p\in K$ we have $\gamma'_{q,w}(1)\notin T_pK$.
\end{lemma}
\begin{proof}
    In order to achieve a contradiction we assume that there exists a $q\in V$ and a $w\in L^+_qM$ such that with $v:=\gamma_{q,w}(1)\in L_pK$.
    Since $K$ is generated by backwards null geodesics originating at $p^+$ there exists a $u\in L^-_{p^+}M$ such that there exists a $t\in \R_+$ with $\gamma_{p^+,u}(t)=p, \gamma'_{p^+,u}(t)=-v$. We can thus obtain an unbroken past-pointing null geodesic from $p^+$ to $q$ by connecting $\gamma_{p^+,u}$ and $\gamma_{p,-v}$. But this implies that $q\in \mc{L}^-_{p^+}$ which is a contradiction to \ref{lem:Kcharact}(3).

    We now prove that this implies that $\exp_q:L^+_qM\to M$ is transverse to $K$. We need to show that for every $w\in L^+_qM$ with $\exp_q(w)=p\in K$ we have 
    \[
        \im(d\exp_q\rvert_w) \oplus T_pK = T_pM.
    \]
    As $T_pK$ is a null hypersurface we only need to prove that $\im(d\exp_q\rvert_w)$ contains a null vector which is not a multiple of the null vector $v\in T_pK$ generating $T_pK = v^\perp$. But by the properties of the exponential map, $\im(d\exp_q\rvert_w)$ contains $v' = \gamma'_{q,w}(1) \in T_pM$. And since we just proved that $v'\notin T_pK$, $v+v'$ must be a timelike vector and $\im(d\exp_q\rvert_w) \oplus T_pK = T_pM$, as desired.
\end{proof}


This lemma closely resembles lemma 2.5 in \cite{hintzpaper} with only minor adjustments to adapt it to our case. It is reproduced here for the sake of completeness.
This lemma will allow us to reconstruct the direction of incoming light rays at point in $\mc{P}_K(q)$ which will locally correspond to the spacelike hypersurface.
\begin{lemma}[Direction Reconstruction]\label{lem:dirreconstr}
Let $p\in K$ then there exists a bijection $\Phi$ between the space $\mc{S}$ of spacelike hyperplanes $S\subset T_pK$ and the space $\mc{V}$ of rays $\R_+V\subset T_pM$ along future-directed outward facing null vectors, given by the mapping $S\in \mc{S}$ to the unique future-directed outward pointing null ray $\Phi(S)$ contained in $S^\perp$. The inverse map is given by $\mc{V}\ni \R_+V \mapsto T_pK \cap V^\perp\in \mc{S}$.

Moreover there exists a bijection between $\mc{S}$ and the space $\mc{N}$ of linear null hypersurfaces $N\subset T_pM$ which contain a future-directed outward pointing null vector given by $\mc{S}\ni S\mapsto S\oplus \operatorname{span} \Phi(S)\in \mc{N}$.
\end{lemma}
\begin{proof}
    Let $p\in K$, and $S\subset T_pK$ be a spacelike hyperplane. The orthogonal complement $S^\perp\subset T_pM$ then is a two-dimensional lorentzian subspace. Hence there exist four light rays which are multiples of the vectors $V,-V,W,-W$ in $S^\perp$, where we WLOG assume that $V$ and $W$ are future-pointing. Since $T_pK=v^\perp$ for some future-pointing null vector $v\in T_pK$, we have $v\in S^\perp$ and can WLOG assume $\R_+W=\R_+v$, i.e. $\R_+W$ is the ray pointing along the null hypersurface $K$. This leaves $\R_+V$ as the unique future-pointing outward null ray which is perpendicular to $S$, and we can thus set $\Phi(S)=\R_+V$.

    For to prove $\Phi$ is a bijection, we let $0\neq V\in T_pM$ be an outward future-pointing null vector. In particular this means that $V\notin T_pK$. Thus $S=V^\perp\cap T_pK$ is a spacelike hyperplane in $T_pK$ which satisfies $S=\Phi^{-1}(V)$.

    For the last claim we note that the map $\mc{N}\ni N \mapsto N^\perp \cap L^+_pM \in \mc{V}$ maps a null hypersurface $N$ to the unique ray along a future-pointing outward null generator of $N$. The inverse of this map is given by $\mc{V}\ni \R_+V\mapsto V^\perp \in \mc{N}$. Composition of these maps with $\Phi$ yields the desired bijection $\mc{N}\to \mc{S}$.
\end{proof}

\begin{lemma}\label{lem:hitsonce}
    For $q\in V$ and $w\in L^+_qM$ there exists exactly one $t_w\in (0,\infty)$ such that $\gamma_{q,w}(t_w)\in K$.
\end{lemma}
\begin{proof}
    Let $q\in V$ and $w\in L^+_qM$, by ((Leavescompact)) any geodesic starting in the compact set $J(p^-,p^+)$ must eventually leave it, intersecting the boundary. As $K$ is the future boundary of $\jp$ there exists at least one $t_w\in (0,\infty)$ with $p=\gamma_{q,w}(t_w)\in K$. We now show $\gamma_{q,w}(t')\notin K$ for any other $t'\neq t_w$.

    First let us consider the case $t'<t_w$. We can then append $\gamma_{q,w}\rvert_{[t',t_w]}$ to the path $\mu_a\rvert_{[s,1]}$, whre $a\in \sn, s\in [0,1]$ such that $\mu_a(s)=p$, to get a broken lightlike path from $\gamma_{q,w}(t')$ to $p^+$. The fact that this path must be broken follows from the transversality proven in the previous lemma. But the existence of this broken path implies $\tau(\gamma_{q,w}(t'),p^+)>0$ and thus $\gamma_{q,w}(t')\in I^-(p^+)$. But as $K=\jp\setminus I^-(p^+)$ we have $\gamma_{q,w}(t')\notin K$

    Conversely we now assume $t'>t_w$. Again by the transversality of $\gamma_{q,w}$ to $K$ we get that for $t'-t_w>\varepsilon>0$ small enough we have $\gamma_{q,w}(t_w+\varepsilon)\notin \jp=J^+(p^-)\cap J^-(p^+)$ because $K$ is the future boundary of $\jp$. As any point on $\gamma_{q,w}$ is in $J^+(p^-)$ we must have have $\gamma_{q,w}(t_w+\varepsilon) \notin J^-(p^+)$, i.e. there exists no lightlike path from $\gamma_{q,w}(t_w+\varepsilon)$ to $p^+$. But if $\gamma_{q,w}(t')\in J^-(p^+)$ there exists a path $\sigma$ from $\gamma_{q,w}(t')$ to $p^+$ and we could construct a lightlike path from $\gamma_{q,w}(t_w+\varepsilon)$ to $p^+$ by appending $\gamma_{q,w}\rvert_{[t_w+\varepsilon,t']}$ to  $\sigma$, a contradiction. We thus have $\gamma_{q,w}(t')\notin J^-(p^+)\supset\jp\supset K$, completing the proof.
\end{proof}


\begin{definition}[Observation Preimage]
For any $q\in V$ with light observation set $\mc{P}_K(q)\subset K$ we define the \emph{observation preimage} $L^K_qM$ to be the preimage of $K$ under the exponential map restricted to $L^+_qM$, i.e. 
\begin{align*}
    L^K_qM := (\exp_q\rvert_{L^+_qM})^{-1}(K) \subset L^+_qM
\end{align*}
\end{definition}
\begin{lemma}\label{lem:preimage}
For any $q\in V$, the observation preimage $L^K_qM$ is a $n-1$-dimensional submanifold of $L^+_qM$. 

Furthermore, for any $w\in L^K_qM$ there exist a relatively open neighborhood $O_w\subset L^K_qM$ such that $\exp_q:O_w\to U_w:=\exp_q(O_w)\subset \mc{P}_K(q)$ is a diffeomorphism.
\end{lemma}
\begin{proof}
    By lemma \ref{prop:transversality}, $\exp_q:L^+_qM\to M$ is transverse to $K$ (here we treat $L^+_qM$ and $K$ as submanifolds, because by lemma \ref{lem:Kcharact}(3) we can disregard the boundary points). Thus by the preimage lemma \ref{lem:transmap} $ L^K_qM := (\exp_q\rvert_{L^+_qM})^{-1}(K)$ is a $n-1$-dimensional submanifold of $L^+_qM$.

    For the second part let $w\in L^K_qM$, since $p:=\exp_q(w)\in K$ and we assumed that such a $p$ cannot be a null conjugate point, we know that $\exp_q:L^+_qM\to M$ has an invertible differential at $w$. Thus, by the implicit function theorem, there exists an open neighborhood $O_w'\subset L^+_qM$ of $w$ such that $\exp_q:O_w'\to \exp_q(O_w')$ is a diffeomorphism. If we then restrict $\exp_q$ to $O_w:=O_w' \cap L^K_qM$ the map is still a diffeomorphism as desired.
\end{proof}
Note that by the invariance of domain theorem $U_w$ is an open submanifold of $\mc{P}_K(q)$

\begin{corollary}\label{cor:lksn}
    The map 
    \begin{align*}
        \sn \simeq CL^+_qM &\to L^K_qM\\
        w &\mapsto t_ww
    \end{align*}
    where $t_w$ is as in \ref{lem:hitsonce}, is a diffeomorphism.
\end{corollary}
\begin{proof}
    This result follows immediately from lemma \ref{lem:hitsonce} together with the fact that since $K$ is (away from its boundary) a smooth submanifold, the map $w\mapsto t_w$ is smooth.
\end{proof}

\begin{lemma}\label{lem:finitevecs}
    Let $q\in V$ and $p\in \mc{P}_K(q)$ then there exist only finitely many $w_1,\dots,w_N\in L^K_qM$ such that $\exp_q(w_i)=p$. Furthermore for $O_{w_i}$ as in the previous lemma such that $\exp_q:O_{w_i}\to U_{w_i}$ is a diffeomorphism, there exists an open neighborhood $U\subset \mc{P}_K(q)$ of $p$ such that 
    \[
        \exp^{-1}_{q}(U)\cap L^K_qM \subset \bigcup_{i=1}^N O_{w_i}
    \]
    
    %for any neighborhood $W\subset L^K_qM$ of $v_1,\dots,v_n$, there exists a %neighborhood $U\subset \mc{P}_K(q)$ of $p$ such that $\exp^{-1}_q(U) \cap L^+_qM %\subset W$. 
\end{lemma}
\begin{proof}
    Note that the previous corollary immediately yields that $L^K_qM$ is compact.
    Let $q\in V$, $p\in \mc{P}$. We first remark that, by the previous lemma, for any $w\in \exp^{-1}_q(p) \cap L^K_qM$ there exist open neighborhoods $w\in O_w\subset L^K_qM$ and $p\in U_w=\exp_q(O_w)\subset \mc{P}_K(q)$ making $\exp_q:O_w\to U_w$ a diffeomorphism.

    To show that there can only be finitely many $w\in L^K_qM$ with $\exp_q(w)=p$ we let
    \[
        C:=\exp_q^{-1}(p)\cap L^K_qM.
    \] 
    As $M$ is hausdorff, ${p}$ is closed and because $\exp_q$ is continuous, so is $C$. Now $C\subset L^K_qM$ is a closed subset of a compact space, making $C$ itself compact as well. Now the family $\{O_w \mid w\in \exp^{-1}_q(p)\cap L^K_qM\}$ is an open cover of $C$. But because $C$ is compact there must exist a finite subcover such that 
    \[
        C\subset O:= \bigcup_{i=1}^N O_{w_i}.
    \]
    We can now make some observations: By definition, for any $w\in L^K_qM\setminus C$ we have $\exp_q(w)\neq p$. And as $\exp_q$ is a diffeomorphism on $O_{w_i}$ for all $i=1,\dots, N$, it must be injective and we get $\exp^{-1}_q(p)\cap O_{w_i}=\{w_i\}$. We thus have 
    \[
        \exp_q^{-1}(p) \cap O = \{w_1,\dots, w_N\}.
    \]
    Furthermore, as $C\subset O$ for any $p\in L^K_qM\setminus O \subset L^K_qM \setminus C$ we still have $\exp_q(w)\neq p$. In other words: 
    \[
        \exp_q^{-1}(p)\cap L^K_qM\setminus O=\emptyset.
    \]
    Putting these two observations together we get 
    \[
        \exp_q^{-1}(p)\cap L^K_qM = \{w_1,\dots, w_N\},
    \]
    as desired.

    To show the second part we denote
    \[
        L^\times := L^K_qM \setminus O \quad \text{ and have } L^\times \cap \exp^{-1}_q(p) = \emptyset.
    \]
    Note that $L^\times$ is a closed and thus compact subset of $L^K_q$. We then endow $M$ with an arbitrary metric $d$ compatible with its topology. 
    This lets us define the continuous function 
    \begin{align*}
        g:L^\times &\to \R\\
        w &\mapsto d(\exp_q(w),p).
    \end{align*}
    Because $L^\times \cap \exp^{-1}_q(p) = \emptyset$ we have $g(w)>0$ for all $w\in L^\times$. But now, as $L^\times$ is compact there exists a $\varepsilon>0$ such that $g(w)=d(\exp_q(w),p)>\varepsilon$ for all $w\in L^\times$. We can now choose
    \[
        U := B_\varepsilon(p) \cap \mc{P}_K(q)
    \] and get an open neighborhood of $p$ in $\mc{P}_K(q)$ with $\exp^{-1}(U)\cap L^\times = \emptyset$. But this means 
    \[
        \exp^{-1}_q(U) \cap L^K_qM = O = \bigcup_{i=1}^N O_{w_i}
    \]
    completing the proof.

    \newpage
\end{proof}


We can immediately put these lemmas to use and prove this proposition characterizing the light observation set.
\begin{proposition}\label{prop:unionmanif}
Let $q\in V$ and $p\in \mc{P}_K(q)$. There exists an open neighborhood $p\in U\subset \mc{P}_K(q)$, a positive integer $N$ and $N$ pairwise transversal, spacelike, codimension 1 submanifolds $\mc{U}_i\subset K$ such that $\mc{P}_K(q) \cap U = \bigcup_{i=1}^N \mc{U}_i$ and $p\in \mc{U}_i$ for $i={1,\dots, N}$.
\end{proposition}
\begin{proof}
    Let $q\in V$ and $p\in \mc{P}_K(q)$. By the previous lemma we know that there can only be finitely many $w_1,\dots,w_n\in L^K_qM$ with $\exp_q(w_i)=p$. 

    By lemma \ref{lem:preimage}, for each $w_i$ there exists a neighborhood $O_{w_i}\subset L^K_qM$ of $w_i$ such that $\exp_q:O_{w_i}\to U_{w_i}:=\exp_q(O_{w_i})$ is a diffeomorphism. Thus $U_{w_i}\subset \mc{P}_K(q)$ is a codimension 1 submanifold of $K$ and we have $\bigcup_{i=1}^N U_{w_i}\subset \mc{P}_K(q)$.

    Now we use the second part of the previous lemma to obtain an open neighborhood $U\subset \mc{P}_K(q)$ of $p$, such that $\exp_q^{-1}(U)\cap L^K_qM\subset \bigcup_{i=1}^N O_{w_i}$. Thus any point $p\in \mc{P}_K(q) \cap U$ is contained in some $\mc{V}_i$ and we have $\bigcup_{i=1}^N U_{w_i} \supset \mc{P}_K(q)\cap U$. 
    We then define 
    \[
        \U_i := U \cap U_{w_i}
    \] and have 
    \[
        \bigcup_{i=1}^N \,\U_i = \mc{P}_K(q)\cap U
    \] as desired. Furthermore, because $U$ is an open neighborhood of $p$, $\U_i$ is still a codimension 1 submanifold of $K$ and $p\in \U_i$.

    We show that $\U_i$ is spacelike. To that end let $p\in \U_i$. Note that we have $\U_i\subset K$ and $\U_i\subset U_{w_i}' = \exp_q(O_{w_i}')$, where $w_i\in O_{w_i}' \subset L^+_qM$ is an open neighborhood of $w_i$ in $L^+_qM$ such that on $O_{w_i}'$, $exp_q$ is a diffeomorphism onto its image. Both $K$ and $U_{w_i}'$ are null hypersurfaces around $p$ but by proposition \ref{prop:transversality} they are transversal and thus cannot be generated by the same null rays. Thus $T_p\,\U_i = T_pK \cap T_pU_{w_i}'$ can only contain spacelike vectors.

    Finally to prove that they are transversal at $p$, we assume by contradiction that there exist $i\neq j$ such that $T_p\,\U_i=T_p\,\U_j$. But by lemma \ref{lem:dirreconstr} this would imply that $v_i = c*v_j$ for a $c\in \R_+$, where $v_i = \gamma'(1)_{q,w_i}$. This would imply $w_i = w_j$, a contradiction.
\end{proof}

\begin{definition}[Regular Point]
We call a point $p\in \mc{P}_K(q)$ \emph{regular} if there exists an open neighborhood $\mc{U}\subset M$ of $p$ such that $\mc{U}\cap \mc{P}_K(q)$ is a submanifold.
\end{definition}
Note that $p\in \mc{P}_K(q)$ if and only if $N=1$ for $p$ in the previous proposition.


\begin{corollary}The subset of regular points is open and dense in $\mc{P}_K(q)$.
\end{corollary}
\begin{proof}
The fact that it is open follows immediately from the definition: Let $p\in \mc{P}_K(q)$ be regular. There thus exists an open neighborhood $p\in \mc{U}\subset M$ such that $\U \cap \mc{P}_K(q)$ is a submanifold. But now for every point $p'\in \U\cap\mc{P}_K(q)$, $\mc{U}$ also makes $p'$ a regular point making $\U\cap\mc{P}_K(q)$ an open neighborhood of regular points of $p$. Thus every regular point has an open neighborhood of regular points making the set of regular points itself open.

To prove the set of regular points is dense in $\pq$ we to show that for every point $p\in \mc{P}_K(q)$, every relatively open neighborhood $U'\subset\mc{P}_K(q)$ contains a regular point. By the previous proposition, for $U'$ small enough we have $\mc{P}_K(q)\cap U' = \bigcup_{i=1}^N\,\U_i$, where $\U_i$ are pairwise transversal. This means their intersection is of lower dimension and 
\[
    \U_i \setminus \bigcup_{j\neq i}\, \U_j \quad \text{ is open and nonempty for every }i=1,\dots N.
\]
((Give name and close to $p$))
and we can find a $p'\in \mc{V}_i$ for some $i\in 1,\dots,N$ such that $p'\notin \mc{V}_j$ for $j\neq i$. Thus we can find an open neighborhood $\mc{O}'$ around $p'$ such that $\mc{O}'\cap \mc{P}_K(q)\subset \mc{V}_i$ which means $p'$ is a regular point, as desired.
\end{proof}

\subsection{Observation Time Functions}
\begin{definition}[Observation Time Function]\label{def:observationtime}
For $a\in \sn$ the \emph{observation time function} 
is defined as 
\begin{align*}
    f_a:\jp&\to [0,1]\\
    q&\mapsto\inf(\{s\in [0,1] \mid \mu_a(s)\in J^+(q)\}\cup \{1\}).
\end{align*}
Moreover, let $\mc{E}_a(q)\coloneqq\mu_a(f_a(q))\in M$ be the earliest point where $\mu_a$ sees light from $q$.
\end{definition}

\begin{lemma}\label{lem:observationtime}
Let $a\in \sn$ and $q \in \interior{\jp}$. Then
\begin{enumerate}[label={\textnormal{(\arabic*)}}]
    \item It holds that $f_a(q)\in (0,1)$.
    \item We have $\mc{E}_a(q)\in J^+(q)$ and $\tau(q,\mc{E}_a(q))=0$. Moreover the function $s\mapsto\tau(q,\mu_a(s))$ is continuous, non-decreasing on $[0,1]$ and strictly increasing on $[f_a(q),1]$.
    \item Let $p\in K$. Then $p=\mc{E}_a(q)$ with some $a\in \ca$ if and only if $p\in \mathcal{P}_K(q)$ and $\tau(p,q)=0$. Furthermore, these are equivalent to the fact that there are $v\in L^+_qM$ and $t\in[0,\rho(q,v)]$ such that $p=\gamma_{q,v}(t)$.
\end{enumerate}
\end{lemma}
\begin{proof}
Let $a\in \mc{A}$ and $q\in \overline{V}$.

We begin by showing (1): By lemma \ref{lem:Kcharact}(3) we have that
$\mu_a(t_-)\notin J^+(q)$ and $\mu_a(t_+)\in J^+(q)$. The second part immediately yields $f_a(q) \leq t_+$ as $f_a(q)$ is the infimum over all observation times. For the first part we assume by contradiction that there were to exist a $t_{-2}<t_-$ with $\mu_a(t_{-2})\in J^+(q)$. This allows us to construct a causal path from $q$ to $\mu_a(t_-)$ by joining the causal path from $q\to \mu_a(t_{-2})$ and the null geodesic $\mu_a$ from $t_{-2}$ to $t_-$. Since this would imply that $\mu_a(t_-)\in J^+(q)$ this is a contradiction and $f_a(q)$ must be bigger than $t_-$ proving (1).

(2)
By the definition of the infimum we can find a sequence $t_n\searrow f_a(q)$ such that for all $t_n$ we have $\mu_a(t_n)\in J^+(q)$. Now since $t\mapsto \mu_a(t)$ is continuous we have that $\mu_a(t_n)\to \mu_a(f_a(q)) = \mc{E}_a(q)$. Since $J^+(q)$ is closed this yields $\mc{E}_a(q)\in J^+(q)$. 

For the second part we assume by contradiction that $\tau(q,\mc{E}_a(q)) > 0$. Since this means that a timelike path from $q$ to $\mc{E}_a(q)$ exists we have $\mc{E}_a(q)\in I^+(q)$. Then, since $I^+(q)$ is open we can find a $t<f_a(q)$ such that $\mu_a(t)\in I^+(q) \subset J^+(q)$. This is a contradiction since $f_a(q)$ is the infimum over such $t$.

To show that $s\mapsto \tau(q,\mu_a(s))$ is continuous and non-decreasing on $[0,1]$ we first note that it is the composition of two continuous functions. Non-decreasing then follows from the reverse triangle inequality together with the fact that $\mu_a$ is a null path.

Finally to show that $s\mapsto \tau(q,\mu_a(s))$ is strictly increasing in $[f_a(q),1]$ we let $f_a\leq t_1<t_2\leq 1$. Now by ((REF)) there exists a causal geodesic $\gamma_1:[0,1]\to M$ with $\gamma_1(0)=q$ and $\gamma_1(1)=\mu_a(t_1)$ such that $L(\gamma_1)=\tau(p,\mu_a(t_1))$. 
If we then connect $\gamma_1$ to $\mu_a\rvert_{[t_1,t_2]}$ we get a path $\gamma_2$ connecting $q$ to $\mu_a(t_2)$ which has length $L(\gamma_2) = L(\gamma_1)$ as $\mu_a$ is a null geodesic. Next we argue that $\gamma_2$ must have a break at the connecting point, i.e. $\gamma_1'(1) \neq c\mu_a'(t_1)$ for any $c\in \R_+$. If $\gamma_1$ is timelike this observation is trivial as $\mu_a$ is lightlike. If however, $\gamma_1$ is lightlike (which is exactly the case if $t_1=f_a(1)$), this fact follows from the transversality of light cone observations as noted in proposition \ref{prop:transversality}. This means that $\gamma_2$ is a broken causal geodesic, which by ((REF)) implies that there exists a strictly longer timelike path $\gamma_3$ connecting the endpoints and we get
\[
\tau(q,\mu_a(t_2)) \geq L(\gamma_3) > L(\gamma_2) = L(\gamma_1) = \tau(q,\mu_a(t_1)).
\]

Next to prove (3):
To prove the fist direction we assume that $p=\mc{E}_a(q)$ for some $a\in \mc{A}$. Now by (2) we have $\mc{E}_a(q) \in J^+(q)$ and $\tau(q,\mc{E}_a(q))=\tau(q,p)=0$. But now, by ((REF)) there exists a null geodesic from $q$ to $p$ which means $p\in \mc{P}_K(q)$. 

For the other direction we let $p\in \mc{P}_K(q)$ with $\tau(q,p)=0$. Now let $a\in \mc{A}$ such that $p=\mu_a(t)$ for some $t\in [0,1]$. We then assume by contradiction that $\mc{E}_a(q) \neq p$, i.e. $f_a(q) < t$. But by (2) we have that $s\mapsto\tau(q,\mu_a(s))$ is strictly increasing after $f_a(q)$ which is in contradiction with $\tau(q,p)=0$.

The other equivalence follows the definition of $\mc{P}_K(q)$ together with the definition of cut points.

Finally we prove (4):
Let $q_i\to q$ in $\overline{V}$, let $t_i = f_a(q_i)$ and $t=f_a(q)$. Since $\tau$ is continuous, for any $\varepsilon>0$ we have $\lim_{j\to \infty} \tau(q_j,\mu_a(t+\varepsilon)) = \tau(q,\mu_a(t+\varepsilon)) > 0$. Thus for $i$ big enough we have $\tau(q_i,\mu_a(t+\varepsilon))>0$. But by (3) this implies that $a$ must have observed $q_i$ before $t+\varepsilon$ i.e. $f_a(q_i)<t+\varepsilon = f_a(q) + \varepsilon$. As $\varepsilon$ was arbitrary we get $\limsup_{j\to \infty} t_j \leq t$.

We assume now that $\liminf_{i\to \infty} t_i=t'<t$. Let $(t_i)$ be a convergent subsequence such that $f_a(q_i) = t_i \to t' < f_a(q)$. Now by the continuity of $\tau$ and $\mu_a$ we have 
\[
0=\tau(q_i,\mu_a(f_a(q_i)))\to \tau(q,\mu_a(t')).
\]
Furthermore by ((REF)) $\mu(s_i)\in J^+(q_i)$ for all $i$ implies $\mu(s')\in J^+(q)$. But now we have $\mu(s')\in \mc{P}_K(q)$ and $\tau(q,\mu_a(s'))=0$ which by (3) implies that $\mu_a(s') = \mc{E}_a(q) = \mu_a(f_a(q))$. But this is a contradiction as $s'<f_a(q)$. ((More in-detail?))
\end{proof}

By (3) of the above lemma, for any $q\in \overline{V}$ and $a\in \ca$ we have $\mc{E}_a(q)\in \P_K(q)$. Since $\P_K(q)\subset J^+(q)$, we can see using definition \ref{def:observationtime} that the set of earliest observations $\P_K(q)$ and the path $\mu_a$ completely determine the functions
\begin{align}\label{eq:observationtimerestated}
    f_a(q) = \min \{ s\in [-1,1] \mid \mu_a(s)\in \P_U(q) \}, \quad \mc{E}_a(q) = \mu_a(f_a(q))
\end{align}

\begin{lemma}\label{lem:qcont} Let $a\in \sn$. Then the function $q\mapsto f_a(q)$ is continuous on $\interior{\jp}$.
\end{lemma}

\begin{lemma}\label{lem:acont} Let $q\in \interior{\jp}$. Then the function $a\mapsto f_a(q)$ is continuous on $\sn$.
\end{lemma}

\begin{corollary}\label{cor:fcont} 
    The map $f:\interior{\jp}\times\sn\to\R; (q,a)\mapsto f_a(q)$ is continuous.
\end{corollary}

\begin{proposition}\label{cor:funif}
    If $q_n \to q_0\in \interior{\jp}$ as $n\to \infty$ and we denote $F_q:\sn\to\R;a\mapsto f_a(q)$. Then $F_{q_n}\to F_{q_0}$ uniformly over $\sn$ as $n\to \infty$.
\end{proposition}

\begin{proposition}\label{prop:finj}
    Let $q,q'\in V$ such that $F_q=F_{q'}$. Then $q=q'$.
\end{proposition}

\begin{proposition}\label{prop:frevcont} Let 
    $(q_n)_{n=1}^{\infty}$ be a sequence in $V$ and $q_0\in V$ such that $F_{q_n}\to F_{q_0}$ uniformly then $q_n \to q_0$ as $n\to \infty$.
\end{proposition}

\subsection{Set of earliest observations}
\begin{definition}[Set of earliest observations]
For $q\in \overline{V}$ we define
\begin{alignat*}{2}
    \mathcal{D}_K(q) &=\; &\{(p,v)\in L^+M \mid &(p,v) = (\gamma_{q,w}(t),\gamma'_{q,w}(t)) \\
    &&&\text{ where } p\in K, w\in L_q^+M, 0\leq t \leq \rho(q,w)\},\\
    \mathcal{D}^{reg}_K(q) &=\; &\{(p,v)\in L^+M \mid &(p,v) = (\gamma_{q,w}(t),\gamma'_{q,w}(t)) \\
    &&&\text{ where } p\in K, w\in L_q^+M, 0 < t < \rho(q,w)\},
\end{alignat*}
We say that $\mathcal{D}_K(q)$ is the \emph{direction set} of $q$ and $\mathcal{D}^{reg}_K(q)$ is the \emph{regular direction set} of $q$.

Let $\mc{E}_K(q) = \pi(\mathcal{D}_K(q))$ and $\mc{E}^{reg}_K(q) = \pi(\mathcal{D}^{reg}_K(q))$, where $\pi:TM\to M$ is the canonical projection. We say that $\mc{E}_K(q)$ is the set of earliest observations and $\mc{E}^{reg}_K(q)$ is the set of earliest regular observations of $q$ in $K$. We denote the collection of earliest observation sets by $\mc{E}_K(V) = \{ \mc{E}_K(q) \mid q\in V\}$.
\end{definition}

Note that $\mc{E}_K(q) = \{ \mc{E}_a(q) \mid a\in \sn \}$.
\begin{proposition}\label{prop:submanifolds}
For any $q\in V$ it holds that
\begin{enumerate}[label={\textnormal{(\arabic*)}}]
    \item $\mc{E}^{reg}_K(q)$ is a $n-1$-dimensional nonempty spacelike submanifold of $K$ which is open relative to $\mc{P}_K(q)$ and has $\overline{\mc{E}^{reg}_K(q)} = \mc{E}_K(q)$ and,
    \item $\mc{E}_K(q)$ fails to be a submanifold exactly at cut points,
    \item $\mc{D}^{reg}_K$ is a nonempty open $n$-dimensional submanifold of $\overrightarrow{K}:=\pi^{-1}(K)$.
\end{enumerate}
\end{proposition}
\begin{proof}
We begin by proving (1):

Let $p$

\end{proof}

Note that since $\mc{E}^{reg}_K(q)$ is exactly $\mc{E}_K(q)$ without the cut points, it is also the collection of all points where $\mc{E}_K(q)$ is locally a submanifold.

\begin{proposition} For any $q\in \overline{V}$, $\mc{E}{reg}_K(q)\subset K$ and $\mathcal{D}^{reg}_K(q)\subset TU$ are smooth submanifolds of dimension $n-1$ ((D has dim $n$)).
\end{proposition}
\begin{proof}
((TODO))


We will focus our attention to the case of $\mc{E}{reg}_U(q)$ as the argument for  $\mathcal{D}^{reg}_U(q)$ is analogous
Note first that $\mc{E}{reg}_U(q)$ can be rewritten as 
\[
    \{\exp_q(w) \mid  w\in L^+_qM \text{ with } 1<\rho(q,w)\}.
\]
Next by lower semi-continuity of $\rho$ we get that $R=\{w\in L^+_qM \mid 1<\rho(q,w)$ is an open set and thus a dimension $(n-1)$ submanifold (this is because $L^+_qM$ itself is of dimension $(n-1)$). But since $\rho(q,w)$ describes where $\exp_q$ first fails to be a diffeomorphism we get that the surjection $\exp_p:R\to \mc{E}{reg}_U(q)$ is a diffeomorphism. Thus, since $R$ was a manifold of dimension $(n-1)$, $\mc{E}{reg}_U(q)$ is also a manifold and has the required dimension.
\end{proof}

Finally in this section we will prove
\begin{proposition}\label{prop:seocharact}
Let $q\in V$, then 
\begin{equation*}
    \mc{E}_K(q) = \{ p \in \P_K(q) \mid \text{there are no $p'\in \P_K(q)$ such that $p' < p$} \}.
\end{equation*}
\end{proposition}
\begin{proof}
((Still True?))
For the left inclusion assume $p\in \mc{E}_U(q)$, i.e. there exists an $a\in \ca$ such that $\mc{E}_a(q)=p$. Then lemma \ref{lem:observationtime}(3) immediately yields, $p\in \P_U(q)$ and  $\tau(q,p)=0$. Now suppose there were a $p'\in \P_U(q)$ with $p'\ll p$. By as $\P_U(q)\subset J^+(q)$ we have $q\leq p'$, then as $p'\ll p$ we get $q\ll p$. But this would imply $\tau(p,q)>0$, a contradiction.

For the other direction we assume we have $p \in \P_U(q)$ such that there are no $p'\in\P_U(q)$ such that $p'\ll p$. Again by lemma \ref{lem:observationtime}(3) we only need to prove that $\tau(p,q)=0$. Suppose that $\tau(p,q)>0$. By equation \ref{eq:frameunion} there exists an $a\in \ca$ and a $s\in [-1,1]$ such that $\mu_a(s) = p$. Now since $\tau(p,q)>0$, we must have $s > f_a(q)$. But then $\mc{E}_a(q) = \mu_a(f_a(q)) \ll  \mu_a(s)$, since $\mu_a$ is timelike, which is a contradiction.
\end{proof}
Thus $\mc{E}_K(q)$ truly deserves to be called the \enquote{set of earliest observations}.


\begin{proposition}
((Given data))
The light observations $\mc{P}_K(q)$ uniquely determines the light \emph{direction} observation set $\mc{D}_K(q)$ and the set of earliest observations $\mc{E}_K(q)$.
\end{proposition}
\begin{proof}
2nd part: from formula

1st part: from lemma + only finite nonconj cut points + we can parameterize $\mc{P}_K(q)$ by a spacelike submanifold of the forwards lightcone
\end{proof}

\begin{proposition}
((Given data))
Given the light direction observation set $\mc{P}_K(q)$ and the set of earliest observations $\mc{E}_K(q)$, we can determine the sets $\mc{E}^{reg}_K(q), \mc{D}_K(q)$ and $\mc{D}^{reg}_K(q)$.
\end{proposition}
\begin{proof}
((Take $\pi^-1(\mc{E}_K(q))\cap \mc{C}_K(q)$ for $\mc{D}_U(q)$, then remove all cut points (in this case points with equal $p$ but different $v$) in $\mc{D}_U(q)$ to obtain $\mc{D}^{reg}_K(q)$ and project again))
\end{proof}