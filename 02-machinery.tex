\chapter{Geometric Preliminaries}\label{chap:preliminaries}
As noted in the introduction, in this chapter we will set up most of the machinery and prove most of the properties needed to prove theorems \ref{chap:interior} and \ref{chap:boundary} 
% \section{Null Conjugate Points}
% ((TODO Connection to cut points))
% ((Leave this here?))
% \begin{definition}[Null Conjugate Point]
%     Let $\gamma_{q,w}:[0,b]\to M$ be a null geodesic. We then call $p=\gamma_{q,w}(b)$ a \emph{null conjugate point} if there exists a nontrivial variation $\x:[0,b]\times(-\varepsilon,\varepsilon) \to M$ of $\gamma_{q,w}$ through null geodesics such that $\x_v(b,0)=0$.
% \end{definition}

% We have the following useful characterization:
% \begin{proposition}
%     Let $\gamma_{q,w}:[0,b]\to M$ be a null geodesic. Then $p=\gamma_{q,w}(b)$ is a null conjugate point if and only if $\exp_q:L_qM\to M$ is singular at $bw$, i.e. if there exists a nonzero $\xi\in T_{bw}(L_qM)$ such that $d\exp_q(\xi)=0$.
% \end{proposition}
% \begin{proof}
%     We begin by proving the backwards direction and to that end assume that there exist a nonzero $\xi\in T_{bw}(L_qM)$ such that $d\exp_q(\xi)=0$. By the construction of the tangent space there thus exists a non-constant path $\xi:(-\varepsilon,\varepsilon)\to L_qM$ with $\xi(0)=bw$. This allows us to construct the variation $\x(u,v)=\exp_q(\frac{u}{b}\xi(v))$ which has $\x(t,0)=\gamma_{q,w}(t)$ and is a variation through null geodesics. Finally we have $\x_v(b,0)=d\exp_q(\xi)=0$ by the chain rule.

%     For the other direction we first note that by definition $\x(u,v)=\exp_q(u\x_u(0,v))$ and $\x_u(0,v)\in L_qM$ as $\x$ is a variation through \emph{null} geodesics. 
%     Now again by the chain rule we have $0=\x_v(b,0) = d\exp_q\rvert_{bw} \circ \frac{d}{dv}(bx_u(0,v))\rvert_{v=0}$. But since $\xi := \frac{d}{dv}(bx_u(0,v))\rvert_{v=0} \in T_{bw}(L_qM)$ we are done.
% \end{proof}

% Null conjugate points are also conformal invariants:
% \begin{proposition}
%     Let $\Phi:(M,g)\to (N,h)$ be a conformal diffeomorphism and $\gamma:[0,b]\to M$ a null geodesic. Then $\gamma(b)$ is a null conjugate point of $\gamma$ if and only if $\Psi(\gamma(b))$ is a null conjugate point of $\Psi \circ \gamma$.
% \end{proposition}
% \begin{proof}
%     ((Cite relevant prop))
%     Because of the symmetry of the situation we only need to prove one direction and suppose that $\gamma(b)$ is a null conjugate point of $\gamma$. We thus have a variation $\x$ of $\gamma$ through null geodesics. But since $\Phi$ maps null geodesics to null geodesics, $\Phi\circ \x$ is a variation of $\Phi \circ \gamma$ through null geodesics in $N$, which implies that $\Phi(\gamma(b))$ is a null conjugate point of $\Phi \circ \gamma$.
% \end{proof}
\section{Geometry of the light cone observations}
We will begin by proving some relevant properties of $K$ and $\mc{P}_K(q)$.
\subsection{Observer Set}
This lemma is important because characterization (1) shows that on $K=\mc{L}^-_{p^+}\cap J^+(p^-)$ all points $p$ have $\tau(p,p^+)=0$. (2-3) are also very useful because they show the light cones of points $q$ in the interior of $\jp$ will only intersect $K$ in its relative interior, often allowing us to ignore the points where $K$ fails to be a submanifold. 
\begin{lemma}\label{lem:Kcharact}
    Let $p^-,p^+\in M$ suitable and $R:= K \setminus I^+(p^-)$ the past boundary of $K$ then:
    \begin{enumerate}[label={\textnormal{(\arabic*)}}]
        \item $K=\jp\setminus I^-(p^+)$,
        \item $\mc{L}^-_{p^+}\cap \ijp = \emptyset$, and 
        \item $\mc{L}^-_{p_0} \cap \ijp = J^-(p_0) \cap \ijp = \emptyset \quad \forall p_0\in R.$
        % \item There exist $0<t_-<t_+<1$ such that the restriction $\Psi\rvert_{S^n\times[t_-,t_+]}$ is a diffeomorphism onto its image and that for all $v \in S^n$, we have 
        % \[
        % \Psi(v,t_-) \notin \bigcup_{q\in \overline{V}} J^+(q), \quad \Psi(v,t_+) \in \bigcap_{q\in \overline{V}} J^+(q).
        % \]
    \end{enumerate}
\end{lemma}
\begin{proof}
(1) We first rewrite $\jp\setminus I^-(p^+)=(J^-(p^+)\setminus I^-(p^+))\cap J^+(p^-)$ and immediately get $(J^-(p^+)\setminus I^-(p^+))\cap J^+(p^-)\subset \mc{L}^-_{p^+}\cap J^+(p^-)=K$ as $J^-(p^+)\setminus I^-(p^+)\subset \mc{L}^-_{p^+}$. For the other inclusion we note that because we assumed $p^-\ll p^+$ to be suitable, we have we have $\tau(p,p^+)=0$ for all $p\in K$. Together with $p\in \mc{L}_{p^+}^- $, this implies $p\in J^-(p^+)\setminus I^-(p^+)$. Furthermore $p\in K$ also implies $p\in J^+(p^-)$. Putting this together we get $p\in (J^-(p^+)\setminus I^-(p^+))\cap J^+(p^-)$ proving the equality.

% For (2) we first note that $p^-\notin K$ because $p^+\gg p^-$ implies $\tau(p^-,p^+)>0$ which would make $p^-$ a cut point were it in $K$, violating our assumption. Thus also $p^-\notin \mc{L}^-(p^+)$. This implies that $\mc{L}^-_{p^+}$ and $\mc{L}^+_{p^-}$ are transversal.

% Next we note that the exponential map
% \[
%     \exp_{p^+}:L^-_{p^+}M \simeq \sn \times \R_+ \to \mc{L}^-_{p^+}
% \]
% is smooth and surjective. 

% We now aim to construct a smooth surjecive map $\theta:\sn \times [0,1] \to \exp^{-1}_{p^+}(K)$ which is a diffeomorphism on $\sn \times [0,1)$. To that end we look at the set of \emph{unit null directions} 
% \[
%     CL^-_{p^+}M:=\{v\in L^-_{p^+}M \mid \lVert v \rVert_{g^+}=1\}\simeq \sn
% \] 
% for some riemannian metric $g^+$ on $M$. By ((Leavescompact)) for a given null direction $v \in CL^-_{p^+}M$ there exists a $s_v>0$ such that $\gamma_{p^+,v}(s_v) \in J^+(p^-)$ but $\gamma_{p^+,v}(s') \notin J^+(p^-)$ for all $s'>s_v$. Furthermore for any $s'\le s_\mu$ we have $\gamma_{p^+,v}(s')\in J^+(p^-)$ because we can append the lightlike path from $p^-$ to $\gamma_{p^+,v}(s_v)\in J^+(p^-)$ to $\gamma_{p^+,v}\rvert_{[s',s_v]}$ and get a lightlike path from $p^-$ to $\gamma_{p^+,v}(s')$. We also have $\gamma_{p^+,v}(t_v)\notin I^+(p^-)$ because $I^+(p^-)$ is open which would imply the existence of a $t'>t_v$ such that $\gamma_{p^+,v}(t')\in I^+(p^-)\subset J^+(p^-)$ violating the maximality of $t_v$. Finally, because $\exp_{p^+}$ is transverse to $\mc{L}^+_{p^-}$, $exp_{p^+}^-1(\mc{L}^+_{p^-})$ is a smooth submanifold of $L^-_{p^+}M$, by lemma \ref{lem:transmap}. This implies that the map that $v\mapsto t_v$ is smooth.

% We now define 
% \begin{align*}
%     \theta:\sn\times[0,1] &\to \exp^{-1}_{p^+}(K)\\
%     (v,t)&\mapsto (1-t)s_vv
% \end{align*}
% where we used $CL^-_{p^+}\simeq\sn$ to identify $v\in \sn$ with the corresponding $v\in CL^-_{p^+}$.
% Using the results from the above paragraph it follows that $\theta$ is well-defined and has the desired properties. 

% We now set $\Theta:=\exp_{p^+}\circ \; \theta$, which satisfies all properties in (2) and are done with this part.

For part (2) we assume there exists a $p\in \mc{L}^-_{p^+}\cap \interior{\jp}$. Note that $\interior{\jp}=I^+(p^-)\cap I^-(p^+)$. We thus have $p\in I^+(p^-)\subset J^+(p^-)$, which together with $p\in \mc{L}^-_{p^+}$ implies $p\in K$. But now we have $p\in I^-(p^+)$ and $p\in K$, a contradiction to (1).

Finally for part (3) we assume that there exists a $p_0\in R$ and $p\in J^-(p_0)\cap \interior{\jp}$. Because $\interior{\jp}\subset I^+(p^-)$ there exists a timelike path from $p^-$ to $p$. Because $p\in J^-(p_0)$ we can use proposition \ref{prop:geosmoothing} to construct a timelike path from $p^-$ to $p_0$ implying $p_0\in I^+(p^-)$. But because $p\in R=K\setminus I^+(p^-)$ this is a contradiction. $\mc{L}^-_{p_0} \subset J^-(p_0)$ then yields the first equality.
% Any $p_0\in R$ must be in $\mc{L}^+_{p^-}$. If $p\in \mc{L}^-_{p^-}$ it cannot be in $I^+(p^-)$. Thus $p\in \mc{L}^+_{p^-}$. Furthermore we have $p\in I^-(p^+)\subset J^-(p^+)$ and $\tau(p^-,p)>0$ because $p\in I^+(p^-)$. But this implies that $p^-$ has a cut point in $\mc{L}^+_{p^-}\cap J^-(p^+)$. A contradiction because $p^-$ and $p^+$ were assumed to be suitable.
\end{proof}

% The next proposition allows us to endow $K$ with a number of \enquote{laboratory frames} we will use to conveniently describe the light cone observations on $K$.
% \begin{proposition}[Laboratory Frames]
% Let $(M_j,g_j), K_j, V_j, p_j^+,p_j^-, \Phi$ be as in the statement of theorem \ref{thm:babycase}
% Then there exists a family of future pointing, null geodesics $\mu_a^{(1)}:[0,1]\to K_1$ indexed by $a\in \mathcal{A}$ where $\mathcal{A}$ is a metric space. Furthermore we can require the map $[0,1]\times\mathcal{A}\to K_1; (s,a)\mapsto \mu^{(1)}_a(s)$ to be open ((almost, needed?)) and continuous. If we then take $\mu^{(2)}_a\coloneqq\Phi(\mu^{(1)}_a)$ we can achieve
% \begin{equation}\label{eq:frameunion}
% K_j = \bigcup_{a\in \mathcal{A}}\mu^{(j)}_a([0,1]).
% \end{equation}
% \end{proposition}
% \begin{proof}
% ((TODO))
% \end{proof}

% \begin{remark}\label{rmk:data}To simplify notation we will continue with the construction on just one Lorentzian manifold $(M,g)$ of dimension $1+n$ and assume that we are given the following data to construct the required conformal diffeomorphism ((explain better)) from theorem \ref{thm:babycase}.

% \begin{enumerate}
%     \item A the quasi-manifold $K$,
%     \item the conformal class of $g\rvert_K$ (but not only restricted to tangent vectors in $K$ ((i think??)) ),
%     \item the paths $\mu_a:[0,1]\to K, a\in \mathcal{A}$,
%     \item the set $\mathcal{P}_K(V)$ where $V$ is open and $\overline{V}\subset \operatorname{int} J(p^-,p^+)$ is compact.
% \end{enumerate}
% Note that these data are invariant under conformal diffeomorphism, and any map we construct from it will thus also be invariant. We also remark that $\overline{V}\subset \operatorname{int} J(p^-,p^+)$ implies that $q\notin K$ for any $q\in \overline{V}$. 
% \end{remark}


This lemma will be essential in showing many of the desirable properties of the \emph{observation time} functions, because it ensures that for any $q\in \interior{\jp}$ the intersection of the forwards light cone $\mc{L}^+_{q}\cap K$ is not degenerate. The fact that this fails if the source point $q$ is in $K$ is precisely why many of the nice properties of the observation time functions dont carry over to points on $K$.
\begin{lemma}\label{lem:transversality}
For any $q\in \ijp$ the restriction of the exponential map to null vectors $\exp_q:L^+_qM\to M$ is \emph{transverse} to $K$, i.e. for all $w\in L^+_qM$ such that $\gamma_{q,w}(1) = p\in K$ we have $\gamma'_{q,w}(1)\notin T_pK$.
\end{lemma}
\begin{proof}
    In order to achieve a contradiction we assume that there exists a $q\in \ijp$ and a $w\in L^+_qM$ such that with $p=\gamma_{q,w}(1)\in K$ and $v:=\gamma'_{q,w}(1)\in L_pK$.
    Since $K$ is generated by backwards null geodesics originating at $p^+$ there exists a $u\in L^-_{p^+}M$ and a $t\in \R_+$ with $\gamma_{p^+,u}(t)=p, \gamma'_{p^+,u}(t)=-v$. We can thus obtain an unbroken past-pointing null geodesic from $p^+$ to $q$ by connecting $\gamma_{p^+,u}$ and $\gamma_{p,-v}$. But this implies that $q\in \mc{L}^-_{p^+}\cap J^+(p^-)$ which is a contradiction to \ref{lem:Kcharact}(2).

    We now prove that this implies that $\exp_q:L^+_qM\to M$ is transverse to $K$. We need to show that for every $w\in L^+_qM$ with $\exp_q(w)=p\in K$ we have 
    \[
        \im(d\exp_q\rvert_w) \oplus T_pK = T_pM.
    \]
    As $T_pK$ is a null hypersurface we only need to prove that $\im(d\exp_q\rvert_w)$ contains a null vector which is not a multiple of the null vector $v\in T_pK$ generating $T_pK = v^\perp$. But by the properties of the exponential map, $\im(d\exp_q\rvert_w)$ contains $v' = \gamma'_{q,w}(1) \in T_pM$. And since we just proved that $v'\notin T_pK$, $v'$ cannot be a multiple of $v$, as desired.
\end{proof}

This next lemma will also be very useful. The core idea is that $K$ is a subset of $J^-(p^+)$. $J^-(p^+)$ has, by definition, the useful property that once a lightlike curve leaves it it can never return.
\begin{lemma}\label{lem:hitsonce}
    For $q\in \ijp$ and $w\in L^+_qM$ there exists a unique $t_w\in (0,\infty)$ such that $\gamma_{q,w}(t_w)\in K$.
\end{lemma}
\begin{proof}
    Let $q\in \ijp$ and $w\in L^+_qM$, by lemma \ref{lem:leavescompact} any geodesic starting in the compact set $J(p^-,p^+)$ must eventually leave it, intersecting the boundary. As $K$ is the future boundary of $\jp$ there exists at least one $t_w\in (0,\infty)$ with $p=\gamma_{q,w}(t_w)\in K$. We now show $\gamma_{q,w}(t')\notin K$ for any other $t'\neq t_w$.

    First let us consider the case $t'<t_w$. We can then append $\gamma_{q,w}\rvert_{[t',t_w]}$ to the null geodesic $\sigma\subset K$, which has $\sigma(0)=p$ and $\sigma(1)=p^+$, to get a broken lightlike path from $\gamma_{q,w}(t')$ to $p^+$. The fact that this path must be broken follows from the transversality proven in the previous lemma. But the existence of this broken path implies $\tau(\gamma_{q,w}(t'),p^+)>0$ and thus $\gamma_{q,w}(t')\in I^-(p^+)$. But as $K=\jp\setminus I^-(p^+)$ we have $\gamma_{q,w}(t')\notin K$

    Conversely we now assume $t'>t_w$. Again by the transversality of $\gamma_{q,w}$ to $K$ we get that for $t'-t_w>\varepsilon>0$ small enough we have $\gamma_{q,w}(t_w+\varepsilon)\notin \jp=J^+(p^-)\cap J^-(p^+)$ because $K$ is the future boundary of $\jp$. As any point on $\gamma_{q,w}$ is in $J^+(p^-)$ we must have have $\gamma_{q,w}(t_w+\varepsilon) \notin J^-(p^+)$, i.e. there exists no lightlike path from $\gamma_{q,w}(t_w+\varepsilon)$ to $p^+$. But if $\gamma_{q,w}(t')\in J^-(p^+)$ there exists a path $\sigma$ from $\gamma_{q,w}(t')$ to $p^+$ and we could construct a lightlike path from $\gamma_{q,w}(t_w+\varepsilon)$ to $p^+$ by appending $\gamma_{q,w}\rvert_{[t_w+\varepsilon,t']}$ to  $\sigma$, a contradiction. We thus have $\gamma_{q,w}(t')\notin J^-(p^+)\supset\jp\supset K$, completing the proof.
\end{proof}

\subsection{Parametrization of the observer set}
We will now exploit the fact that no past null geodesic starting at $p^+$ has a cut point in $K$ to construct a smooth parametrization of $K$, equivalent to a smoothly parameterized family of geodesics, generating $K$.

We will need to use the Lorentzian splitting theorem as stated in chapter 14 of \cite{beem}:
\begin{theorem}[Lorentzian Splitting Theorem] Let $(M,g)$ be a globally hyperbolic Lorentzian manifold. Then $(M,g)$ splits isometrically as a product $(\R\times H,-dt^2\oplus h)$, where $(V,h)$ is a complete Riemannian manifold.
\end{theorem}
We will often denote the smooth projection from $M$ to the timelike component as $\mc{T}:M\to \R$. Note also that such a splitting also induces a canonical Riemannian metric $g^+$ on $M$ given by $g^+ := dt^2 \oplus h$. For such a metric we denote $CL^\pm_p M:=\{v\in L^\pm_pM\mid \lVert v \rVert_{g^+}=\sqrt{2} \}$ for some $p\in M$, $\sqrt{2}$ is convenience as we will see soon and actual constant does not matter. We can then construct isometries such that
\begin{equation}\label{eq:CEQSN}
    \sn \simeq CT_{\pi_h(p)}H := \{v_H\in T_{\pi_h(p)}\mid \lVert v_H \rVert_h =1 \} \simeq CL^\pm_pM.
\end{equation} $\sn \simeq CT_{\pi_H(p)}H$ follows by picking coordinates around $\pi_h(p)$. And the map $a_H\in CT_{\pi_h(p)}H \mapsto \partial_t + a_H \in CT_{\pi_h(p)}H$, is an isometry as desired; here we used the fact vecors in $CL^\pm_p M$ have length $\sqrt(2)$. From here on we will thus often use $\sn$ and $CL^\pm_pM$ interchangably.

Note that this construction implies 
\begin{equation}\label{eq:constspeed}
    \frac{d\mc{T}(\gamma_{p^+,v}(t))}{dt} = -1 \quad \text{ for all }t\in [0,\infty), v\in CL^-_{p^+}M.
\end{equation}

The following lemma closely resembles lemma \ref{lem:hitsonce}:
\begin{lemma}\label{lem:Tvdef}
    Let $v\in CL^-_{p^+}M$ then there exists a unique $T_v\in \R_+$ such that $\gamma_{p^+,v}([0,T_v])\in K$ and $\gamma_{p^+,v}(t')\notin K$ for all $t'>T_v$.
\end{lemma}
\begin{proof}
    Importantly we have $p^-\notin \mc{L}^-_{p^+}$ because $\tau(p^-,p^+)>0$ and $p^+$ does not have any past cut points in $K=\mc{L}^-_{p^+}\cap J^+(p^-)$. The rest of the proof is essentially analogous to the proof of lemma \ref{lem:hitsonce}.
\end{proof}

\begin{lemma}
    The map $v\in CL^-_{p^+}M\mapsto T_v\in \R_+$ is continuous.
\end{lemma}
\begin{proof}
    We will first show that it is bounded. Note that we have $\mc{T}(p)\ge \mc{T}(p^-)$ for all $p\in J^+(p^-)$ because $\mc{T}$ is strictly increasing along causal geodesics. Now equation \ref{eq:constspeed} guarantees $\mc{T}(\gamma_{p^+,v}(2(t^+-t^-)))= \mc{T}(p^+)-2(t^+-t^-) < t^-$, where $t^\pm := \mc{T}(p^\pm)$. We thus have $\gamma_{p^+,v}(2(t^+-t^-))\notin J^+(p^-)$ and $T_v < t^+-t^-$ for all $v\in CL^-_{p^+}M$.

    To show that the map is continuous we assume $v_n \to v_0 \in CL^-_{p^+}M$ but $T_{v_n}$ does not converge to $T_{v_0}$. Because $T_{v_n}$ is bounded there must exist a convergent subsequence $T_{v_j}\to T'\neq T_{v_0}$. We denote $p_j:=\gamma_{p^+,v_j}(T_{v_j})$ and have $p_j\to p':=\gamma_{p^+,v_0}(T')$. Furthermore because $p_j\in J^+(p^-)\setminus I^+(p^-)$ closed we also have $p'\in J^+(p^-)\setminus I^+(p^-)$, but this is a contradiction to the previous lemma.
\end{proof}
For some $a\in \sn$ often write $T_a:=T_v$ where $v\in CL^-_{p^+}M$ is obtained via the equivalence from equation \ref{eq:CEQSN}. Because $a\mapsto T_a$ is a continuous map on a compact set there exists a maximum $T_\sn$.

With this setup we can now parameterize $K$:
\begin{proposition}\label{prop:thetaconstr}
    Let $\mc{S}:=\{(a,t)\in \sn \times (-\infty,0]\mid t \in [-T_a,0]\}$.
    Then the map
    \begin{align*}
        \Theta:\mc{S}&\to K\\
        (a,t)&\mapsto \exp_{p^+}(-tv_a)
    \end{align*} where $v_a\in CL^-_{p^+}M$ is again given by equation \ref{eq:CEQSN}, has the following properties:
    \begin{enumerate}[label=\textnormal{(\arabic*)}]
        \item $\Theta:\mc{S}\to K$ is a surjective smooth map such that the curves 
        \[\mu_a:=t\mapsto\Theta(a,t) \quad a\in \sn, t\in [-T_a,0]\] are null geodesics,
        \item $\Theta(S^{n-1}\times\{0\}) = \{p^+\}, \quad \Theta(\{(a,T_a)\mid a\in \sn\}) = R$ and
        \item $\Theta:\mc{S}^\times:=\{(a,t)\in \sn \times (-\infty,0]\mid t \in (-T_a,0)\}\to K\setminus ({p^+} \cup R)$ is a diffeomorphism.
    \end{enumerate}
\end{proposition}
\begin{proof}
    To show (1) we first note that the fact that $\Theta$ is surjective follows from lemma \ref{lem:Tvdef}, while smoothness and the geodesic property follows from the fact that $\exp_{p^+}$ and $a\in \sn \mapsto v_a\in v_a\in CL^-_{p^+}M$ are smooth.
    The two equalities in (2) follow from definition together with lemma \ref{lem:Tvdef}.
    Finally for (3) we note that because $a\mapsto T_a$ is a continuous map, $\mc{S}^\times$ is a open submanifold of $\sn\times (-\infty,0]$. Furthermore because by assumption $p^-$ and $p^+$ are \emph{suitable}, past null geodesics originating at $p^+$ have no cut points in $K$, i.e. $\rho(p^+,v_a)>T_a$ for all $a\in \sn$. But this means that $\Theta$ is a diffeomorphism on $\mc{S}^\times$ and by (2) we have $\Theta(\mc{S}^\times)=K\setminus (\{p^+\}\cup R)$, as desired.
\end{proof}


Note that this implies that $K$ is a smooth $n$-dimensional submanifold of $M$ at any point away from its boundary. We will treat $K$ itself as a submanifold when it is clear that we are working away from the boundary. This is often the case as by \ref{lem:Kcharact}(2-3) no null geodesic originating from the interior of $\jp$ can reach $p^+$ or $R$, i.e. the boundary of $K$.

Furthermore by the properties of $\Theta$ we have 
\begin{align}
    \mu_a([-T_a,0])\cap \mu_{a'}([-T_a,0]) &= \{p^+\} \text{ for } a\neq a'\in \sn \text{ and }\\
    \bigcup_{a\in \sn}\mu_a([-T_a,0]) &= K
\end{align} which implies that for every point $p\in K\setminus \{p^+\}$ there exist unique $(a,t)$ such that $\mu_a(t)=p$. Owing to equation \ref{eq:constspeed} also have 
\begin{equation}\label{eq:muspeed}
    \frac{d\mc{T}(\mu_a(t))}{dt} = 1 \quad \text{ for all }a\in \sn, t\in [-T_a,0]
\end{equation}which implies 
\begin{equation}\label{eq:Teq}
    \mc{T}(\mu_a(t)) = \mc{T}(p^+)+t \quad \text{ for all }a\in \sn, t\in [-T_a,0]
\end{equation} making $\mc{T}(\mu_a(t))$ independent of $a\in \sn$.

And finally we can see that we can construct the map $\Theta$ and thus the geodesics $\mu_a$ using only the data outlined in remark \ref{rmk:data}, because we have the smooth structure of $K$ and $g\rvert_K$ determines all null geodesics on $K$.


\subsection{Differential Constructions}
Having parameterized $K$ we can now outline some differential properties of $K$ and $\mc{P}_K(q)$:

The first lemma closely resembles lemma 2.5 in \cite{hintzpaper} with only minor adjustments to adapt it to our case. It is reproduced here for the sake of completeness. It will allow us to reconstruct the direction of incoming light rays at point in $\mc{P}_K(q)$ which will locally correspond to the spacelike hypersurface.
\begin{lemma}[Direction Reconstruction]\label{lem:dirreconstr}
Let $p\in K$ then there exists a bijection $\Phi$ between the space $\mc{S}$ of spacelike hyperplanes $S\subset T_pK$ and the space $\mc{V}$ of rays $\R_+V\subset T_pM$ along future-directed outward facing null vectors, given by the mapping $S\in \mc{S}$ to the unique future-directed outward pointing null ray $\Phi(S)$ contained in $S^\perp$. The inverse map is given by $\mc{V}\ni \R_+V \mapsto T_pK \cap V^\perp\in \mc{S}$.

Moreover there exists a bijection between $\mc{S}$ and the space $\mc{N}$ of linear null hypersurfaces $N\subset T_pM$ which contain a future-directed outward pointing null vector given by $\mc{S}\ni S\mapsto S\oplus \operatorname{span} \Phi(S)\in \mc{N}$.
\end{lemma}
\begin{proof}
    Let $p\in K$, and $S\subset T_pK$ be a spacelike hyperplane. The orthogonal complement $S^\perp\subset T_pM$ then is a two-dimensional lorentzian subspace. Hence there exist four light rays which are multiples of the vectors $V,-V,W,-W$ in $S^\perp$, where we assume without loss of generality that $V$ and $W$ are future-pointing. Since $T_pK=v^\perp$ for some future-pointing null vector $v\in T_pK$, we have $v\in S^\perp$ and can WLOG assume $\R_+W=\R_+v$, i.e. $\R_+W$ is the ray pointing along the null hypersurface $K$. This leaves $\R_+V$ as the unique future-pointing outward null ray which is perpendicular to $S$, and we can thus set $\Phi(S)=\R_+V$.

    For to prove $\Phi$ is a bijection, we let $0\neq V\in T_pM$ be an outward future-pointing null vector. In particular this means that $V\notin T_pK$. Thus $S=V^\perp\cap T_pK$ is a spacelike hyperplane in $T_pK$ which satisfies $S=\Phi^{-1}(V)$.

    For the last claim we note that the map $\mc{N}\ni N \mapsto N^\perp \cap L^+_pM \in \mc{V}$ maps a null hypersurface $N$ to the unique ray along a future-pointing outward null generator of $N$. The inverse of this map is given by $\mc{V}\ni \R_+V\mapsto V^\perp \in \mc{N}$. Composition of these maps with $\Phi$ yields the desired bijection $\mc{N}\to \mc{S}$.
\end{proof}

The next part can be seen as an extension of lemma \ref{lem:hitsonce} we will show that for a $q\in V$, the set of null vectors hitting $K$ is actually a smooth submanifold of the future light cone and that on $L^K_qM$, $\exp_q$ is a local diffeomorphism. The fact that no geodesic starting in $V$ can have a conjugate point in $K$ and the transversality of $\exp_q$ to $K$ are curcial here. 
\begin{definition}[Observation Preimage]
For any $q\in V$ with light observation set $\mc{P}_K(q)\subset K$ we define the \emph{observation preimage} $L^K_qM$ to be the preimage of $K$ under the exponential map restricted to $L^+_qM$, i.e. 
\begin{align*}
    L^K_qM := (\exp_q\rvert_{L^+_qM})^{-1}(K) \subset L^+_qM
\end{align*}
\end{definition}
\begin{lemma}\label{lem:preimage}
For any $q\in V$, the observation preimage $L^K_qM$ is a $n-1$-dimensional submanifold of $L^+_qM$. 

Furthermore, for any $w\in L^K_qM$ there exist a relatively open neighborhood $O_w\subset L^K_qM$ such that $\exp_q:O_w\to U_w:=\exp_q(O_w)\subset \mc{P}_K(q)$ is a diffeomorphism.
\end{lemma}
\begin{proof}
    By lemma \ref{lem:transversality}, $\exp_q:L^+_qM\to M$ is transverse to $K$ (here we treat $L^+_qM$ and $K$ as submanifolds, because by lemma \ref{lem:Kcharact}(2-3) we can disregard the boundary points). Thus by the preimage lemma \ref{lem:transmap} $ L^K_qM := (\exp_q\rvert_{L^+_qM})^{-1}(K)$ is a $n-1$-dimensional submanifold of $L^+_qM$.

    For the second part let $w\in L^K_qM$, since $p:=\exp_q(w)\in K$ and we assumed that such a $p$ cannot be a null conjugate point, we know that $\exp_q:L^+_qM\to M$ has an invertible differential at $w$. Thus, by the implicit function theorem, there exists an open neighborhood $O_w'\subset L^+_qM$ of $w$ such that $\exp_q:O_w'\to \exp_q(O_w')$ is a diffeomorphism. If we then restrict $\exp_q$ to $O_w:=O_w' \cap L^K_qM$ the map is still a diffeomorphism as desired.
\end{proof}
Note that by the invariance of domain theorem $U_w$ is an open submanifold of $\mc{P}_K(q)$

\begin{corollary}\label{cor:lksn}
    The map 
    \begin{align*}
        \sn \simeq CL^+_qM &\to L^K_qM\\
        w &\mapsto t_ww
    \end{align*}
    where $t_w$ is as in \ref{lem:hitsonce}, is a diffeomorphism.
\end{corollary}
\begin{proof}
    This result follows immediately from lemma \ref{lem:hitsonce} together with the fact that since $K$ is (away from its boundary) a smooth submanifold, the map $w\mapsto t_w$ is smooth.
\end{proof}

We now aim to show that for $q\in V$,  $\mc{P}_K(q)$ is localy the finite union of submanifold. This will make use of a lot of the machinery developed so far. 
\begin{lemma}\label{lem:finitevecs}
    Let $q\in V$ and $p\in \mc{P}_K(q)$ then there exist only finitely many $w_1,\dots,w_N\in L^K_qM$ such that $\exp_q(w_i)=p$. Furthermore with $O_{w_i}$ as in the previous lemma such that $\exp_q:O_{w_i}\to U_{w_i}$ are a diffeomorphisms, there exists an open neighborhood $U\subset \mc{P}_K(q)$ of $p$ such that 
    \[
        \exp^{-1}_{q}(U)\cap L^K_qM \subset \bigcup_{i=1}^N O_{w_i}
    \]
    
    %for any neighborhood $W\subset L^K_qM$ of $v_1,\dots,v_n$, there exists a %neighborhood $U\subset \mc{P}_K(q)$ of $p$ such that $\exp^{-1}_q(U) \cap L^+_qM %\subset W$. 
\end{lemma}
\begin{proof}
    Note that the previous corollary immediately yields that $L^K_qM$ is compact.
    Let $q\in V$, $p\in \mc{P}$. We first remark that, by the previous lemma, for any $w\in \exp^{-1}_q(p) \cap L^K_qM$ there exist open neighborhoods $w\in O_w\subset L^K_qM$ and $p\in U_w=\exp_q(O_w)\subset \mc{P}_K(q)$ making $\exp_q:O_w\to U_w$ a diffeomorphism.

    To show that there can only be finitely many $w\in L^K_qM$ with $\exp_q(w)=p$ we let
    \[
        C:=\exp_q^{-1}(p)\cap L^K_qM.
    \] 
    As $M$ is hausdorff, ${p}$ is closed and $\exp_q$ is continuous, $C$ must be closed. $C\subset L^K_qM$ is thus a closed subset of a compact space, making $C$ itself compact as well. Now the family $\{O_w \mid w\in \exp^{-1}_q(p)\cap L^K_qM\}$ is an open cover of $C$. But because $C$ is compact there must exist a finite subcover such that 
    \[
        C\subset O:= \bigcup_{i=1}^N O_{w_i}.
    \]
    We can now make some observations: By definition, for any $w\in L^K_qM\setminus C$ we have $\exp_q(w)\neq p$. And as $\exp_q$ is a diffeomorphism on $O_{w_i}$ for all $i=1,\dots, N$, it must be injective and we get $\exp^{-1}_q(p)\cap O_{w_i}=\{w_i\}$. We thus have 
    \[
        \exp_q^{-1}(p) \cap O = \{w_1,\dots, w_N\}.
    \]
    Furthermore, as $C\subset O$ for any $p\in L^K_qM\setminus O \subset L^K_qM \setminus C$ we still have $\exp_q(w)\neq p$. In other words: 
    \[
        \exp_q^{-1}(p)\cap (L^K_qM\setminus O)=\emptyset.
    \]
    Putting these two observations together we get 
    \[
        \exp_q^{-1}(p)\cap L^K_qM = \{w_1,\dots, w_N\},
    \]
    as desired.

    To show the second part we denote
    \[
        L^\times := L^K_qM \setminus O \quad \text{ and have } L^\times \cap \exp^{-1}_q(p) = \emptyset.
    \]
    Note that $L^\times$ is a closed and thus compact subset of $L^K_q$. We then endow $M$ the geodesic metric $d$ induced by $g^+$. 
    This lets us define the continuous function 
    \begin{align*}
        g:L^\times &\to \R\\
        w &\mapsto d(\exp_q(w),p).
    \end{align*}
    Because $L^\times \cap \exp^{-1}_q(p) = \emptyset$ we have $g(w)>0$ for all $w\in L^\times$. But now, as $L^\times$ is compact there exists a $\varepsilon>0$ such that $g(w)=d(\exp_q(w),p)>\varepsilon$ for all $w\in L^\times$. We can now choose
    \[
        U := B_\varepsilon(p) \cap \mc{P}_K(q)
    \] and get an open neighborhood of $p$ in $\mc{P}_K(q)$ with $\exp^{-1}(U)\cap L^\times = \emptyset$. But this means 
    \[
        \exp^{-1}_q(U) \cap L^K_qM \subset O = \bigcup_{i=1}^N O_{w_i}
    \]
    completing the proof.
\end{proof}


Armed with the previous lemma we can now show:
\begin{proposition}\label{prop:unionmanif}
Let $q\in V$ and $p\in \mc{P}_K(q)$. There exists an open neighborhood $p\in U\subset \mc{P}_K(q)$, a positive integer $N$ and $N$ pairwise transversal, spacelike, codimension 1 submanifolds $\mc{U}_i\subset K$ such that $\mc{P}_K(q) \cap U = \bigcup_{i=1}^N \mc{U}_i$ and $p\in \mc{U}_i$ for $i={1,\dots, N}$.
\end{proposition}
\begin{proof}
    Let $q\in V$ and $p\in \mc{P}_K(q)$. By the previous lemma we know that there can only be finitely many $w_1,\dots,w_n\in L^K_qM$ with $\exp_q(w_i)=p$. 

    By lemma \ref{lem:preimage}, for each $w_i$ there exists a neighborhood $O_{w_i}\subset L^K_qM$ of $w_i$ such that $\exp_q:O_{w_i}\to U_{w_i}:=\exp_q(O_{w_i})$ is a diffeomorphism. Thus $U_{w_i}\subset \mc{P}_K(q)$ is a codimension 1 submanifold of $K$ and we have $\bigcup_{i=1}^N U_{w_i}\subset \mc{P}_K(q)$.

    Now we use the second part of the previous lemma to obtain an open neighborhood $U\subset \mc{P}_K(q)$ of $p$, such that $\exp_q^{-1}(U)\cap L^K_qM\subset \bigcup_{i=1}^N O_{w_i}$. Thus any point $p\in \mc{P}_K(q) \cap U$ is contained in some $\mc{V}_i$ and we have $\bigcup_{i=1}^N U_{w_i} \supset \mc{P}_K(q)\cap U$. 
    We then define 
    \[
        \U_i := U \cap U_{w_i}
    \] and have 
    \[
        \bigcup_{i=1}^N \,\U_i = \mc{P}_K(q)\cap U
    \] as desired. Furthermore, because $U$ is an open neighborhood of $p$, $\U_i$ is still a codimension 1 submanifold of $K$ and $p\in \U_i$.

    We show that $\U_i$ is spacelike. To that end let $p\in \U_i$. Note that we have $\U_i\subset K$ and $\U_i\subset U_{w_i}' = \exp_q(O_{w_i}')$, where $w_i\in O_{w_i}' \subset L^+_qM$ is an open neighborhood of $w_i$ in $L^+_qM$ such that on $O_{w_i}'$, $\exp_q$ is a diffeomorphism onto its image. Both $K$ and $U_{w_i}'$ are null hypersurfaces around $p$ but by proposition \ref{lem:transversality} they are transversal and thus cannot be generated by the same null rays. Thus $T_p\,\U_i = T_pK \cap T_pU_{w_i}'$ can only contain spacelike vectors.

    Finally to prove that they are transversal at $p$, we assume by contradiction that there exist $i\neq j$ such that $T_p\,\U_i=T_p\,\U_j$. But by lemma \ref{lem:dirreconstr} this would imply that $v_i = cv_j$ for a $c\in \R_+$, where $v_i = \gamma'(1)_{q,w_i}, v_i = \gamma'(1)_{q,w_i}$. This would imply $w_i = w_j$, a contradiction.
\end{proof}

\begin{definition}[Regular Point]\label{def:regpt}
We call a point $p\in \mc{P}_K(q)$ \emph{regular} if there exists an open neighborhood $\mc{U}\subset M$ of $p$ such that $\mc{U}\cap \mc{P}_K(q)$ is a $n-1$ dimensional submanifold of $M$.

Note that $p\in \mc{P}_K(q)$ is regular if and only if $N=1$ for $p$ in the previous proposition.
\end{definition}


\begin{corollary}\label{cor:opendense}
    The subset of regular points $\mc{P}^{reg}_K(q)\subset \mc{P}_K(q)$ is open and dense in $\mc{P}_K(q)$.
\end{corollary}
\begin{proof}
The fact that it is open follows immediately from the definition: Let $p\in \mc{P}_K(q)$ be regular. There thus exists an open neighborhood $p\in \mc{U}\subset M$ such that $\U \cap \mc{P}_K(q)$ is a submanifold. But now for every point $p'\in \U\cap\mc{P}_K(q)$, $\mc{U}$ also makes $p'$ a regular point making $\U\cap\mc{P}_K(q)$ an open neighborhood of regular points of $p$. Thus every regular point has an open neighborhood of regular points making the set of regular points itself open.

To prove the set of regular points is dense in $\pq$ we to show that for every point $p\in \mc{P}_K(q)$, every relatively open neighborhood $U'\subset\mc{P}_K(q)$ contains a regular point. By the previous proposition, for $U'$ small enough we have $\mc{P}_K(q)\cap U' = \bigcup_{i=1}^N\,\U_i$, where $\U_i$ are pairwise transversal. This means their intersection is of lower dimension and 
\[
    \U_i \setminus \bigcup_{j\neq i}\, \U_j \quad \text{ is open and nonempty for every }i=1,\dots N.
\]
We can find a $p'\in \mc{U}_i$ for some $i\in 1,\dots,N$ such that $p'\notin \mc{U}_j$ for $j\neq i$. Then because $\U_i \setminus \bigcup_{j\neq i}$ is open can find an open neighborhood $\mc{O}'$ around $p'$ such that $\mc{O}'\cap \mc{P}_K(q)\subset \mc{U}_i$ which means $p'$ is a regular point, as desired.
\end{proof}

\section{Observation Time Functions}
In this sections we will use the fact that we can cover $K$ with null geodesics $\mu_a$ to give structure to the light observation sets $\mc{P}_K(q)$.

\begin{definition}[Observation Time Function]\label{def:observationtime}
For $a\in \sn$ the \emph{observation time function} 
is defined as 
\begin{align*}
    f_a:\jp&\to [-T_a,0]\\
    q&\mapsto\inf(\{s\in [-T_a,0] \mid \mu_a(s)\in J^+(q)\}\cup \{0\}).
\end{align*}
Moreover, we define the \emph{earliest observation point} $\mc{E}_a(q)\coloneqq\mu_a(f_a(q))\in M$. 

Intuititively, $f_a(q)$ corresponds to the earliest time at which the observer $\mu_a$ measures light from $q$ and $\mc{E}_a(q)$ is the point at which this happens.
\end{definition}

We will first give some useful properties of these observation time functions: (1) corrensponds to the fact that future light cones from points $q\in \interior{\jp}$ only intersect the interior of $K$, as show in lemma \ref{lem:Kcharact}(2-3).
\begin{lemma}\label{lem:observationtime}
Let $a\in \sn$ and $q \in \ijp$. Then
\begin{enumerate}[label={\textnormal{(\arabic*)}}]
    \item It holds that $f_a(q)\in (-T_a,0)$.
    \item We have $\mc{E}_a(q)\in J^+(q)$ and $\tau(q,\mc{E}_a(q))=0$. Moreover the function $s\mapsto\tau(q,\mu_a(s))$ is continuous, non-decreasing on $[-T_a,0]$ and strictly increasing on $[f_a(q),0]$.
    \item Let $p\in K$. Then $p=\mc{E}_a(q)$ with some $a\in \ca$ if and only if $p\in \mathcal{P}_K(q)$ and $\tau(p,q)=0$. Furthermore, these are equivalent to the fact that there are $v\in L^+_qM$ and $t\in[0,\rho(q,v)]$ such that $p=\gamma_{q,v}(t)$.
\end{enumerate}
\end{lemma}
\begin{proof}
Let $a\in \mc{A}$ and $q\in V$.

We begin by showing (1): 
Because $q \in \interior{\jp} = I^+(p^-)\cap I^-(p^+)$ we have $q\in I^-(p^+)$ and conversely $p^+\in I^+(q)$. By lemma \ref{lem:Iopen} we know that $I^+(q)$ is open and thus it forms an open neighborhood of $p^+$. But as $\mu_a$ is a continuous path with $\mu_a(1)=p^+$ there must exist a $t<0$ such that $\mu_a(t)\in I^+(q)\subset J^+(q)$. Hence we have $f_a(q)<0$.

To show $f_a(q)>-T_a$ we assume $f_a(q)=-T_a$ to achieve a contradiction. We thus have $-T_a=\inf \{s\in [-T_a,0] \mid \mu_a(s)\in J^+(q)\}$. This means that there exists a convergent sequence $t_n\searrow 0$ as $n\to \infty$ such that $\mu_a(t_n)\in J^+(q)$ for all $n$. Because $\mu_a$ is continuous and $J^+(q)$ closed we have $p_0:=\mu_a(-T_a)\in J^+(q)$. But $p_0=\mu_a(-T_a)\in R$ by prop \ref{prop:thetaconstr}(2). Hence we get $p_0\in J^+(q) \cap R$ for $q\in V$, which is a contradiction to \ref{lem:Kcharact}(3).

To show (2) we proceed as follows:
By the definition of the infimum we can find a sequence $t_n\searrow f_a(q)$ such that for all $t_n$ we have $\mu_a(t_n)\in J^+(q)$. Now since $t\mapsto \mu_a(t)$ is continuous we have that $\mu_a(t_n)\to \mu_a(f_a(q)) = \mc{E}_a(q)$. Since $J^+(q)$ is closed this yields $\mc{E}_a(q)\in J^+(q)$. 

For the second part we assume by contradiction that $\tau(q,\mc{E}_a(q)) > 0$. Since this means that a timelike path from $q$ to $\mc{E}_a(q)$ exists we have $\mc{E}_a(q)\in I^+(q)$. Then, since $I^+(q)$ is open we can find a $t<f_a(q)$ such that $\mu_a(t)\in I^+(q) \subset J^+(q)$. This is a contradiction since $f_a(q)$ is the infimum over such $t$.

To show that $s\mapsto \tau(q,\mu_a(s))$ is continuous and non-decreasing on $[-T_a,0]$ we first note that it is the composition of two continuous functions. Monotony then follows from the reverse triangle inequality for $\tau$ (see \ref{rmk:causalitysummary}(2)) together with the fact that $\mu_a$ is a future pointing null geodesic.

To show that $s\mapsto \tau(q,\mu_a(s))$ is strictly increasing in $[f_a(q),0]$ we let $f_a\leq t_1<t_2\leq 0$. Now by \ref{rmk:causalitysummary}(4) there exists a causal geodesic $\gamma_1:[0,1]\to M$ with $\gamma_1(0)=q$ and $\gamma_1(1)=\mu_a(t_1)$ such that $L(\gamma_1)=\tau(p,\mu_a(t_1))$. 
If we then connect $\gamma_1$ to $\mu_a\rvert_{[t_1,t_2]}$ we get a path $\gamma_2$ connecting $q$ to $\mu_a(t_2)$ which has length $L(\gamma_2) = L(\gamma_1)$ as $\mu_a$ is a null geodesic. Next we argue that $\gamma_2$ must have a break at the connecting point, i.e. $\gamma_1'(1) \neq c\mu_a'(t_1)$ for any $c\in \R_+$. If $\gamma_1$ is timelike this observation is trivial as $\mu_a$ is lightlike. If however, $\gamma_1$ is lightlike (which is only the case if $t_1=f_a(q)$), this fact follows from the transversality of light cone observations as noted in proposition \ref{lem:transversality}. This means that $\gamma_2$ is a broken causal geodesic, which implies that there exists a strictly longer timelike geodesic $\gamma_3$ connecting the endpoints and we get
\[
\tau(q,\mu_a(t_2)) \geq L(\gamma_3) > L(\gamma_2) = L(\gamma_1) = \tau(q,\mu_a(t_1)).
\]

Finally we can take on (3)
To prove the fist direction we assume that $p=\mc{E}_a(q)$ for some $a\in \mc{A}$. Now by (2) we have $\mc{E}_a(q) \in J^+(q)$ and $\tau(q,\mc{E}_a(q))=\tau(q,p)=0$. But now, by \ref{rmk:causalitysummary} there exists a null geodesic from $q$ to $p$ which means $p\in \mc{P}_K(q)$. 

For the other direction we let $p\in \mc{P}_K(q)$ with $\tau(q,p)=0$. Now let $a\in \mc{A}$ such that $p=\mu_a(t)$ for some $t\in [0,1]$. We then assume by contradiction that $\mc{E}_a(q) \neq p$, i.e. $f_a(q) < t$. But by (2) we have that $s\mapsto\tau(q,\mu_a(s))$ is strictly increasing after $f_a(q)$ which is in contradiction with $\tau(q,p)=0$.

The other equivalence follows from the definition of $\mc{P}_K(q)$ together with the definition of cut points.
\end{proof}

By (3) of the above lemma, for any $q\in V$ and $a\in \ca$ we have $\mc{E}_a(q)\in \P_K(q)$. Since $\P_K(q)\subset J^+(q)$, we can see using definition \ref{def:observationtime} that the set of earliest observations $\P_K(q)$ and the path $\mu_a$ completely determine the functions
\begin{align}\label{eq:observationtimerestated}
    f_a(q) = \min \{ s\in [-T_a,0] \mid \mu_a(s)\in \P_U(q) \}, \quad \mc{E}_a(q) = \mu_a(f_a(q))
\end{align}

Note that we can use $f_a(q)$ to define the related functions $f:\jp \times \times \sn \to [-T_\sn,0]; (q,a)\mapsto f_a(q)$ and $F_q:\sn \to [-T_\sn,0]; a\mapsto f_a(q)$. 

% \begin{lemma}\label{lem:qcont} Let $a\in \sn$. Then the function $q\mapsto f_a(q)$ is continuous on $V$.
%\end{lemma}
% \begin{proof}
%     Let $q_i\to q$ in $V$, let $t_i = f_a(q_i)$ and $t=f_a(q)$. Since $\tau$ is continuous, for any $\varepsilon>0$ we have $\lim_{j\to \infty} \tau(q_j,\mu_a(t+\varepsilon)) = \tau(q,\mu_a(t+\varepsilon)) > 0$. Thus for $i$ big enough we have $\tau(q_i,\mu_a(t+\varepsilon))>0$. But by (3) this implies that $a$ must have observed $q_i$ before $t+\varepsilon$ i.e. $f_a(q_i)<t+\varepsilon = f_a(q) + \varepsilon$. As $\varepsilon$ was arbitrary we get $\limsup_{j\to \infty} t_j \leq t$.

%     We assume now that $\liminf_{i\to \infty} t_i=t'<t$. Let $(t_i)$ be a convergent subsequence such that $f_a(q_i) = t_i \to t' < f_a(q)$. Now by the continuity of $\tau$ and $\mu_a$ we have 
%     \[
%     0=\tau(q_i,\mu_a(f_a(q_i)))\to \tau(q,\mu_a(t')).
%     \]
%     Furthermore by ((REF)) $\mu(t_i)\in J^+(q_i)$ for all $i$ implies $\mu(t')\in J^+(q)$. Now we have $\mu_a(t')\in \mc{P}_K(q)$ and $\tau(q,\mu_a(t'))=0$ which by (3) implies that $\mu_a(s') = \mc{E}_a(q) = \mu_a(f_a(q))$. But this is a contradiction as $s'<f_a(q)$.
% \end{proof}

% \begin{lemma}\label{lem:acont} Let $q\in V$. Then the function $a\mapsto f_a(q)$ is continuous on $\sn$.
% \end{lemma}
% \begin{proof}
%     Let $q\in V$ and $a_n\to a_0\in \sn$ as $n\to \infty$. Let $t_n = f_{a_n}(q), t_0 = f_{a_0}(q)$ and $p_0 = \mc{E}_{a_0}(q) \in \pq$.
%     We assume by contradiction that $t_n$ does not converge to $t_0$ as $n\to \infty$. Because $[0,1]$ is compact there exists a convergent subsequence $t_j=f_{a_j}(q) \to t' \neq t_0=f_{a_0}(q)$. But now because $a_j \to a_0$, $t_j\to t'$ and $\Theta:\sn\times[0,1]\to K$ is continuous we have 
%     \[
%         \mc{E}_{a_j}(q) = \mu_{a_j}(f_{a_j}(q)) = \mu_{a_j}(t_j) = \Theta(a_j,t_j) \to \Theta(a_0,t') = \mu_{a_0}(t').
%     \]
%     Note that because $\mc{E}_{a_j}(q)\in J^+(q)$ for all $j$ and $J^+(q)$ is closed we also have $\mu_{a_0}(t')\in J^+(q)$.
%     The continuity of $\tau$ now yields 
%     \[
%         0 = \tau(q,\mc{E}_{a_j}(q)) \to \tau(q,\mu_{a_0}(t')) = 0.  
%     \]
%     Now $\mu_{a_0}(t')\in J^+(q)$ and $\tau(q,\mu_{a_0}(t'))=0$ imply there exists a null geodesic from $q$ to $\mu_{a_0}(t')$ and importantly, $\mu_{a_0}(t')\in \pq$.
%     Note that $t'\neq t_0=f_{a_0}(q)$ implies $\mu_{a_0}(t') \neq p_0=\mc{E}_{a_0}(q) = \mu_{a_0}(f_{a_0}(q))$.

%     We now treat the cases $t'>t_0$ and $t'<t_0$ seperately: Assume $t'>t_0$. Then we have a $t'>f_{a_0}(q)$ such that $\tau(q,\mu_{a_0}(t'))=0$. But this is a contradiction to the fact that $s\mapsto \tau(q,\mu_{a_0}(s))$ must be strictly increasing after $f_{a_0}(q)$ as stated in lemma \ref{lem:observationtime}(2).

%     We now assume $t'<t_0$. Then $\mu_{a_0}(t')\in J^+(q)$ is a contradiction to the fact that $t_0 = f_{a_0}(q)$ is the infimum over all such $t$.

%     Thus every subsequence $t_j$ must converge to $t_0$ which means $t_n=f_{a_n}(q)\to t_0=f_{a_0}(q)$ because we are in a compact space.
% \end{proof}

\begin{proposition}\label{prop:fcont} 
    The function $f:\ijp\times\sn\to[-T_\sn,0];\; (q,a)\mapsto f_a(q)$ is continuous.
\end{proposition}
\begin{proof}
    We want to show that for every convergent sequence $(q_n,a_n)\to (q_0,a_0)\in \ijp\times \sn$ we have $t_n:=f_{a_n}(q_n)\to f_{a_0}(q_0)=:t_0$ as $n \to \infty$. Because the sequence $t_n$ lives in $[-T_\sn,0]$ and is thus bounded it suffices to show that for every convergent subsequence $t_j = f_{a_j}(q_j) \to t'$ we have $t'=t_0$. Note that still $(q_j,a_j)\to (q_0,a_0)$ because they are the subsequence of a convergent sequence. The points of earliest observation converge:
    \[
        \mc{E}_{a_j}(q_i) = \mu_{a_j}(f_{a_j}(q_j)) = \mu_{a_j}(t_j) = \Theta(a_j,t_j) \to \Theta(a_0,t') = \mu_{a_0}(t')=p'
    \] because $(a_j,t_j)\to (a_0,t')$ and $\Theta$ is continuous.
    The first key observation is that  because $q_j\to q_0$ and $J^+(q_i)\ni\mc{E}_{a_j}(q_j) \to  p'$ lemma \ref{lem:Jclosed} implies $p'\in J^+(q_0)$.

    Furthermore we have
    \[
        0=\tau(q_j,\mc{E}_{a_j}(q_j))=\tau(q_j,\Theta(a_j,t_j))\to \tau(q_0,\Theta(a_0,t')) = \tau(q_0,p')=0
    \] because $\tau$ and $\Phi$ are continuous.

    We can now combine these observations and get: $p'\in \mc{L}^+_{q_0}$ because $p'\in J^+(q_0)$ and $\tau(q_0,p')=0$ imply that there exist a null geodesic from $q_0$ to $p'$. $p'\in \mc{P}_K(q_0)$ because $p'\in \mu_{a_0}([0,1])\subset K$ and $p'\in \mc{L}^+_{q_0}$. But now lemma \ref{lem:observationtime}(3) yields that $p'=\mc{E}_{a_0}(q_0)$ and we get 
    \[
        \mu_{a_0}(t') = p' = \mc{E}_{a_0}(q_0) = \mu_{a_0}(f_{a_0}(q_0))= \mu_{a_0}(t_0).
    \]
    Because $\mu_a$ is injective we get $t'=t_0$, as desired. Hence every convergent subsequence of $t_n$ goes to $t_0$ which, by compactness of $[-T_\sn,0]$, implies that also $f_{a_n}(q_n)=t_n \to t_0 = f_{a_0}(q_0)$, proving that $f$ is continuous.
\end{proof}

\begin{proposition}\label{prop:funif}
    If $q_n \to q_0\in \ijp$ as $n\to \infty$ and we denote $F_q:\sn\to\R;a\mapsto f_a(q)$. Then $F_{q_n}\to F_{q_0}$ uniformly over $\sn$ as $n\to \infty$.
\end{proposition}
\begin{proof}
    Let $q_n \to q_0 \in V$ be a convergent sequence. We can endow $M$ with a metric $d$, which is induced by $g^+$. Then there exists an $\varepsilon>0$ and a $N\in \N$ such that $q_n\in \overline{B_\varepsilon(q_0)}$ for all $n\ge N$. After discarding the first $N$ points of the sequence we may assume that $q_n \in \overline{B_\varepsilon(q_0)} \; \forall n$.

    By the previous proposition 
    \begin{align*}
        f:(\overline{B_\varepsilon(q_0)},d)\times(\sn, d_{\sn}) \to ([0,1],d_{[0,1]})
    \end{align*} is a continuous function from and to compact spaces. Now we can apply lemma \ref{lem:unifconvoncompact} to find that $F_{q_n}\to F_{q_0}$ uniformly.
     
\end{proof}

\subsection{Set of earliest observations}
After defining the observation time functions and the earliest observation point for a $q\in V$ and observer $\mu_a, a\in \sn$. We can now at the set of all earliest observation points together:
\begin{definition}[Set of earliest observations]
For $q\in \overline{V}$ we define
\begin{alignat*}{2}
    \mathcal{D}_K(q) &=\; &\{(p,v)\in L^+M \mid &(p,v) = (\gamma_{q,w}(t),\gamma'_{q,w}(t)) \\
    &&&\text{ where } p\in K, w\in L_q^+M, 0\leq t \leq \rho(q,w)\},\\
    \mathcal{D}^{reg}_K(q) &=\; &\{(p,v)\in L^+M \mid &(p,v) = (\gamma_{q,w}(t),\gamma'_{q,w}(t)) \\
    &&&\text{ where } p\in K, w\in L_q^+M, 0 < t < \rho(q,w)\},
\end{alignat*}
We say that $\mathcal{D}_K(q)$ is the \emph{direction set} of $q$ and $\mathcal{D}^{reg}_K(q)$ is the \emph{regular direction set} of $q$.

Let $\mc{E}_K(q) := \pi(\mathcal{D}_K(q))$ and $\mc{E}^{reg}_K(q) := \pi(\mathcal{D}^{reg}_K(q))$, where $\pi:TM\to M$ is the canonical projection. We say that $\mc{E}_K(q)$ is the \emph{set of earliest observations} and $\mc{E}^{reg}_K(q)$ is the \emph{set of earliest regular observations} of $q$ in $K$. We denote the collection of earliest observation sets by $\mc{E}_K(V) = \{ \mc{E}_K(q) \mid q\in V\}$.
\end{definition}
Note that $\mc{E}_K(q) = \{ \mc{E}_a(q) \mid a\in \sn \}$, and thus is really the set of all earliest observation points of $q$. The intuition for the direction set $\mc{D}_K(q)$ is that they contain all points $p\in \ee(q)$ together with the directions of the corresponding null geodesics going from $q$ to $p$, at $p$.

We can now characterize these observation sets and see that regular points in $\er(q)$ resp. $\mc{D}^{reg}_K(q)$ correspond to regular observation points $p\in \mc{P}^{reg}_K(q)$:
\begin{proposition}\label{prop:submanifolds}
For any $q\in V$ it holds that
\begin{enumerate}[label={\textnormal{(\arabic*)}}]
    \item Let $T=\{p\in \mc{L}^+_q \mid \tau(q,p)=0\}$ then 
    \[
        \mc{E}_K(q) = \mc{P}_K(q) \cap T \quad \text{and} \quad \mc{E}^{reg}_K(q) = \mc{P}^{reg}_K(q) \cap T,
    \]
    \item  $\mc{E}^{reg}_K(q)$ is an open subset of $\mc{P}^{reg}_K(q)$, and is thus also a $n-1$-dimensional spacelike submanifold of $K$,
    \item $\mc{E}_K(q)$ fails to be a submanifold exactly at cut points,
    \item $\overline{\mc{E}^{reg}_K(q)}$ is open and dense in $\mc{E}_K(q)$ and
    \item $\mc{D}^{reg}_K(q)$ is a nonempty open $n$-dimensional submanifold of $\pi^{-1}(K)$.
\end{enumerate}
\end{proposition}
\begin{proof}
Let $q\in V$. We first look at a useful relation of the exponential map to cut points: We define $\mc{V}:=\{w\in L^+_qM \mid \rho(q,w)>1\}$. By \ref{prop:rhosemicont}, $\rho(q,w)$ is lower semicontinuous and $\mc{V}$ is thus open. Furthermore, by the definition of cut points, $\mc{V}$ is star-shaped around $0\in L^+_qM$. Because by \ref{thm:cutpointcharact} cut points are exactly the points where $\exp_q$ first fails to be a diffeomorphism, $\exp_q:\mc{V}\to \mc{W}:=\exp_q(\mc{V})$ is a diffeomorphism. Furthermore by the invarance of domain theorem we get that $\mc{W}\subset \mc{L}^+_q$ is relatively open. Note that this implies that for any $p\in \mc{W}$, there exists a $p\in U\subset M$ open such that $p\in\mc{L}^+_q\cap U$ is a $n$-dimensional submanifold of $M$.

We can now move on to proving (1): $p\in \mc{E}_K(q) \iff p\in \mc{P}_K(q) \cap T$ follows immediately from lemma \ref{lem:observationtime}(3).

Now let $p\in\mc{E}^{reg}_K(q)$. By definition this implies that $p\in \mc{W}$ and we get an $p\in U\subset M$ open such that $p\in\mc{L}^+_q\cap U$ is a dimension $n$ submanifold. Now, around $p$, $K$ is also a dimension $n$ submanifold, transversal to $\mc{L}^+_q$ and thus $K \cap \mc{L}^+_q \cap U = \pq \cap U$ is a dimension $n-1$ submanifold around $p$. Thus $p$ is a regular point, i.e. $p\in \mc{P}^{reg}_K(q)$. $\tau(q,p)=0$ follows immediately from the fact that $\rho(q,w)>1$, proving the first direction.

To show the reverse direction we assume $p\in \mc{P}^{reg}_K(q)$ with $\tau(q,p)=0$.
Because $p\in \mc{P}^{reg}_K(q)$ by definition \ref{def:regpt} there exists exactly one $w\in L^K_qM$ such that $\exp_q(w)=p$. From $\tau(q,w)=0$ we get $\rho(q,p)\ge 1$. Now if $\rho(q,w)=1$, $p$ would be a cut point. By theorem \ref{thm:cutpointcharact} this would mean that either $p\in K$ is a conjugate point to $q$ or there exists a $w\neq w'\in L^K_qM$ with $\exp_q(w')=p$. The first option is impossible because we assumed $V$ to be suitable which means that no $q\in V$ can have a conjugate point on $K$. The second option is also impossible because we assumed $p$ to be a regular point in $\mc{P}_K(q)$. We thus must have $\rho(q,w)>1$, implying $p\in \mc{E}^{reg}_K(q)$.

We now move on to (2): To prove that $\mc{E}^{reg}_K(q)$ is open in $\mc{P}^{reg}_K(q)$ we claim that $\mc{E}^{reg}_K(q)=\mc{P}^{reg}_K(q)\cap \mc{W}$. To that end we first note that $\mc{E}_K^{reg}(q)\subset \mc{W} \subset T$. Recall that by (1) we have $\mc{E}_K^{reg}(q) = \mc{P}_K^{reg}(q) \cap T$. Applying $\cap \mc{W}$ to both sides yields
\[
    \mc{E}_K^{reg}(q) = \mc{E}_K^{reg}(q) \cap \mc{W} = \mc{P}_K^{reg}(q) \cap T \cap \mc{W} = \mc{P}_K^{reg}(q) \cap \mc{W}
\] as desired.

Proposition \ref{prop:unionmanif} implies that $\mc{P}^{reg}_K(q)$ is a $n-1$ dimensional spacelike submanifold of $M$. Because $\mc{W}\subset \mc{L}^+_q$ is open and $\mc{P}^{reg}_K(q)\subset \mc{L}^+_q$, $\mc{E}^{reg}_K(q)$ is a relatively open subset of $\mc{P}^{reg}_K(q)$, as desired. This also means that as an open subset of a submanifold, $\mc{E}^{reg}_K(q)$ is a $n-1$-dimensional spacelike submanifold of $K$ as well.

We can now tackle (3): 
Let $p\in \mc{E}_K(q)$ be a cut point, then by proposition \ref{prop:unionmanif}, there exists an open neighborhood $p\in U \subset M$ and $N$ codimension 1 pairwise transversal manifolds $\U_i\subset K$ such that $\mc{P}_K(q)\cap U = \bigcup_{i=1}^N \; \U_i$. Because $\tau(q,p)=0$ and the manifolds are pairwise transversal and intersect at $p$ ((SEE FIGURE)), $\mc{E}_K(q)$ must have a sharp edge at $p$ and cannot be a submanifold. For the other direction we assume that $p\in \mc{E}_K(q)$ is not a cut point. Then, by definition we have $p\in \mc{E}^{reg}_K(q)$ which is a submanifold.

Moving on to (4), the fact fact that $\mc{E}^{reg}_K(q)$ is dense in  $\mc{E}_K(q)$ follows by an argument which is analogous to the one used in the proof of corollary \ref{cor:opendense}. To show that it is relatively open in $\mc{E}_K(q)$ we use that $\mc{E}^{reg}_K(q) = \mc{E}_K(q) \cap \mc{W}$ with $\mc{W}$ open in $\mc{L}^+_q$.

Finally the proof of (5) is analogous to (2) with the difference in submanifold dimension originating from the face that for any $(p,v)\in \mc{D}^{reg}_K(q)$ we also have $(p,cv)\in \mc{D}^{reg}_K(q)$ for all $c\in \R_+$ ((explain more)).
\end{proof}

Note that since $\mc{E}^{reg}_K(q)$ is exactly $\mc{E}_K(q)$ without the cut points, (3) implies that it is also the collection of all points where $\mc{E}_K(q)$ is locally a submanifold.

We can now give an alternative characterization of $\ee(q)$ which is intuitively more in line with \enquote{the set of earliest observations}
\begin{proposition}\label{prop:seocharact}
Let $q\in V$, then 
\begin{equation*}
    \mc{E}_K(q) = \{ p \in \P_K(q) \mid \text{there are no $p'\in \P_K(q)$ such that $p' < p$} \}.
\end{equation*}
\end{proposition}
\begin{proof}
For the left inclusion assume $p\in \mc{E}_K(q)$, i.e. there exists an $a\in \sn$ such that $\mc{E}_a(q)=p$. Then lemma \ref{lem:observationtime}(3) immediately yields, $p\in \P_K(q)$ and  $\tau(q,p)=0$. Now suppose there were a $p'\in \P_U(q)$ with $p'\ll p$. Because $\P_K(q)\subset J^+(q)$ we have $q\leq p'$, then as $p'\ll p$ we get $q\ll p$. But this would imply $\tau(p,q)>0$, a contradiction.

For the other direction we assume we have $p=\mu_a(t) \in \P_U(q)$ such that there are no $p'\in\P_U(q)$ such that $p'\ll p$. Again by lemma \ref{lem:observationtime}(3) we only need to prove that $\tau(p,q)=0$. Suppose that $\tau(p,q)>0$. Now since $\tau(p,q)>0$, we must have $s > f_a(q)$. But then $\mc{E}_a(q) = \mu_a(f_a(q)) \ll  \mu_a(s)$, since $\mu_a$ is timelike, which is a contradiction.
\end{proof}

\subsection{Observation Reconstruction}
Crucially all observation sets defined in the previous sections can be fully determined by the data, the core idea is that we can use lemma \ref{lem:dirreconstr} to determine the direction of incoming geodesics on $\mc{P}_K(q)$ allowing us to reconstruct the direction sets.
\begin{proposition}\label{prop:obsreconstr}
    Given the data outlined in remark \ref{rmk:data} we can uniquely determine $\mc{E}_K(q)$ and $\mc{E}^{reg}_K(q)$, as well as $\mc{D}_K(q)$ and $\mc{D}^{reg}_K(q)$.
\end{proposition}
\begin{proof}
    What we want to show is that given $K$, the conformal class of $g\rvert_{K}$ and the set $\{\pq \mid q\in V\}$ we can reconstruct the sets stated above. Note that as described in proposition \ref{prop:thetaconstr} ((Move to own remark?)) this data allows us to construct $\Theta:\mc{S}\to K$ and $\mu_a$.

    We first show that for a given $\mc{P}_K(q)$ we can determine $\mc{E}_K(q)$: By equation \ref{eq:observationtimerestated}, for any $a\in \sn$ we can determine $f_a(q)$ and thus $\mc{E}_a(q)=\mu_a(f_a(q))$ using only $\pq$. We can then construct $\mc{E}_K(q) = \bigcup_{a\in \sn} \mc{E}_a(q)$. Furthermore, by proposition \ref{prop:submanifolds}, $\er(q)$ contains exactly the points $p\in \ee(q)$ where $\ee(q)$ is locally a submanifold of $M$ and thus $K$. But because we know $K$ we can determine all points where this is the case and reconstruct $\er(q)$. 

    To reconstruct the direction set we first note that by lemma \ref{prop:unionmanif} for any $p\in \pq$ such that $\exp_q^{-1}(p)=\{w_1,\dots,w_N\}\subset L^K_qM$, we have $\pq \cap U = \bigcup_{i=1}^N\; \U_i$ where $p\in U\subset M$ open and $p\in \U_i$ are pairwise transversal spacelike hypersurfaces of $K$. For each $w_i$ we let $v_i=\gamma'_{q,w_i}(1)$ be the outbound velocity vector of the null geodesic which starts at $q$ with velocity $w_i$, once it hits $K$. To find $\mc{D}_K(q)$ we must reconstruct all such $v_i$.
    
    To that end, note that we have $T_p\pq = \bigcup_{i=1}^N T_p\,\U_i$ where $T_p\,\U_i$ are spacelike hyperplanes. For each such hypersurface, using lemma \ref{lem:dirreconstr} we can then find the outward pointing orthogonal null ray $\R_+v_i$ which must contain the outbound velocity vector $v_i$ at $p$. Thus for any $p\in \pq$ we can reconstruct $\R_+v_i$ for all geodesics $\gamma_{q,w_i}$ from $q$ to $p$.

   Now by definition for any $p\in \ee(q)$, we have 
    \[
        \mc{D}_p := \pi^{-1}(p)\cap \mc{D}_K(q) = \{(p,\R_+v_1), \dots, (p,\R_+v_N)\}
    \]
    where $\pi:TM\to M$ is the canonical projection. As we saw for any $p\in \ee(q)\subset \pq$ we can reconstruct $\mc{D}_p$ which allows us to reconstruct $\mc{D}_K(q) = \bigcup_{p\in \ee(q)} \mc{D}_p$.

    Finally we can reconstruct $\mc{D}^{reg}_K(q)$ by using $\mc{D}^{reg}_K(q)=\pi^{-1}(\er(q)) \cap \mc{D}_K(q)$.
\end{proof}
Note that we can adapt this proof to show that $\ee(q)$ uniquely determines $\er(q), \mc{D}_K(q)$ and $\mc{D}^{reg}_K(q)$.

Because if the earliest observation set are equal also the direction sets must be equat we get:
\begin{proposition}\label{prop:einj}
    Let $q,q'\in V$ such that $\ee(q)=\ee(q')$. Then $q=q'$.
\end{proposition}
\begin{proof}
    We assume by contradiction that $q,q'\in V$ such that $\ee(q)=\ee(q')$ and $q\neq q'$
    Let $p_1, p_2 \in \er(q)=\er(q')$ with $p_1\neq p_2$. Because $p_1$ and $p_2$ cannot be cut points there must exist unique $w_1,w_2\in L^K_qM$ and $w'_1,w'_2\in L^K_{q'}M$ such that $\gamma_{q,w_i}(1)=p_i$ and $\gamma_{q',w'_i}(1)=p_i$. Because $\er(q)=\er(q')$ we can use lemma \ref{lem:dirreconstr} to show that 
    \[
        v_i = \gamma'_{q,w_i}(1) = c_i\gamma_{q',w'_i}(1)=c_iv'_i
    \] for some $c_i>0$.

    Now $\gamma_{p_i,-v_i}$ are two past-pointing null geodesics going from $p_i$ through $q$ and $q'$. Hence there either exists a null geodesic from $q$ to $q'$ or from $q'$ to $q$. We will WLOG assume $q'\in J^+(q)$. 
    Now there must exist $t_1, t_2 \in (0,1)$ such that $\gamma_{q,w_i}(t_i)=q'$. But this would make $q'$ a cut point of $q$ which is impossible as we assumed $p_i\in \er(q)$.
\end{proof}


\section{Smooth Constructions}
Finally in this chapter we show some important differential properties of the observation time functions:  
\subsection{Coordinate Construction}
We will now show that for $q\in V$ and well-chosen $a_0,\dots a_n$, the map $q'\mapsto (f_{a_0}(q'), \dots, f_{a_n}(q'))$ defines local coordinates, as discussed in the introduction.
To prepare we look at tuples $(q,p)$ of the form $q\in V, p\in \er(q)$ and show that they form a manifold:
\begin{definition}[Coordinates on $V$]
    We first define 
    \[
        \mc{Z} = \{(q,p)\in V\times K \mid p\in \mc{E}_K^{reg}(q)\}.
    \] 
    Then for every $(q,p)\in \mc{Z}$ there is a unique $w(q,p)\in L^K_qM$ such that $\gamma_{q,w(q,p)}(1)=p$ and $\rho(q,w(q,p))>1$. Existence follows from lemma \ref{lem:observationtime} while uniqueness follows from the fact that $p\in \mc{E}_K^{reg}(q)$ and thus cannot be a cut point. 
    We can then define the map
    \begin{align*}
        \Omega:\mc{Z}&\mapsto L^KV\\
        (q,p)&\mapsto (q,w(q,p))
    \end{align*}
    Note that this map is injective.
    Below we will $\mc{W}_\varepsilon(q_0,w_0)\subset TM$ be a $\varepsilon$-neighborhood of $(q_0,w_0)$ with respect to the Sasaki-metric induced on $TM$ by $g^+$.
\end{definition}

This lemma will be useful because it will allow us to show that $\Omega$ is bounded
\begin{lemma}\label{lem:Tprop}
    ((Move to appendix?))The function
    \begin{align*}
        T_+:L^+\jp&\to \R \\
        (q,w)&\mapsto \sup \{ t\ge 0 \mid \gamma_{q,w}(t)\in J^-(p^+)\}
    \end{align*}
    is finite and upper semicontinuous.
\end{lemma}
\begin{proof}
    Finiteness follows from lemma \ref{lem:leavescompact}. We now want to show that $T_+$ is upper semicontinuous. To that end let $(q_n,w_n)\to (q_0,w_0)\in L^+\jp$, we want to show that $\limsup_{n\to \infty} T_+(q_n,w_n) \leq T_+(q_0,w_0)$: Let $\varepsilon>0$ and set $t_0 = T_+(q_0,w_0)$. Then by definition we have $\gamma_{q_0,w_0}(t_0)\in M \setminus J^-(p^+)$. Because $\gamma_{q_n,w_n}(t_0) \to \gamma_{q_0,w_0}(t_0)$ and $M \setminus J^-(p^+)$ open, there exists a $N\in \N$ such that $\gamma_{q_n,w_n}(t_0)\in M \setminus J^-(p^+)$ for all $n\ge N$. Note that if $\gamma_{q_n,w_n}(t_0)\notin J^-(p^+)$ then for any $t'\ge t_0$ we also have $\gamma_{q_n,w_n}(t') \notin J^-(p^+)$ because otherwise we could obtain a lightlike path from $\gamma_{q_n,w_n}(t_0)$ to $p^+$, a contradiction. Thus, by definition $T_+(q_n,w_n)\leq t_0$ and 
    $\limsup_{n\to \infty} T_+(q_n,w_n) \leq t_0 = T_+(q_0,w_0)+\varepsilon$. Finally because $\varepsilon>0$ was arbitrary we get $\limsup_{n\to \infty} T_+(q_n,w_n) \leq T_+(q_0,w_0)$ as desired.
\end{proof}

This lemma will be very useful whenever we are dealing with $\mc{Z}$:
\begin{lemma}\label{lem:omegacoords}
Let $(q_0,p_0)\in \mc{Z}$ and $(q_0,w_0)=\Omega(q_0,p_0)$. When $\varepsilon>0$ is small enough the map 
\begin{align*}
    X:\mc{W}_\varepsilon(q_0,w_0) &\to M\times M\\
    (q,w) &\mapsto (q,\exp_q(w))
\end{align*}
is open and defines a diffeomorphism $X:\mc{W}_\varepsilon(q_0,w_0)\to \U_\varepsilon(q_0,p_0) \coloneqq X(\mc{W}_\varepsilon(q_0,w_0))$. When $\varepsilon$ is small enough, $\Omega$ coincides in $\mc{Z}\cap \U_\varepsilon(q_0,p_0)$ with the inverse map of $X$. Moreover $\mc{Z}$ is a $2n$-dimensional manifold and the map $\Omega:\mc{Z}\to L^KM$ is smooth.
\end{lemma}

\begin{proof}
    Because $p_0\in \mc{P}_K(q_0)$ and $q_0\in V$ we have, by assumption in theorem \ref{thm:intreconstr} that $p_0$ cannot be a conjugate point of $q_0$. Hence for $\varepsilon>0$ small enough $X:\mc{W}_{\varepsilon}(q_0,w_0)\to \mc{U}_{\varepsilon}(q_0,p_0) = X(\mc{W}_{\varepsilon}(q_0,w_0))$ is a diffeomorphism with $\mc{U}_{\varepsilon}(q_0,p_0)$ open in $M\times M$ by the invariance of of domain theorem. 
    
    Next we aim to show that $\Omega:\mc{Z}\to L^KV$ is continuous at $(q_0,p_0)\in \mc{Z}$. We proceed by assuming there exists a sequence $(q_n,p_n)\in \mc{Z}$ converging to $(q_0,p_0)$ such that $\Theta(q_n,p_n)=(q_n,w_n)\in L^+V$ does not converge to $\Theta(q_0,p_0)=(q_0,w_0)$.

    First of all we aim to show that the sequence $(q_n,w_n)$ is bounded and thus has a convergent subsequence: Because $q_n\to q_0$ we only need to show that $w_n$ is bounded. To that end we introduce an arbitrary riemannian metric consistent with the topology on $M$ and can write $w_n = t_n \overline{w_n}$ where $\lVert \overline{w_n} \rVert_{g^+}=1$. To show that $t_n$ is bounded we first define 
    \[
        C:=\{(q,w)\in L^+M \mid q\in \jp \text{ and } \lVert w \rVert_{g^+}=1\}
    \]
    and $C$ is compact and because $T_+$ is upper semicontinuous on $C$, there exists a $c_0>0$ such that $T_+(q,w)\leq c_0$ for all $(q,w)\in C$.
    Recall that we have $\gamma_{q_n,\overline{w_n}}(t_n)=\exp_{q_n}(w_n)=p_n \in K \subset \jp$. Together with $(q_n,\overline{w_n}) \in C$ this yields 
    \[
        \lVert w_n \rVert_{g^+} = t_n\lVert \overline{w_n} \rVert_{g^+} = t_n \leq T_{+}(q_n,\overline{w_n})<c_0,
    \] proving $(q_n,w_n) \in L^KV$ is bounded.

    We can thus obtain a convergent subsequence $(q_k,w_k)=\Theta(q_k,p_k)\to (q_0,w')$ with $w'\neq w_0$. Since the exponential map is continuous, we would have 
    \[
        \exp_{q_n}(w') = \lim_{n\to \infty} \exp_{q_n}(w_n) = \lim_{n\to\infty} p_n = p_0 = \exp_{q_n}(w_0).
    \] with $w'\neq w_0$. But since $p_0\in \er(q)$ cannot be a cut point this is a contradiction and $\Omega:\mc{Z}\to L^KV$ must be continuous.
    
    Next we use the fact that $\Omega$ is continuous and get $\Omega^{-1}(\mc{W}_{\varepsilon}(q_0,w_0)) \subset \mc{Z}$ is open. We can thus find a $\varepsilon_1\in (0,\varepsilon)$ such that for the open ball $\mc{U}_{\varepsilon_1}(q_0,w_0)\subset M$ we have 
    \[
        \mc{Y}_{\varepsilon_1}:=\mc{U}_{\varepsilon_1}(q_0,w_0) \cap \mc{Z} \subset \Omega^{-1}(\mc{W}_{\varepsilon}(q_0,w_0))
    \] implying $\Omega(\mc{Y}_{\varepsilon_1}) \subset \mc{W}_{\varepsilon}(q_0,w_0)$. Then for $(q,p)\in \mc{Y}_{\varepsilon_1}$ and $(q,w) = \Omega(q,p)\in \mc{W}_\varepsilon(p_0,w_0)$ we have $\exp_q(w) = p$. Hence $X(\Omega(q,p))=(q,p)$. But now since $(q,p)\in \U_\varepsilon(p_0,q_0)$ we can apply $X^{-1}$ to both sides and get $\Omega(q,p)=X^{-1}(q,p)$. Thus on $\mc{Y}_{\varepsilon_1}$ the function $\Omega:\mc{Y}_{\varepsilon_1}\to TM$ coincides with the smooth function $X^{-1}:\mc{Y}_{\varepsilon_1}\to TM$, which implies that $\Omega$ is smooth with full rank differential on $\mc{Y}_{\varepsilon_1}$ as well.
    
    Now since $(q_0,p_0)\in \mc{Z}$ was arbitrary we get that $\Theta:\mc{Z}\to L^+V$ is smooth everywhere, injective and locally diffeomorphic with full rank. Thus $\mc{Z}$ diffeomorphic to an open subset of $L^KV$. This makes it a manifold with dimension $(n+1)+(n-1)=2n$.
\end{proof}

We can now construct local coordinates:
\begin{proposition}\label{prop:observationtimecoordinates}
Let $q_0\in V$ and $(q_0,p_j)\in \mc{Z}, j=0,\dots, n$ and $w_j\in L^K_{q_0}M$ such that $\gamma_{q_0,w_j}(1) = p_j$. Assume that $w_j, j=1,\dots, n$ are linearly independent. Then, if $a_j\in A$ and $\overrightarrow{a} = (a_j)^n_{j=1}$ are such that $p_j\in \mu_{a_j}$, there is a neighborhood $V_1\subset M$ of $q_0$ such that the corresponding observation time functions 
\[
\mathbf{f}_{\overrightarrow{a}}(q) = (f_{a_j}(q))^n_{j=0}
\]
define smooth coordinates on $V_1$. Moreover $\nabla f_{a_j}\rvert_{q_0}$, i.e. gradient of $f_{a_j}$ with respect to $q$ at $q_0$, satisfies $\nabla f_{a_j}\rvert_{q_0} = c_jw_j$ for some $c_j\neq 0$.
\end{proposition}

\begin{proof}
    First we need some setup: Let $(q_0,p_0)\in \mc{Z}$ and $w_0\in L^+_{q_0}M$ such that $\gamma_{q_0,w_0}(1) = p_0$. Furthermore let $\varepsilon>0$ be small enough such that the map $X:\mc{W}_\varepsilon(q_0,w_0)\to \U_\varepsilon(q_0,p_0)$ is a diffeomorphism (see the previous lemma). We will denote this inverse by $X^{-1}(q,p) = (q,w(q,p))$ and write $\mc{W}=\mc{W}_\varepsilon(q_0,w_0), \U=\U_\varepsilon(q_0,p_0)$.
    
    We associate with any $(q,p)\in \mc{U}$ the energy $E(q,p)=E(\gamma_{q,w(q,p)}([0,1]))$ of the geodesic segment connecting $q$ to $p$. The energy of a piecewise smooth curve $\alpha:[0,l]\to M$ is defined as 
    \[
        E(\alpha) = \frac{1}{2}\int_0^l g(\alpha'(t),\alpha'(t))dt.
    \]
    Note that the sign of $E(\alpha)$ depends on the causal nature of $\gamma_{q,w(q,p)}$. In particular $E(q,p)=0$ if and only if $w(q,p)$ is light-like. Moreover, as $X^{-1}$ is smooth on $\U$, so is $E(p,q)$.
    
    We now return to consider $(q_0,p_0)\in \mc{Z}$ and let $a\in \sn$ be such that $p_0 \in \mu_a$. Then $p_0=\mu_a(s_0)$ with $s_0=f_a(q_0)$ as $p_0 \in \er(q_0)$ and $s_0\in (0,1)$ by lemma \ref{lem:observationtime}(1). 
    
    Let $V_0\subset V$ be an open neighborhood of $q_0$ and $t_1,t_2\in (-T_a,0), t_1<s_0<t_2$, such that $V_0\times\mu_a([t_1,t_2])\subset \U$, which exist because $\U$ is open. Then for any $q\in V_0, s\in (t_1,t_2)$ the function $\mathbf{E}_a(q,s)\coloneqq E(q,\mu_a(s))$ is well defined and smooth.
    
    We want to use first variation formula for $\mathbf{E}_a(q,s)$ ((E Reference)) to calculate $\left.\frac{\partial\mathbf{E}_a(q_0,s)}{\partial s}\right\rvert_{s=s_0}$ and $\left.\nabla_q\mathbf{E}_a(q,s_0)\right\rvert_{q=q_0}$.
    
    For the first part we define the variation $\x(t,s) = \gamma_{q_0,w(s)}(t), t\in [0,1]$ where $w(s):= w(q_0,\mu_a(s+s_0)), s\in [t_1-s_0,t_2-s_0]$. Note that $\x(t,0)=\gamma_{q_0,w_0}(t)$. We can then use the equation from proposition \ref{prop:Evariation} to get
    \begin{align*}
        \left.\frac{\partial\mathbf{E}_a(q_0,s)}{\partial s}\right\rvert_{s=s_0} = E'_{\x}(0) =  \left.g(V,\gamma_{q_0,w_0}')\right\rvert^1_0
    \end{align*}
    since $\gamma_{q_0,w_0}$ is a geodesic and $\x$ has no breaks. If we now further notice that $V(0)=0$ as $\x(0,s)=q_0$ for all $s\in[t_1,t_2]$ and $V(1) = \mu_a'(s_0) = \mu_a'(f_a(q_0))$ as $\x(1,s) = \mu_a(s+s_0)$ we can conclude 
    \begin{align*}
        \left.\frac{\partial\mathbf{E}_a(q_0,s)}{\partial s}\right\rvert_{s=s_0} &= g(V(1),\gamma'_{q_0,w_0}(1)) - g(V(0),\gamma'_{q_0,w_0}(0))\\
        &= g(\mu_a'(f_a(q_0)),\gamma'_{q_0,w_0}(1))
    \end{align*}
    
    For the second part we will introduce coordinates $\mathbf{q}=(q_0,\dots,q_n)$ around $q_0$. Then the gradient can be written as
    \[
        \left.\nabla_q\mathbf{E}_a(q,s_0)\right\rvert_{q=q_0} = g^{ij}\left.\frac{\partial\mathbf{E}_a(q,s_0)}{\partial q_i}\right\rvert_{q=q_0}\partial_j.
    \]
    To calculate $\left.\frac{\partial\mathbf{E}_a(q,s_0)}{\partial q_i}\right\rvert_{q=q_0}$ we now introduce variations $\x_i(t,s) = \gamma_{q(s),w(s)}(t)$ where $w(s):=w(q(s),\mu_a(s_0))$ and $q(s):=q^{-1}(q_0(q_0),\dots, q_i(q_0)+s, \dots q_n(q_0))$ is obtained by increasing the $i$-th coordinate by $s$. Note that these variations all have $\x_i(t,0) = \gamma_{q_0,w_0}(t)$, $\x_i(1,s) = \mu_a(s_0)$ thus $V_{\x_i}(1)=0$ and $V_{\x_i}(0) = \frac{\partial}{\partial s}\x_i(0,s)\rvert_{s=0} = \partial_i$.
    After again applying proposition \ref{prop:Evariation}
    \[
        \left.\frac{\partial\mathbf{E}_a(q,s_0)}{\partial q_i}\right\rvert_{q=q_0} = E'_{\x_i}(0) =  -g(V(0),\gamma'_{q_0,w_0}(0)) = -g(\partial_i,w_0).
    \]
    Combining this with coordinate representation of the gradient we get
    \begin{align*}
        \left.\nabla_q\mathbf{E}_a(q,s_0)\right\rvert_{q=q_0} &= g^{ij}\left.\frac{\partial\mathbf{E}_a(q,s_0)}{\partial q_i}\right\rvert_{q=q_0}\partial_j = -g^{ij}(g_{\alpha\beta}\partial_i^\alpha w_0^\beta)\partial_j\\
        &= -g^{ij}g_{i\beta}w_0^\beta\partial_j = -\delta^j_\beta w_0^\beta \partial_j\\
        &= -w_0^j\partial_j = -w_0.
    \end{align*}
    
    We thus managed to calculate what we wanted and can summarize as
    \begin{equation}\label{eq:dEsummary}
        \left.\frac{\partial\mathbf{E}_a(q_0,s)}{\partial s}\right\rvert_{s=s_0} = g(v,\mu'_a(f_a(q_0))), \quad \left.\nabla_q\mathbf{E}_a(q,s_0)\right\rvert_{q=q_0}=-w_0
    \end{equation}
    where $w_0=w(q_0,p_0)$ and $v=\gamma'_{q_0,w_0}(1)$. Since $\mu'_a(f_a(q_0))$ and $v$ are both future-pointing null vectors, which by lemma \ref{lem:transversality} must be transversal we have $\left.\frac{\partial\mathbf{E}_a(q_0,s)}{\partial s}\right\rvert_{s=s_0}=g(v,\mu_a'(f_a(q)))<0$.

    We can now use the implicit function theorem on $V_0\times [t_1,t_2]$ with equation $E_a(q,s)=0$ and single solution $E_a(q_0,s_0)=0$. This yields an open neighborhood $V_a\subset V_0$ and a smooth function $q\mapsto s_a(q)$ such that $E_a(q,s_a(q)) = 0$ for all $q \in V_a$. Now $E_a(q,s_a(q)) = E(q,\mu_a(s_a(q)))=0$, implies $\mu_a(s_a(q))\in \pq$. This together with $(q,s_a(q))\in \U$ implies that $\mu_a(s_a(q))\in \er(q)$ and thus $s_a(q) = f_a(q)$ on $V_a$. Hence we have $\left.\nabla f_a(q)\right\rvert_{q=q_0} = \left.\nabla s_a(q)\right\rvert_{q=q_0}$ and from equation \ref{eq:dEsummary} together with the implicit function theorem it follows that 
    \begin{equation}\label{eq:fgradient}
        \left.\nabla f_a(q)\right\rvert_{q=q_0}  = \frac{1}{c(q_0,a)}w_0, \quad 
        c(q_0,a) = \left.\frac{\partial\mathbf{E}_a(q_0,s)}{\partial s}\right\rvert_{s=s_0} < 0,
    \end{equation}
    where $p_0 = \mu_a(s_0)=\mc{E}_a(q_0), s_0 = f_a(q_0)$ and $w_0=w(q_0,p_0)$.
    
    Next we choose $p_0, \dots, p_n \in \er(q_0)$ and let $w_0,\dots,w_n\in L^K_{q_0}M$ such that $p_i = \gamma_{q_0,w_i}(1)$, i.e. $w_i=w(q_0,p_i)$. We assume that $w_0,\dots,w_n$ are linearly independent. Moreover let $a_j \in \sn$ such that $p_i\in \mu_{a_j}$ and $\overrightarrow{a}=(a_j)^n_{j=1}$.
    Finally we denote by $q\mapsto s_{a_j}(q)=f_{a_j}(q)$ the above constructed smooth functions which are defined on some neighborhoods $V_{a_j}\subset V$ of $q_0$.
    
    Let $V_{\overrightarrow{a}} = \bigcap_{j=1}^n V_{a_j}$ and consider the map
    \begin{align*}
        \mathbf{f}_{\overrightarrow{a}}:V_{\overrightarrow{a}}&\to \R^n\\
        q&\mapsto (f_{a_1}(q),\dots,f_{a_n}(q)).
    \end{align*}
    Because all of its components are smooth, $\mathbf{f}_{\overrightarrow{a}}$ itself is smooth as well. By equation \ref{eq:fgradient} each component has gradient $\left.\nabla f_{a_j}(q)\right\rvert_{q=q_0} = \frac{1}{c(q_0,a_j)}w_i$ with $c(q_0,a_j)\neq 0$. Since we assumed that $w_0,\dots,w_n$ be independent, $\mathbf{f}_{\overrightarrow{a}}$ is non-degenerate at $q_0$ and thus defines a smooth coordinate system in some neighborhood $V_1$  of $q_0$.
\end{proof}
The results from this subsection will form the main prerequesites for the reconstruction of the differential structure of $V$ because they allow us to understand $\mc{Z}$ in terms of $L^KV$ and to construct local coordinates from observation times.

\subsection{Observation Time Smoothness}
Now we show that the observation time function varies smoothly in the observer $a$ and the observerd point $p$ almost everywhere, and that its derivatives are well behaved. This culminates in proof that if $F_{q_n}$ converges suitably to $F_{q_0}$ we have $q_n\to q_0$ which will be crucial in the reconstruction of the topology of $V$.
\begin{definition}[Regular Observer]
    Let $q\in V$ we call $a\in \sn$ a \emph{regular observer} of $q$ if $\mc{E}_{a}(q)\in \er(q)$ and write 
    \[
        \mc{A}^{reg}(q) := \{ a\in \sn \mid \mc{E}_{a}(q)\in \er(q) \} \subset \sn
    \] for the set of regular observers. Note that because $\er(q)$ open and dense in $\ee(q)$, $\areg(q)$ is open and dense in $\sn$
\end{definition}

For the next proposition we again endow $M$ with the geodesic metric $d$ induced by $g^+$. This allows us to define open balls. To show that the observation time function $f$ is smooth we will again construct it as a function supplied by
the implicit function theorem in a very similar fashion to proposition \ref{prop:observationtimecoordinates}:
\begin{proposition}\label{prop:fsmooth}
    Let $q_0\in V$ and $a_0\in \areg(q_0)$ a regular observer of $q_0$. Then there exists a $\varepsilon>0$ such that $f:\overline{B_\varepsilon(q_0)}\times \overline{B_\varepsilon(a_0)} \to [-T_\sn,0]; \, (q,a)\mapsto f_a(q)$ is smooth.
\end{proposition}
\begin{proof}
    Let $p_0 \in \er(q_0)$ with $p_0 = \gamma_{q_0,w_0}(1)$ and $p_0 = \mu_{a_0}(t_0)$. Then we have $(q_0,p_0)\in \mc{Z}$ and by lemma \ref{lem:omegacoords} there exists a $\delta>0$ such that $X:\mc{W}_\delta(q_0,w_0)\to \mc{U}_\delta(q_0,p_0)$ is a diffeomorphism. Note that we can choose $\delta>0$ such that $\rho(q,w(q,p))>1$ for all $(q,p)\in \mc{U}_\delta(q_0,p_0) \cap L^+M$.

    Then 
    \begin{align*}
        Y:\mc{W}_\delta(q_0,w_0) \cap L^KM&\to M\times \sn \times [0,1]\\
        (q,w) &\mapsto (q,\Theta^{-1}(X(q,w)))
    \end{align*} 
    is a diffeomorphism onto its image $\mc{V}_\delta:=Y(\mc{W}_\delta(q_0,w_0))$  which is an open neighborhood of $(q_0,a_0,t_0)$ in $M\times \sn \times [0,1]$. There thus exists a $\delta > \lambda>0$ such that $\overline{B_\lambda(q_0)}\times\overline{B_\lambda(a_0)} \times\overline{B_\lambda(t_0)} \subset \mc{V}_\delta$.

    On this space we can then define the function $\mathbf{E}(q,a,s):=E(q,\Theta(a,s))$ with $E(q,p)$ as in the previous lemma. This function is well defined and smooth with $E(q_0,a_0,t_0)=0$ and $\left.\frac{\partial\mathbf{E}(q_0,a_0,t)}{\partial s}\right\rvert_{t=t_0} < 0$ by the same argument as in the previous proof. We can thus apply the implicit function theorem to get a $\varepsilon>0$ and a smooth function 
    \begin{align*}
        s:\overline{B_\varepsilon(q_0)}\times\overline{B_\varepsilon(a_0)} &\to \overline{B_\lambda(t_0)}\\
        (q,a)&\mapsto (t)
    \end{align*} with $s(q_0,a_0)=t_0$ and $\mathbf{E}(q,a,s(q,a))=0$.

    Let $(q,a) \in \overline{B_\varepsilon(q_0)}\times\overline{B_\varepsilon(a_0)}$ then 
    \[
        \mathbf{E}(q,a,s(q,a))=E(q,\Theta(a,s(q,a))) = E(q,\mu_a(s(q,a))) = 0
    \] 
    implies that $p=\mu_a(s(q,a))\in \mc{P}_K(q)$. Furthermore by definition we have $p\in \mc{U}_\delta(q_0,p_0)$ which implies $\rho(q,w(q,p))>1$ and thus $p=\mu_a(s(q,a))\in \er(q)$. Thus we have that $s(q,a)=f_a(q)$, making $f_a(q)$ a smooth function on $\overline{B_\varepsilon(q_0)}\times\overline{B_\varepsilon(a_0)}$ as desired.
\end{proof} 
Note that this result implies that $\mc{E}_a(q)\in \er(q)$ for all $(q,a)\in \overline{B_\varepsilon(q_0)}\times\overline{B_\varepsilon(a_0)}$ and $f:V\times \sn \to [0,1]$ smooth around all $(q,a)$ such that $q\in V, a\in \areg(q)$.

Because this implies that also the derivative is a smooth function we can apply lemma \ref{lem:unifconvoncompact} to get
\begin{proposition}\label{prop:dfunifconv}
    Let $q_n\to q_0\in V$ and $A\subset \sn$ open, such $\cl{A}\subset \areg(q_0)$. Then for all $\varepsilon>0$ there exists a $N\in \N$ such that for all $n \ge N$,  $\left.F_{q_n}\right.\rvert_\cl{A}$ is smooth and $\left\lVert dF_{q_n}\rvert_{a} - dF_{q_0}\rvert_{a}\right\rVert_{g_{\sn}}<\varepsilon$ for all $a\in \cl{A}$.
\end{proposition}
\begin{proof}
    By the previous proposition for all $a\in \cl{A}$ there exists a $\varepsilon_a>0$ such that $f:\overline{B_{\varepsilon_a}(q_0)}\times\overline{B_{\varepsilon_a}(a)}\to [0,1]$ is smooth. Then $\bigcup_{a\in \cl{A}} B_{\varepsilon_a}(a)$ is an open cover of the compact $\cl{A}\subset \sn$. Hence there exist $(a_1,\varepsilon_1),\dots (a_N,\varepsilon_N)$ such that $\bigcup_{j=1}^N B_{\varepsilon_j}(a_j) \supset \cl{A}$. We then let $\varepsilon_0 := \min_{j=1,\dots, N} \varepsilon_j$ and get $B_{\varepsilon_0}(q_0) = \bigcap_{j=1}^N B_{\varepsilon_j}(q_0)$ is open. 

    Let now $(q,a) \in B_{\varepsilon_0}(q_0)\times\cl{A}$ then there exists a $j\in {1,\dots N}$ such that $a\in B_{\varepsilon_j}(a_j)$ and we have $q\in B_{\varepsilon_0}(q_0)\subset B_{\varepsilon_j}(q_0)$. Thus by construction, $f$ is smooth at $(q,a)$. As the choice $(q,a)$ was arbitrary $f$ is smooth on $B_{\varepsilon_0}(q_0)\times\cl{A}$. Because $q_n\to q_0$ there exists a $N_1\in \N$ such that $n\ge N$ implies $q_n\in B_{\varepsilon_0}(q_0)$ and we have $F_{q_n}\rvert_{\cl{A}}$ is smooth.

    We now want to show that also the derivatives of $F_{q_n}$ wrt. $a\in \sn$ converge uniformly on $\cl{A}$:
    By the above argument 
    \begin{align*}
        f':\cl{B_{\frac{\varepsilon_0}{2}}(q_0)}\times \cl{A} &\to T^*\sn \\
        (q,a)&\mapsto dF_q\rvert_a
    \end{align*}
    is a continuous function on a compact metric spaces to a metric space (here we endow $T^*\sn$ with some metric compatible with its topology). 
    But now we can apply lemma \ref{lem:unifconvoncompact} to find that there exists a $N_2>N_1$ such that $n\ge N_2$ implies $\left\lVert dF_{q_n}\rvert_{a} - dF_{q_n}\rvert_{a}\right\rVert_{g_{\sn}}$ for all $a\in \cl{A}$.
\end{proof}

\begin{corollary}\label{cor:dfpwconv}
    Let $q_n\to q_0\in V$ and $a_0\in \areg(q_0)$. Then $dF_{q_n}\rvert_{a_0} \to dF_{q_0}\rvert_{a_0}$.
\end{corollary}



In the following we will for any $(q,p)\in \mc{Z}$ denote $v(q,p):=\gamma'_{q,w(q,p)}(1)$, i.e. the velocity vector of the unique geodesic from $q$ to $p$ at $p$. Sometimes we can only recover the direction of $v(q,p)$ and will denote $\cl{v}(q,p) = \frac{v(q,p)}{\lVert v(q,p) \rVert}$.

This corollary follows from lemma \ref{lem:dirreconstr} ((extended to show that it is homeo))
\begin{corollary}\label{cor:dfconvimplpliesvconv}
    Let $(q_n)_{n=1}^\infty, q_0\in V$ and $a_0\in \areg(q_0)$ such that $dF_{q_n}\rvert_{a_0} \to dF_{q_0}\rvert_{a_0}$. Then $\cl{v}_n:=\cl{v}(q_n,\mc{E}_{a_0}(q_n))\to \cl{v}_0:=\cl{v}(q_0,\mc{E}_{a_0}(q_0))$.
\end{corollary}

We can now prove that convergence in $F_q$ implies convergence in $q$ as desired:
\begin{proposition}\label{prop:dfconvimplqconv}
    Let $(q_n)_{n=1}^\infty, q_0\in V$ and $a_1,a_2\in \areg(q_0)$ such that $dF_{q_n}\rvert_{a_i} \to dF_{q_0}\rvert_{a_i}$. Then $q_n \to q_0$.
\end{proposition}
\begin{proof}
    We denote $p_n^i = \mc{E}_{a_i}(q_n)$ and $p_0^i = \mc{E}_{a_i}(q_0)$.
    By the previous corollary we have $\cl{v}^i_n:=\cl{v}(q_n,p_n^i)\to \cl{v}^i_0:=\cl{v}(q_0,p_0^i)$ for $i=1,2$ in $CTM=\{(p,v)\in TM \mid g^+(v,v)=1\}$.
    Note that by definition there exist $t^i_n, t^i_0 \in \R_+$ such that 
    \[
        q_0 = \gamma_{p^i_0,v^i_0}(-t^i_0) \quad \text{and} \quad q_n = \gamma_{p^i_n,v^i_n}(-t^i_n) \quad \text{for }i = 1,2.
    \]

    We now want to show that $t^i_n\to t^i_0$. By contradiction we assume that $t^i_n$ does not converge to $t^i_0$. By a similar argument to the one employed in the proof of lemma \ref{lem:omegacoords} we find that $t^i_n$ must be bounded. $t^i_n$ has thus a convergent subsequence $t^i_j\to t^i_\times \neq t^i_0$ for $i=1,2$. Now we let $d$ be a metric on $M$ compatible with the topology and note that because $(q,w,t)\mapsto \gamma_{q,w}(t)$ is continuous we have
    \[
        0 = \lim_{n\to \infty} d(\gamma_{p^1_j,v^1_j}(-t^1_j),\gamma_{p^2_j,v^2_j}(-t^2_j)) = d(\gamma_{p^1_0,v^1_0}(-t^1_\times),\gamma_{p^2_0,v^2_0}(-t^2_\times)),
    \]i.e. $q_\times:=\gamma_{p^i_0,v^i_0}(-t^i_\times)$ for $i=1,2$. But this is a contradiction because $p^1_0$ and $p^2_0$ are in $\er(q_0)$ and thus cannot be cut points of $q_0$.
\end{proof}

And lastly we show that $F$ also has bounded derivatives.
\begin{proposition}\label{prop:dfbounded}
    Let $q_0\in V$, $\varepsilon>0$ such that $\cl{B_\varepsilon(q_0)}\subset V$ and define 
    \[
        D_\varepsilon:=\{(q,a)\in V\times \sn \mid q\in \cl{B_\varepsilon(q_0)}, a\in \areg(q)\}.
    \]
    Then 
    \begin{align*}
        f':D_\varepsilon &\to T^*\sn \\
        (q,a)&\mapsto dF_q\rvert_a
    \end{align*}
    is bounded.
\end{proposition}
\begin{proof}
    ((Make more rigorous / shorter / more understandable. The main idea here is that $dF$ must be bounded because at the points where it is not defined i.e. points where $\mc{E}_a(q)\notin \er(q)$, $dF$ does not go to infinity but has multiple conflicting values (see prop \ref{prop:unionmanif}), we try to show that by expressing $dF$ as in terms of $dh$ and $dY$ which are well defined at the points where $dF$ fails to be so))

    We begin by defining the map
    \begin{align*}
        Y:L^K\cl{B_\varepsilon(q_0)}&\to \cl{B_\varepsilon(q_0)}\times \sn \\
        (q,w)&\mapsto (q,\pi_a(\Theta^{-1}(X(q,w))))
    \end{align*} mapping a null direction to the observer which sees the resulting geodesic. This map is smooth, surjective and locally diffeomorphic by lemma \ref{lem:omegacoords}.

    We also define the map
    \begin{align*}
        h:L^K\cl{B_\varepsilon(q_0)}&\to [-T_{sn},0] \\
        (q,w)&\mapsto \pi_t(\Theta^{-1}(X(q,w)))
    \end{align*} mapping a null direction to its observation time. This map is also smooth.

    We then define 
    \begin{align*}
        P:=& \{(q,w)\in L^K\cl{B_\varepsilon(q_0)} \mid \rho(q,w)\ge 1\}\\
        =& \{(q,w)\in L^K\cl{B_\varepsilon(q_0)} \mid \exp_q(w)\in \ee(q)\}
    \end{align*} which is closed by the lower semicontinuity of $\rho$ and thus compact.
    Now the following diagramm commutes:
    \[\begin{tikzcd}
        {P\subset L^K\cl{B_\varepsilon(q_0)}} & {[0,1]} \\
        {\cl{B_\varepsilon(q_0)}\times S^{n-1}}
        \arrow["Y", from=1-1, to=2-1]
        \arrow["h", from=1-1, to=1-2]
        \arrow["f"', from=2-1, to=1-2]
    \end{tikzcd}\]

    Let now $g^+$ be the Riemannian metric induced on $M$ by the splitting and $\widehat{g}^+$ the corresponding Sasaki metric induced on $TM$. Let also $g^\times:=g^+ \oplus g_\sn$ be the product metric on $M\times \sn$ with $g_\sn$ the standard Riemannian metric on $\sn$.
    Because $h:P\to [-T_\sn,0]$ is smooth, $dh:TP\to \R$ is smooth as well. Furthermore because $P$ is compact and $dh_{(q,w)}$ is linear for all $(q,w)\in P$ we get that $dh$ is bounded on $TP$, i.e. 
    there exists a $c_1>0$ such that for all $(q,w)\in P$ and $(q',w')\in T_{(q,w)}P$ we have
    \[
        \lvert dh_{(q,w)}(q',w') \rvert \leq c_1\lVert (q',w') \rVert_{\widehat{g}^+}.
    \]

    Similarly because $Y$ is smooth as well as locally diffeomorphic its derivative is bounded from below, i.e. there exists a $c_2>0$ such that for all $(q,w)\in P$ and $(q',w')\in T_{(q,w)}P$ we have
    \[
        \lVert dY_{(q,w)}(q',w') \rVert_{g^\times} \geq c_2\lVert (q',w') \rVert_{\widehat{g}^+}.
    \]

    We now define 
    \begin{align*}
        P^{reg}:=& \{(q,w)\in L^K\cl{B_\varepsilon(q_0)} \mid \rho(q,w) > 1\}\\
        =& \{(q,w)\in L^K\cl{B_\varepsilon(q_0)} \mid \exp_q(w)\in \er(q)\} \text{ and }
    \end{align*} and the following again diagramm commutes:

    \[\begin{tikzcd}
        {P^{reg}\subset P} & {[0,1]} \\
        {D_\varepsilon\subset \cl{B_\varepsilon(q_0)}\times \sn}
        \arrow["Y", from=1-1, to=2-1]
        \arrow["h", from=1-1, to=1-2]
        \arrow["f"', from=2-1, to=1-2]
    \end{tikzcd}\]   

    Additionally in this case $Y$ is a diffeomorphism and $f$ is smooth. Let $(q,a)\in D_\varepsilon$ and $(q',a')\in T_{(q,a)}D_\varepsilon$, then there exists a unique $(q,w)=Y^{-1}(q,a)\in P^{reg}$ and $(q',w')=dY^{-1}(q',a')\in T_{(q,w)}P^{reg}$ and we have 
    \begin{align*}
        \lvert df_{(q,a)}(q',a') \rvert = \lvert dh_{(q,w)}\circ dY^{-1}_{(q,a)}(q',a')\rvert\leq c_1 \lVert dY^{-1}_{(q,a)}(q',a')\rVert_{\widehat{g}^+} \\
        = c_1\lVert (q',w') \rVert_{\widehat{g}^+} \leq c_1c_2\lVert dY_{q,w}(q',w') \rVert_{g^\times} = c_1c_2\lVert(q',a')\rVert_{g^\times}.
    \end{align*}
    This implies that $df$ and thus also $dF$ is bounded on $D_\varepsilon$ as desired.
\end{proof}