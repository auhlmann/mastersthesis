\chapter{Boundary Reconstruction}\label{chap:boundary}

\section{Setting}

In this section we will examine how we can extend our reconstruction result to the case where the source set $V$ is no longer contained within the interior of $J(p^-,p^+)$ but is now allowed to extend up to the boundary $K \setminus \{p^+\}$. 

This is complicated by the fact that as $q\in J(p^-,p^+)$ approaches the observation set $K$, the light observation sets $\mc{P}_K(q)$ get increasingly warped and are degenerate if $q\in K$. 

Analogous to the interior reconstruction case we will again prove the modified version outlined in remark \ref{rmk:data}, and let $(M,g)$ be a globally hyperbolic Lorentzian manifold, with $p^+,p^-\in M,V\subset \jp$ suitable such that $V\in \jp$ is relatively open.

\section{Preliminaries}
To extend the reconstruction up to the edge of $\jp$ we will essentially split up the reconstruction into two steps: We will split up $V$ into $V\cap (\jp \setminus K)$ and $V\cap D$ where $D$ is the set of all points such that $F_q$ has a unique minimum. On $V\cap (\jp \setminus K)$ we can use the reconstruction result from the previous chapter and on $V\cap D$ we will use the fact that the observation time functions have unique minima to smooth them on the boundary $K$ and allow a reconstruction.

\subsection{Definitions}
We first need to introduce some new concepts:
\begin{definition}[Unique minimum domain]\label{def:uniquemindomain}
    We define the \emph{unique minimum domain} $D\subset \jp$ to be 
    \begin{equation}
        D\coloneqq \{q\in \interior{\jp} \cup K \mid F_q\text{ has a unique nondegenerate minimum}\}.
    \end{equation}
    By \emph{nondegenerate} we mean that the \emph{hessian} $\mc{H}_{F_q}$ at the unique minimum must be positive definite.

    We will often describe this minimum with 
    \[
        (a_q,t_q)=(\argmin_{a\in \sn} F_q, \min_{a\in \sn} F_q).
    \]
\end{definition}
We will see that $D$ contains an open neighborhood of $K \setminus \{p^+\}$ allowing us to reconstruct boundary points. As mentioned in remark \ref{rmk:ReconstrPastBoundary} the reconstruction from the past chapter can be applied to the whole $\jp\setminus K$; moreover because $D$ is an open neighborhood of $K$ in $\jp$, this will allow us to reconstruct the set $V$ in all of $\jp\setminus \{p^+\}$.

\begin{definition}[Constant observation time domain]\label{def:constobstime} For some $t_0\in (T_\sn,0)$ we define the \emph{constant observation time domain} as 
\begin{equation}
    T_{t_0} = \{p\in K \mid p=\mu_a(t_0), a\in \sn\}
\end{equation} 
By definition $T_{t_0}$ is an $(n-1)$-dimensional spacelike submanifold of $K$ (away from its boundary).
Thus for every $a\in \sn$ such that $-T_a<t_0$ we can use lemma \ref{lem:dirreconstr} to find the unique future-pointing outward null ray $\R_+\nu_{a,t_0}\in L^+_{\mu_a(t_0)}M$ such that $T_{\mu_a(t_0)}T_{t_0} = \nu_{a,t_0}^\perp \cap T_{\mu_a(t_0)}K$.

Note that for every $q\in \interior{\jp}$ and $p=\mu_a(t)\in \mc{P}_K(q)$ we have $t>-T_a$ which implies that $p$ is in the relative interior of $T_{t}$, i.e. there exists an open neighborhood $p\in U \subset M$ such that $T_t\cap U$ is a submanifold.
\end{definition}

The next lemma is often useful because is shows that for $F_q$ with $q\in \interior{\jp}$ local minima must be regular points and the unique null geodesic from $q$ to the minimum must have a specific direction at the minimum related to the constant observation time domain:
\begin{lemma}\label{lem:amin}
    Let $q\in \interior{\jp}$ with $(a_q,t_q)$ a local minimum of $F_q$ and $p_q\coloneqq \mu_{a_q}(t_q)$. Then we have $p_q\in \er(q)$ and $v(q,p_q)\in \R_+\nu_{a_q,t_q}$, i.e. if $w_q\in L^K_qM$ is the unique null vector such that $\gamma_{q,w_q}(1)=p$ we have $\gamma'_{q,w_q}(1)\in \R_+\nu_{a_q,t_q}$.
\end{lemma}
\begin{proof}
    Note that we have $t_q = f_{a_q}(q)$ and thus 
    \[
        p_q =\mu_{a_q}(t_q) = \mu_{a_q}(f_{a_q}(q)) = \mc{E}_{a_q}(q)\in \pq,
    \] proving that there exists a $w_q\in L^K_qM$ such that $p_q = \gamma_{q,w_q}(1)$. 

    Now we need to show that indeed $p_q\in \er(q)$.
    We recall that by proposition \ref{prop:unionmanif} there exists an open neighborhood $p_q\in U\subset \mc{P}_K(q)$ such that $\mc{P}_K(q)\cap U$ is the union of $N$ pairwise transversal, spacelike, dimension $n-1$ submanifolds $\mc{V}_i$. Because $t_q$ is the minimum of $F_q$ we must have $T_{p_q}{\mc{U}_i} = T_{p_q}{T_{t_q}}$ for all $i=1,\dots N$. But because the manifolds must be pairwise transversal, we must have $N=1$, implying that $p_q$ is a regular point of $\mc{P}_K(q)$. Together with $p_q\in \ee(q)$ this yields $p_q \in \er(q)$.

    Finally $\gamma'_{q,w_q}(1)=\R_+\nu_{a_q,t_q}$ follows from the fact that $T_{p_q}{\mc{V}_1} = T_{p_q}{T_{t_q}}$.
\end{proof}

\subsection{Observation time Functions at the boundary}
In this subsection we will study how the observation time functions behave for source points $q\in K$ inside the observation set as well as for sequences $q_n \in V \to q_0\in K$:

We can explicitly characterize observation time functions at the boundary.
\begin{lemma}\label{lem:boundaryF}
    For $q_0=\mu_{a_0}(t_0)\in K$ we have 
    \begin{equation*}
        F_{q_0}(a) = 
        \begin{cases*}
            t_0 & if $a=a_0$ \\
            0 & otherwise
        \end{cases*}
    \end{equation*}
\end{lemma}
\begin{proof}
    We begin with the case $a=a_0$; then $F_{q_0}(a_0)=t_0$ follows immediately from the definition of $f_{a_0}(q_0)$. Note that this also covers the case where $q_0=p^+$. For the case where $a\neq a_0$ and $q_0\neq p^+$ we suppose that $F_{q_0}(a)=f_a(q_0)<0$ by contradiction. Then we have $\tau(q_0,\mc{E}_a(q_0))=0$ which implies that there exists a null geodesic $\gamma$ with $\gamma(0)=q_0$ and $p\coloneqq \mc{E}_a(q_0)=\gamma(1)$. If $\gamma'(1)=\mu'_a(f_a(q_n))$ we would have $q_0\in \mu_a([0,1)) \cap \mu_{a_0}([0,1))$ which is a contradiction to lemma \ref{lem:Kcharact}. We must thus have $\gamma'(1)\neq\mu'_a(f_a(q_n))$ but this means there exists a broken null geodesic from $q_0$ to $p^+$ which is also a contradiction because $q_0\in K$ by assumption and $K\cap I^-(p^+)=\emptyset$ by lemma \ref{lem:Kcharact}.
\end{proof}
\begin{remark}
    The previous lemma shows that the observation time functions $F_q$ for $q\in K$ lose many nice properties they had when $q\notin K$. In particular, if $q\in K$, then $F_q$ is not continuous at $a_0$. Furthermore, let $q_n=\Theta(a_n,t_0)\to q_0=\Theta(a_0,t_0)$ with $a_n \notin a_0$, then $F_{q_0}(a_0)=t_0$ but $F_{q_n}(a_0)=0$ for all $n\in \N$, implying that $F_{q_n}$ fails to even converge pointwise to $F_{q_0}$. Later on we will fix some of these issues by multiplying $F_q$ with a smoothing bump function.
\end{remark}

This lemma shows that even though obervation time functions do not retain many of their nice properties at the boundary they at least behave somewhat regularly away from the minimum.
\begin{lemma}\label{lem:convto1}
    Let $q_n\in V\to q_0=\mu_{a_0}(t_0)\in K\setminus{p^+}$ and $A\subset \sn$ an open neighborhood of $a_0$ then we have $F_{q_n}\rvert_{\sn\setminus A} \to 0$ uniformly.
\end{lemma}
\begin{proof}
    Because any $q_n$ can either lie in the boundary $K$ or in the interior $\interior{\jp}$ we can instead look at the subsequences $(q_n)_{n=1}^\infty \cap K$, $(q_n)_{n=1}^\infty \cap \interior{\jp}$. If we can prove that both subsequences converge to $q_0$ then we have also proven that $q_n$ itself converges to $q_0$. 

    Hence let now $q_n \to q_0\in K\setminus p^+$ with $q_n=\mu_{a_n}(t_n) \in K\setminus p^+$. We then have $a_n\to a_0$ and thus $a_n \in A$ for all $n\ge N$ for some $N\in \N$. But by the previous lemma this implies that $F_{q_n}\rvert_{\sn\setminus A} = F_{q_0}\rvert_{\sn\setminus A} = 0$ and we are done.

    For the other part $q_n \to q_0\in K\setminus p^+$ with $q_n \in \interior{\jp}$.
    We suppose by contradiction that there exists a $\varepsilon>0$ such that for all $N\in \N$ there exists a $n\ge N$ and an $a\in \sn\setminus A$ such that $f_a(q_n)<-\varepsilon$. We can thus construct a sequence $(a_k, q_k)$ such that $f_{a_k}(q_k)<-\varepsilon$ for all $k\in \N$. Because $f$ is bounded and $\sn$ compact there exists a convergent subsequence $(a_j,q_j)$ such that $t_j\coloneqq f_{a_j}(q_j)\to t'\leq -\varepsilon$, $a_j \to a'\in \sn\setminus A$ and $q_j\to q_0$. Now we have $\mu_{a_j}(t_j) = \Theta(a_j,t_j) \to \Theta(a',t')=\mu_{a'}(t')$ and 
    \[
        0 = \lim_{j\to \infty}\tau(q_j,\mc{E}_{a_j}(q_j)) = \lim_{j\to \infty}\tau(q_j,\mu_{a_j}(t_j)) = \tau(q_0,\mu_{a'}(t')).
    \]
    Furthermore because $\mu_{a_j}(t_j)=\mc{E}_{a_j}(q_j)$ we have $\mu_{a_j}(t_j)\in J^+(q_j)$. By lemma \ref{lem:Jclosed} this implies $\mu_{a'}(t')\in J^+(q_0)$. But this together with $\tau(q_0,\mu_{a'}(t'))=0$ implies that $\mu_{a'}(t')=\mc{E}_{a'}(q_0)$ and $f_{a'}(q_0)=t'<-\varepsilon$. Finally because $a_0\in A$ and $a'\in \sn\setminus A$ we have $a'\neq a_0$ and $f_{a'}(q_0) <  0$, a contradiction to the previous lemma.
\end{proof}

\begin{lemma}
    Let $q_n\in V\to q_0=\mu_{a_0}(t_0)\in K\setminus p^+$. Then 
    \[
        \liminf_{n\to \infty} \min_{a \in \sn} F_{q_n}(a) \ge t_0.
    \]
\end{lemma}
\begin{proof}
    Suppose by contradiction that there exists a convergent subsequence $q_k$ of $q_n$ such that $\min_{a \in \sn} F_{q_k}(a)\to t'<t_0$. There thus exists a sequence of $a_k$ such that $F_{q_k}(a_k)\to t'<t_0$. Taking subsequences again we get $a_j\to a'$ and $t_j\coloneqq F_{q_j}(a_j)\to t'<t_0$. Then we have 
    \[
        J^+(q_j)\ni \mu_{a_j}(F_{q_j}(a_j)) \to \mu_{a'}(t') \in J^+(q_0)
    \] by continuity of $\mu$ and lemma \ref{lem:Jclosed}. We also have 
    \[
        0 = \lim_{n\to \infty}\tau(q_j,\mu_{a_j}(F_{q_j}(a_j))) = \tau(q_0,\mu_{a'}(t'))
    \] which implies $\mu_{a'}(t')=\mc{E}_{a'}(q_0)$ and $F_{q_0}(a')=t'<t_0$. This is a contradiction because $F_{q_0}\ge t_0$ by lemma \ref{lem:boundaryF}.
\end{proof}

The following proposition is important because it shows that $D$ is an open neighborhood of the boundary, which means a reconstruction on $D$ is also a reconstruction of the boundary. The key idea here is that as $q_n \to q_0=\mu_{a_0}(t_0)\in K \setminus \{p^+\}$ we can use lemma \ref{lem:convto1} to control the convergence away from the minimum $a_0$ and to introduce local coordinates around $a_0\in \sn$ to study the behavior close to $a_0$.
\begin{proposition}\label{prop:boundarymin}
    Let $q_n\in V\to q_0=\mu_{a_0}(t_0)\in K\setminus p^+$ then there exists a $N\in \N$ such that for all $n\ge N$, $F_{q_n}$ has a unique nondegenerate minimum $(a_n,t_n)$ and $(a_n,t_n)\to (a_0,t_0)$.
\end{proposition}
\begin{proof}
    As in a previous proof we can again separately prove the statement for the cases $q_n\in K$ for all $n\in \N$ and $q_n \notin K$ for all $n\in \N$. If $q_n \in K$ the statement follows immediately. We can thus from now on assume $q_n \notin K$.

    First of all we let $O\subset M$ be a open convex neighborhood of $q_0$. Because $q_n \to q_0$ there exists a $N_1$ such that $n\ge N$ implies $q_n \in O$.

    We now again take a Riemannian metric $g^+$ compatible with $(M,g)$. For $a\in \sn, t\in [-T_a,0]$ let $\nu_{a,t}\in CL^+_{\mu_a(t)}M$ be the unique outward future pointing null vector orthogonal to $T_t$ at $a$ with $\lVert \nu_{a,t} \rVert_{g^+}=1$, as in definition \ref{def:constobstime}. We define the map 
    \begin{align*}
        X:\R_+\times \mc{S} &\to M \\
        (c,a,t)&\mapsto \exp_{\Theta(a,t)}(-c\nu_{a,t})
    \end{align*} which is smooth because $\nu_{a,t}$ varies smoothly in $(a,t)$. We have $X(0,a_0,t_0)=q_0$ and $X$ has invertible differential at $(0,a_0,t_0)$. Therefore there exists an $\varepsilon>0$ such that $B_\varepsilon(a_0) \times B_\varepsilon(t_0)\subset \mc{S}$ and $X:(B_\varepsilon(0)\cap \R_+) \times B_\varepsilon(a_0) \times B_\varepsilon(t_0) \to O_\varepsilon$ is a diffeomorphism. Because $-\nu_{a,t}$ is inward pointing we have $O_\varepsilon\subset \jp$ for $\varepsilon>0$ small enough. In this case, by the invariance of domain theorem, $O_\varepsilon\subset \jp$ is a relatively open neighborhood of $q_0$. After further reducing $\varepsilon$, we can achieve that no two rays intersect in $O_\varepsilon$, i.e. 
    \begin{align*}
        \gamma_{\nu_{a_1,t_1}} \cap \gamma_{\nu_{a_2,t_2}} \cap O_\varepsilon=\emptyset
    \end{align*}
    for all $a_1,a_2\in B_\varepsilon(a_0), t_1,t_2 \in B_\varepsilon(t_0)$ with $(a_1,t_1)\neq (a_2,t_2)$.
    This possible because around $\Theta(a_0,t_0)$, $K$ is a smooth submanifold.
    Finally we can reduce $\varepsilon>0$ to get $O_\varepsilon\subset O$.
    
    Because $O_\varepsilon$ is open there exists an $N_2\in \N$ such that $n\ge N_2$ implies $q_n\in O_\varepsilon\subset O$.
    In this case we can write $q_n = X(c_n,a_n,t_n)$. We want to show that there exists an $N_3\ge N_2$ such that for all $n\ge N_3$, $F_{q_n}$ must have a global minimum in $B_\varepsilon(a_0)$. First of all, because $q_n \in \interior{\jp}$, $F_{q_n}$ is a continuous function on a compact set. There must thus exist at least one $a'_n\in \sn$ such that $t'_n \coloneqq  F_{q_n}(a'_n) \leq F_{q_n}(a)$ for all $a\in \sn$. Note that because $t'_n$ is a minimum, the same argument as in lemma \ref{lem:amin} yields that $\mu_{a'_n}(t_n')\in \er(q_n)$ and $v(q_n,\mu_{a'_n}(t_n')) \in \R_+\nu_{a_n',t_n'}$.
    
    Next we want to show that if $n$ is big enough, any such $a_n'$ must lie in $B_\varepsilon(a_0)$. 
    To that end we first note that  $\mu_{a_n}(t_n)\in \er(q_n)\subset \mc{P}_K(q_n)$ because $q_n$ and $\mu_{a_n}(t_n)$ both lie in the convex neighborhood $O$. 
    This implies $F_{q_n}(a_n)=t_n$. 
    Because $t_n\in B_\varepsilon(t_0)$ we know that $\min_{a\in \sn}F_{q_n}(a) = t'_n\leq t_n < t_0+\varepsilon < 0$. 
    By lemma \ref{lem:convto1} we can then find an $N_3\in \N$ such that $n\ge N_3$ implies $F_{q_n}(a)>t_0+\varepsilon$ for all $a\in \sn \setminus B_\varepsilon(a_0)$. But this means that $F_{q_n}$ cannot have a minimum outside of $B_\varepsilon(a_0)$.

    Next we want to show that $a_n'=a_n$ and $t_n'=t_n$, implying $F_{q_n}$ has a unique minimum.
    We have $a_n'\in B_\varepsilon(a_0)$ for $n\ge N_3$. By the previous lemma there exists a $N_4$ such that $\min_{a\in \sn} F_{q_n}(a)=t'_n> t_0-\varepsilon$ for all $n\ge N_4$. Combining this with $t_n'\leq t_n < t_0+\varepsilon$ we have $t_n'\in B_\varepsilon(t_0)$. Now $\gamma_{\nu_{a_n,t_n}}$ and $\gamma_{\nu_{a_n',t_n'}}$ both contain $q_n\in O_\varepsilon$, and have $a_n,a'_n\in B_\varepsilon(a_0)$ and $t_n,t'_n\in B_\varepsilon(t_0)$; this is a contradiction if $a_n\neq a_n'$ or $t_n'\neq t_n$. 

    Now we sketch the proof that the minimum are nondegenerate 
    \footnote{This is a rough sketch merely meant to outline a possible proof. In time we hope that we can make this argument more rigorous.}
    i.e. there exists an $N_5\in \N$ such that for all $n\ge N_5$ the hessian $\mc{H}_{F_{q_n}}\rvert_{a_{q_n}}$ is positive definite. We define the energy functional $E_(q,a,s)$ as in proposition \ref{prop:fsmooth} and choose a small enough neighborhood of $q_0$, $a_0$ and $t_0$ such that $F_q(a)$ coincides with the map $(q,a)\mapsto s(q,a)$ such that $E(q,a,s(q,a))=0$ supplied by the implicit function. Then for any $\xi\in T_{\mu_{a_n}(t_n)}$ we have 
    \begin{align*}
        \mc{H}_{F_{q_n}}(\xi,\xi) > \frac{c}{g(v(q_n,\mu_{a_n}(t_n)),\mu_{a_n}'(f_{a_n}(q_n)))}
    \end{align*}
    where $c>0$ is a positive constant by the implicit function theorem together with the second variation formula for $E$ (see \cite{oneill} proposition 10.39). Because $q_n$ approaches $K$ we have $v(q_n,\mu_{a_n}(t_n))\to 0$ and we can see that the expression must go to positive infinity thus ensuring that the hessian is positive definite. 

    Finally $(a_n,t_n)\to (a_0,t_0)$ follows from the fact that $X$ is a diffeomorphism and thus has a continuous inverse.
\end{proof}

By lemma \ref{lem:firstcount} we immediately get:
\begin{corollary}
    There exists an open neighborhood $K\setminus p^+\subset O\subset \jp$ such that $O\subset D$, i.e. for every $q\in O$, $F_q$ has a unique minimum.
\end{corollary}

We can now show that $D$ is an open subset of $\jp$:
\begin{proposition}\label{prop:globalminconv}
    Let $q_0\in D$ and $q_n\to q_0$ in $V$. Then there exists an $N\in \N$ such that $n\ge N$ implies that $F_{q_n}$ has a unique minimum $(a_n,t_n)$ and $(a_n,t_n)\to (a_0,t_0)$ where $(a_0,t_0)$ is the unique minimum of $F_{q_0}$.
\end{proposition}
\begin{proof}
    We may assume $q_0,q_n \in \interior{\jp}$ because the case $q_0\in K\setminus\{p^+\}$ is covered by the previous proposition and $q_0\in \interior{\jp}$ implies $q_n\in \interior{\jp}$ eventually because the interior is open.

    First we write $t_0=F_{q_0}(a_0)<F_{q_0}(a'), a_0\neq a'\in \sn$ for the unique minimum of $F_{q_0}$. Let $p_0 = \mc{E}_{a_0}(q_0)$, then by lemma \ref{lem:amin}, $p_0\in \er(q_0)$ and $a_0\in \areg(q_0)$. By prop \ref{prop:fsmooth} there exists a $\varepsilon>0$ such that $f:\cl{B_\varepsilon(q_0)}\times\cl{B_\varepsilon(a_0)}\to [-T_\sn,0]$ is smooth. In particular $F_{q_0}=f(q_0,\cdot\;)$ is smooth on $\cl{B_\varepsilon(a_0)}\subset \areg(q_0)$. Furthermore because $a_0$ is a local minimum of the smooth $F_{q_n}$ we must have $dF_{q_0}\rvert_{a_0}=0$ and its hessian $\mc{H}_{F_{q_0}}(a_0)$ must be positive definite by definition of $D$. Because positive definiteness of the hessian is equivalent to it having only positive eigenvalues, there exists $\delta>0$ such that every eigenvalue of $\mc{H}_{F_{q_0}}(a)$ is bigger than $c_0>0$ for all $a\in \cl{B_\delta(a_0)}\subset \cl{B_\varepsilon(a_0)}$. Hence $\mc{H}_{F_{q_0}}$ is positive definite and $F_{q_0}$ is convex on all of $\cl{B_\delta(a_0)}$.

    By an analogous argument to the one employed in the proof of \ref{prop:dfunifconv} we can prove that $F_{q_n}\rvert_{\cl{B_\delta(a_0)}}$ is smooth for $n$ big enough and $\mc{H}_{F_{q_n}}\to \mc{H}_{F_{q_0}}$ uniformly on $\cl{B_\delta(a_0)}$. Because every eigenvalue of $\mc{H}_{F_{q_0}}(a)$ is bigger than $c_0>0$ for all $a\in \cl{B_\delta(a_0)}$, there must exist a $N_1\ge \in \N$ such that $F_{q_n}\rvert_{\cl{B_\delta(a_0)}}$ is smooth and $\mc{H}_{F_{q_n}}$ has only positive eigenvalues on $\cl{B_\delta(a_0)}$ for all $n \ge N_1$. Therefore $F_{q_n}$ is convex on $\cl{B_\delta(a_0)}$ as well.
    
    Next we prove that $F_{q_n}$ must have all its minima in $B_{\frac{\delta}{2}}(a_0)$. We first note that because $a_0$ is the unique minimum of $F_{q_0}$ we have $F_{q_0}(a)-F_{q_0}(a_0)>0$ for all $a\in \sn\setminus B_{\frac{\delta}{2}}(a_0)$. Because $F_{q_0}$ is continuous and $\sn\setminus B_{\frac{\delta}{2}}(a_0)$ compact there exists a $c_1>0$ such that $F_{q_0}(a)> F_{q_0}(a_0) + c_1$ for all $a\in \sn\setminus B_{\frac{\delta}{2}}(a_0)$. By proposition \ref{prop:funif}, $F_{q_n}\to F_{q_0}$ uniformly. Hence there exists a $N_2\ge N_1$ such that $F_{q_n}(a_0)\leq F_{q_0}(a_0)+\frac{c_1}{2}$. Thus we have $\min_{a\in \sn}F_{q_n}(a) \leq F_{q_n}(a_0) \leq F_{q_0}(a_0)+\frac{c_1}{2}$ for all $n\ge N_3$. But again by uniform convergence there exists a $N_3\ge N_2$ such that $F_{q_n}(a) > F_{q_0}(a_0)+\frac{c_1}{2}$ for all $a\in \sn\setminus B_{\frac{\delta}{2}}(a_0)$. Hence $F_{q_n}$ has no global minima in $\sn\setminus B_{\frac{\delta}{2}}(a_0)$ for all $n\ge N_3$.

    But because $F_{q_n}$ is a continuous function on a compact space there must exist a minimum $a_n\in \sn$ such that $t_n\coloneqq F_{q_n}(a_n)\leq F_{q_n}(a')$ for all $a'\in \sn$. As we just saw we must have $a_n \in \sn\setminus B_{\frac{\delta}{2}}(a_0)$. But we also proved that $F_{q_n}$ is convex on $B_\delta(a_0)$ which means that $a_0$ must be the unique minimum of $F_{q_n}$ on $B_\delta(a_0)$. Because $F_{q_n}$ cannot have another minimum outside of $B_{\frac{\delta}{2}}(a_0)$, $a_0$ must be the unique minimum of $F_{q_n}$ and thus $q_n \in D$.

    Finally we prove that $a_n\to a_0$. We suppose by contradiction that $a_n$ does not converge to $a_0$. Because $\sn$ is compact there exists a convergent subsequence $q_j$ such that $a_j \to a' \neq a_0$ and $q_j \in D$ for all $j\in \N$. Because $q_0,q_j\in \interior{\jp}$, we have $F_{q_j}(a_j) \to F_{q_0}(a')$. Furthermore we have $F_{q_j}(a_j)= \min_{a\in \sn}F_{q_j} \to \min_{a\in \sn}F_{q_0}$ because $F_{q_j}\to F_{q_0}$ uniformly. But this implies $F_{q_0}(a') = \min_{a\in \sn}F_{q_0}=F_{q_0}(a_0)$, a contradiction because $F_{q_0}$ was assumed to have a unique minimum. Note that because $f$ is continuous on $\interior{\jp}\times \sn$ this implies $t_n=f(q_n,a_n)\to t_0 = f(q_0,a_0)$ as well.
\end{proof}
Note that by lemma \ref{lem:firstcount} this shows that $D$ is open.

\section{Smoothed Observation Time Functions}
In this section we will define \enquote{smoothed} observation time functions which will be regular enough at the boundary $K$ to carry out a similar reconstruction as in the previous chapter.

To that end we define:
\begin{definition}[Observation Bump Function]\label{def:obsbumpfn}
    For $a_0\in \sn$ want to define the \emph{observation bump function} $\chi_{a_0}:\sn\to [0,1]$ to be a smooth function which varies smoothly in $a_0$, has $\chi_{a_0}(a')=0$ if and only if $a'=a_0$, is symmetric around $a_0$ and there exist $\varepsilon_1>0$ such that $\chi_{a_0}(a')=1$ for all $a'\in \sn\setminus B_{\varepsilon_1}(a_0)$ and $\varepsilon_1 > \varepsilon_2 > 0$ such that $\max_{a'\in B_{\varepsilon}(a_0)} \chi_{a_0}(a')<\frac{\varepsilon}{T_\sn}$ for all $\varepsilon<\varepsilon_2$.

    To that end, for a fixed $a_0\in \sn$ we introduce local radial coordinates $a\in B_1(a_0)\mapsto (r(a),\omega(a))\in [0,1]\times S^{n-2}$ such that $r(a_0)=0$. For $a \in \sn$ we then define 
    \begin{equation*}
        \chi_{a_0}(a) \coloneqq  
        \begin{cases*}
            1-\exp(-\frac{r(a)^2}{1-r(a)^2}) & if $a\in B_1(a_0)$ \\
            1 & otherwise
        \end{cases*}
    \end{equation*}
    Because $\chi_{a_0}(a)$ only depends on $r(a)$ it is symmetric, by construction is smooth and also varies smoothly in $a_0$. We can see that $\varepsilon_1 = 1$, and because we have $\frac{\chi_{a_0}(r)}{r}\rvert_{r=0}=0$, there exists a suitable $\varepsilon_1 > \varepsilon_2 > 0$.
\end{definition}

\begin{figure}\label{fig:SmoothedObsTime}
    \centering
    \input{graphics/SmoothedObsTime.tex}
    \caption{
        Plots of $F_q$ and $H_q$ in the Minkowski case; $a_q$ and $t_q$ are location and value of the unique minimum of $F_q$. We can see that multiplying $F_q$ by $\chi_{a_q}$ diminishes its spike at $a_q$.
    }
\end{figure}

Equipped with these functions we can now define:
\begin{definition}[Smoothed Observation Time Function]
    We define the \emph{smoothed observation time function} as 
    \begin{align*}
        h:D\times \sn &\to [-T_\sn,0] \\
        (q,a)&\mapsto \chi_{a_q}(a)f(q,a)
    \end{align*}
    where $a_q$ is the location of the unique minimum of $F_q$. Note that $h$ is well defined because $\chi_{a_q}(a)\in [0,1]$ for all $a\in \sn$. 
    Analogous to the previous observation time functions we define $h_a(q)\coloneqq h(q,a)$ and $H_q(a)\coloneqq h(q,a)$.
\end{definition}
\begin{remark}
    Note that for $q\in K$ we have $H_q(a)=0$ for all $a\in \sn$. Furthermore, because $\chi_{a_q}$ is smooth and by proposition \ref{prop:fsmooth}, we get that for any $q\in D$, $H_q$ is continuous on $\sn$ and smooth on $\areg(q)$ (where for any $q\in K$ we define $\areg(q)=\sn$).
\end{remark}

We will now show that $H_q$ is regular even at the boundary:
First of all it converges uniformly for any limit point $q_0\in D$.
\begin{proposition}\label{prop:hunif}
    Let $q_n\in D\to q_0\in D$. Then $H_{q_n}\to H_{q_0}$ uniformly.
\end{proposition}
\begin{proof}
    Let $a_n$ resp. $a_0$ be the location of the minimum of $F_{q_n}$ resp. $F_{q_0}$.
    We will again treat the cases $q_0\in K$ and $q_0\in \interior{\jp}$ seperately:
    If $q_0\in \interior{\jp}$ there exists a $N_1\in \N$ such that $q_n \in \interior{\jp}$ for all $n\ge N_1$. We claim that $h:D\cap \interior{\jp}\times \sn$ is a continuous function . This is because $f(q,a)$ is continuous and $q_n\to q_0$ implies $a_n\to a_0$ by the previous lemma, which implies $\chi_{a_n}\to \chi_{a_0}$ because $\chi_a$ varies smoothly in $a\in \sn$. But now we can apply lemma \ref{lem:unifconvoncompact} to get $H_{q_n}\to H_{q_0}$ uniformly.

    Now we treat the case $q_0\in K$. We can again split up $q_n$ into two subsequences $q_{i_n}\in \interior{\jp}$ and $q_{j_n}\in K$. Since we have $H_{q_{j_n}}(a)=0$ for all $a\in \sn$, $H_{q_{j_n}}\to H_{q_0}$ follows immediately since we have $H_{q_0}(a)=0$ for all $a\in \sn$.

    It remains to prove that $H_{q_{i_n}}\to H_{q_0}$ uniformly. To simplify notation we will denote $q_k\coloneqq q_{i_n}$, and $a_k$ for the location of the unique minimum of $F_{q_k}$. We want to show that for every $\varepsilon>0$ there exists a $N\in \N$ such that $H_{a_k}(a)>-\varepsilon$ for all $a\in \sn$.

    To that end let $\varepsilon>0$. Because $q_k\to q_0$ implies $a_k\to a_0$ by proposition \ref{prop:boundarymin}, there exists a $N_1\in \N$ such that $a_k\in B_\frac{\varepsilon}{2}(a_0)$ for all $k\ge N_1$. Hence we have $B_\frac{\varepsilon}{2}(a_0)\subset B_\varepsilon(a_k)$ and we have $\chi_{a_k}(a)<\varepsilon$ for all $a\in B_\frac{\varepsilon}{2}(a_0)\subset B_\varepsilon(a_n)$.
    For any $a\in B_\frac{\varepsilon}{2}(a_0)$ we thus have $H_{q_k}(a) = \chi_{a_k}(a)f(q_k,a) > -\varepsilon$ because $f(q_k,a)\in [-T_\sn,0]$.

    It remains to show that there exists a $N_2\in \N$ such that $H_{q_k}(a) > -\varepsilon$ for all $a\in \sn\setminus B_\frac{\varepsilon}{2}(a_0)$ and $n\ge N_2$. Because $B_\frac{\varepsilon}{2}(a_0)$ is an open neighborhood of we can apply \ref{lem:convto1} to find a $N_2\in \N$ with $F_{q_k}(a) > -\varepsilon$ for all $q\in \sn \setminus B_\frac{\varepsilon}{2}(a_0)$ and $n \ge N_2$. Because $\chi_{a}<1$ this implies $H_{q_k}(a) > -\varepsilon$ and we are done after setting $N\coloneqq  \max \{N_1,N_2\}$.
\end{proof}

\begin{corollary}
    $h:D\times \sn\to [0,1]$ is continuous.
\end{corollary}
\begin{proof}
    Let $(q_n,a_n)\to (q_0,a_0)\in D\times \sn$. The case where $q_0\in \interior{\jp}$ was treated in the proof of the previous proposition. We can thus assume $q_0\in K$. Furthermore we assume $q_n \in \interior{\jp}$ because if $q_n$ has a subsequence in $K$ it is trivial to show that $h$ converges on this subsequence. Because $h(q_0,a_0)=1$ for any $a_0\in \sn$ it remains to show that $h(q_n,a_n)=H_{q_n}(a_n)\to 1$, which follows immediately from the previous proposition.
\end{proof}

We now want to show that $h$ is even smooth on a suitable subset of $D\times \sn$, i.e. the analogue of proposition \ref{prop:fsmooth}. To that end we must first show that the unique minimum of $F_q$ varies smoothly with $q$:
\begin{lemma}\label{lem:minsmooth}
    For every $q\in D\cap \interior{\jp}$ there exists a $\lambda>0$ such that the map 
    \begin{align*}
        a:B_\lambda(q_0)&\to \sn\\
        q&\mapsto \argmin_{a\in \sn} F_q
    \end{align*} is smooth.
\end{lemma}
\begin{proof}
    Let $q_0\in D\cap \interior{\jp}$ with minimum at $a_0\in \sn$. Recall that this implies $a_0\in \areg(q_0)$.
    By proposition \ref{prop:fsmooth} there exists a $\varepsilon>0$ such that $f:\cl{B_\varepsilon(q_0)}\times\cl{B_\varepsilon(a_0)}\to [-T_\sn,0]$ is smooth. Because by definition of $D$, $F_{q_0}$ must have a positive definite hessian at its unique minimu, which is an open property, there exists a $\varepsilon>\delta>0$ such that the map $f:\cl{B_\delta(q_0)}\times\cl{B_\delta(a_0)}\to [-T_\sn,0]$ always has positive definite hessian with respect to $a$ and for every $q\in \cl{B_\delta(q_0)}$ we have $\argmin_{a\in \sn} F_{q}(a) \in \cl{B_\delta(a_0)}$. 

    We then define the function 
    \begin{align*}
        f':\cl{B_\delta(q_0)}\times\cl{B_\delta(a_0)}&\to T^*\sn\\
        (q,a)&\mapsto dF_q\rvert_a
    \end{align*} which is smooth because $f$ is smooth on its domain and has $f'(q_0,a_0)=0$. Furthermore because $f$ has a positive definite hessian with respect to $a$, the non-degeneracy condition of the implicit function theorem is satisfied, and we can find a $\lambda>0$ and a smooth map $q\in B_\lambda(q_0)\mapsto a(q)\in B_\delta(a_0)$ such that $f'(q,a(q))=0$. Because $f$ is positive definite with respect to $a$ on $B_\delta(a_0)$ and by choice of $\delta$, $F_q$ must have its minimum in $B_\delta(a_0)$ and $a(q)$ must be the location of this minimum as desired.
\end{proof}


\begin{corollary}\label{cor:hsmooth}
    Let $\mc{C}\coloneqq \{(q,a)\in V\times \sn \mid q \in D\cap \interior{\jp}, a\in \areg(q)\}$ then $h:\mc{C}\to [-T_\sn,0]$ is a smooth and $dH_q(a)$ is bounded for all $(q,a)\in \mc{C}$.
\end{corollary}
\begin{proof}
    As shown in proposition \ref{prop:fsmooth}, $f$ is smooth on $\mc{C}$. By the previous lemma $q\in D\cap \interior{\jp}\mapsto a(q)$ is smooth as well.
    Hence the map $h(q,a) = \chi_{a(q)}(a)f(q,a)$ is the product of smooth functions making it smooth itself.

    The boundedness of $dH_q(a)$, follows because $dF_q\rvert(a)$ is bounded by proposition \ref{prop:dfbounded} together with the fact that $\chi_{a}$ has bounded derivative because it is smooth on a compact set.
\end{proof}

And finally we conjecture:
\begin{conjecture}\label{conj:dhconvonboundary}
    We can choose $\chi$ such that for all $q_n \to q_0\in K$ we have
    \[
        \max_{a\in \areg(q_n)} \left\lVert dH_{q_n}\rvert_{a_n}\right\rVert_{g_\sn}\to 0.
    \]
\end{conjecture}
\begin{proof}
    Although a full proof of this result was beyond the scope of this thesis we aim to give an idea of the central difficulty and a possible angle of attack:

    Let $q_n\to q_0=\mu_{a_0}(t_0)$ such that $F_{q_n}$ has a unique nondegenerate minimum at $a_n\in \sn$ with observation time $t_n$.
    The main challenge is that we need to be able to very closely describe \emph{how} $dF_{q_n}$ behaves as $q_n\to q_0$ not only close to $a_0$ but globally: We require it go to zero fast enough away from the minimum $a_0$ and to get spiked slow enough around $a_0$ such that multiplying by $\chi_{a_n}$ forces the derivative to go to zero everywhere.

    In the Minkowski case we see that this is the case as $dF_{q_n}$ grows only polynomially and the spike concentrates around $a_n$ polynomially as well. But to transfer this insight to the general case we need to show that $F_{q_n}$ suitably approaches the Minkowski case as $q_n$ approaches $K$. 

    We were so far unable to develop the machinery needed to show this, but a fruitful approach might be to utilize the fact that as $q_n \to q_0\in K$, $\mc{P}_K(q_n)$ increasingly concentrates around the geodesic $\mu_{a_0}([t_0,0])$ which has no cut points as it lies in $K$. If we then can show that the neighborhood of $\mu_{a_0}([t_0,0])$ is suitably close to the Minkowski case we might be able to prove our result.
\end{proof}

\section{Reconstruction}
We can now reconstruct the topological structure of $V$

Analogous to the reconstruction in the previous chapter we let $\mc{C}^{\infty}(\sn)$ be the space of continuous functions $H:\sn \to [-T_\sn,0]$ which are smooth on a dense open set in $\sn$. We again endow this space with the metric 
\[
    d(H_1,H_2)\coloneqq  d_\infty(H_1,H_2) + \int_{\sn} \lVert dH_1\rvert_a - dH_2\rvert_a \rVert_{g_\sn}da,
\] where $d_\infty(H_1,H_2)\coloneqq \max_{a\in \sn}\lvert H_1(a)-H_2(a)\rvert$.
Note that by definition of $\mc{K}(\sn)$ the subset of $\sn$ where $H_1$ or $H_2$ are not smooth is a null set, making the integral well-defined.

For $q\in D$ with minimum $t_q\in [-T_{a_q},0]$ at $a_q\in \sn$ we define
\begin{align*}
    \mathcal{H}:D &\to \mc{S}\times(\mc{K}, d)\\
    q&\mapsto (a_q,t_q, H_q)
\end{align*} where $H_q(a)=h(q,a)$ is the smoothed observation time function.

The follow lemma assures that no information is lost when passing from $F_q$ to $H_q$:
\begin{lemma}
    For any $q\in D$ we can recover $F_q$ given only $\mc{H}(q)$.
\end{lemma}
\begin{proof}
    First of all, given $\mc{H}(q)=(a_q,t_q, H_q)$ we can determine whether $q\in K$ or $q\in \interior{\jp}$, because $q\in K$ if and only if $\min_{a\in \sn} H_q(a)=0$. We can thus treat the cases seperately: If $q\in K$ we have $q=\Theta(a_q,t_q)$ and lemma \ref{lem:boundaryF} allows us to fully reconstruct $F_q$.

    Now for the case where $q\in \interior{\jp}$: We have $H_q(a)=\chi_{a_q}(a)F_q(a)$ and thus $F_q(a) = \frac{1}{\chi_{a_q}(a)}H_q(a)$. This allows us to reconstruct $F_q(a)$ for all $a\neq a_q$ because $\chi_{a_q}(a)\neq 0$ for all $a\neq a_q$. But by definition we have $F_q(a_q)=t_q$ and we have fully  reconstructed $F_q$.
\end{proof}

We denote $V_1\coloneqq V\cap D$.
\begin{lemma}
    $\mc{H}:V_1\to \widehat{V_1}\coloneqq \mc{H}(V_1)\subset \mc{S}\times(\mc{K}, d)$ is well-defined, continuous and bijective.
\end{lemma}
\begin{proof}
    We begin by proving that $\mc{H}$ is well-defined. Because $\mc{H}$ is defined on $D$, any $q\in D$ must have a unique minimum making $q\mapsto(a_q,t_q,H_q)$ well-defined. Furthermore we have $H_q\in \mc{K}(\sn)$ by corollary \ref{cor:hsmooth}, together with the fact that $H_q=1$ is also smooth for $q\in K$.

    Now we want to prove that for any $q_n\to q_0\in V_1$ with unique minima at $(a_n,t_n)$ resp. $(a_0,t_0)$ we have $(a_n,t_n) \to (a_0,t_0)$ and $d(q_n,q_0)\to 0$. By proposition \ref{prop:globalminconv} we have $(a_n,t_n) \to (a_0,t_0)$.
    
    By proposition \ref{prop:hunif} we have $H_{q_n}\to H_{q_0}$ uniformly, which implies $d_\infty(H_{q_n},H_{q_0})\to 0$. It remains to show $\int_{\sn} \lVert dH_{q_n}\rvert_a - dH_{q_0}\rvert_a \rVert_{g_\sn}da \to 0$. We again treat the cases $q_0\in K$ and $q_0\in \interior{\jp}$ seperately: If $q_0\in \interior{\jp}$ we can assume without loss of generality that $q_n\in \interior{\jp}$ as well. Then we can use corollary \ref{cor:hsmooth} and an analogous argument to the one used in lemma \ref{lem:Fprop} to show that $\int_{\sn} \lVert dH_{q_n}\rvert_a - dH_{q_0}\rvert_a \rVert_{g_\sn}da \to 0$.

    It remains to show that 
    \[
        \int_{\sn} \lVert dH_{q_n}\rvert_a - dH_{q_0}\rvert_a \rVert_{g_\sn}da = \int_{\sn} \lVert dH_{q_n}\rvert_a - 0\rVert_{g_\sn}da \to 0
    \] for $q_0\in K$. But this follows immediately from lemma \ref{conj:dhconvonboundary}.

    Finally we show that $\mc{H}$ is injective. Note that we proved in the previous lemma that $\mc{H}(q)=(a_q,t_q,H_q)$ allows us to determine whether $q\in K$ of $q\in \interior{\jp}$.
    If $q\in K$ we have $q = \Theta(a_q,t_q)$ making $\mc{H}$ injective on the boundary. If $q\in \interior{\jp}$, the previous lemma allows us to reconstruct $F_q$ and thus $\ee(q)$. Because $q\in V$ we can apply proposition \ref{prop:einj} proving that $\mc{H}$ is injective.
\end{proof}

\begin{lemma}
    Let $q_n \in V_1$ such that $\mc{H}(q_n)\to \mc{H}(q_0)$ in $\widehat{V_1}$ for some $q_0\in V_1$. Then also $q_n \to q_0$.
\end{lemma}
\begin{proof}
    By definition we have $\mc{H}(q_n) = (a_n,t_n,H_{q_n}) \to (a_0,t_0,H_{q_0}) = \mc{H}(q_0)$. Because we can determine from $\mc{H}(q_0)$ whether $q_0\in K$ or $q_0\in \interior{\jp}$ we can treat the two cases seperately. 
    If $q_0\in \interior{\jp}$ we have $\min_{a\in \sn} H_{q_0}(a) < 1$, then by uniform convergence there exists a $N_1\in \N$ such that $\min_{a\in \sn} H_{q_n}(a)<0$, implying $q_n\in \interior{\jp}$ for all $n \ge N_0$. We can then apply an analogous argument to the one used in lemma \ref{lem:frevcont} to get $q_n \to q_0$.

    For the case $q_0\in K$ we can again split up $\mc{H}(q_n)$ into two subsequences, $\mc{H}(q_{i_n})$ where $q_{i_n}\in K$ and $\mc{H}(q_{j_n})$ where $q_{j_n}\in \interior{\jp}$ for all $n\in \N$. We thus have $q_{i_n}=\Theta(a_{i_n},t_{i_n})$ which implies $q_{i_n}\to q_0$ because $(a_{i_n},t_{i_n}) \to (a_0,t_0)$. For the other case we denote $q_k\coloneqq q_{j_n}\in \interior{\jp}$ and $(a_k,t_k)\coloneqq (a_{j_n},t_{j_n})$ to simplify notation. Because $H_{q_k}\to H_{q_0}=0$ uniformly and there exists a $\varepsilon>0$ such that $H_{q_k}\rvert_{\sn\setminus B_\varepsilon(a_k)} = F_{q_k}\rvert_{\sn\setminus B_\varepsilon(a_k)}$ we also have $\max_{a\in \sn} F_{q_k}\to 0$. This implies that $d(q_k, K)\to 0$. Now we suppose by contradiction that $q_k$ does not converge to $q_0$. We thus have a convergent subsequence $q_j\to q'\neq q_0\in K$ and $a_j\to a_0, t_j\to t_0$. We can the apply proposition \ref{prop:globalminconv} to $q_j$ and $q'$ to find that $(a_0,t_0)$ is also the unique minimum of $F_{q'}$. But because $q'\in K$ we have $q' = \Theta(a_0,t_0) = q_0$, a contradiction.
\end{proof}

\begin{corollary}\label{cor:Hhomeo}
    $\mc{H}:V_1 \to \widehat{V_1}$ is a homeomorphism.
\end{corollary}

\subsection{Combining boundary and interior reconstruction}
Now that we have shown how we can reconstruct the topology close to and at the observation set $K$, i.e. on $V_1\coloneqq V\cap D$, we now aim to show how we can reconstruct it away from the observation set, i.e. on $V_2\coloneqq V \setminus K$. Finally we then will recombine the two procedures to reconstruct the topology on all of $V$.

\begin{remark}
    To reconstruct $V_2=V \setminus K$ we simply reuse the procedure developed in the previous chapter.
    As noted in remark \ref{rmk:ReconstrPastBoundary}, we can use corollary \ref{cor:Fhomeo} on $V_2=V\cap (\jp\setminus K)$ to get a homeomorphism $\F:V_2\to \widehat{V_2}\coloneqq \F(V_2)$.
\end{remark}

We now highlight the following important properties of $V_1,V_2$:
\begin{remark}
    By proposition \ref{prop:globalminconv} we know that $D$ is an open neighborhood of $K\setminus \{p^+\}$. Therefore $V_1=D\cap V$ and $V_2=(\jp\setminus K) \cap V$ are both open subsets of $\jp$ and we have $V_1 \cup V_2 = V$ because $V\subset \jp \setminus\{p^+\}$.
\end{remark}

Thanks to these properties can now reconstruct the topology on $V$:
\begin{lemma}
    A set $O\subset V$ is open if and only if $\mc{H}(O\cap V_1)\subset \widehat{V_1}$ and $\F(O\cap V_2)\subset \widehat{V_2}$ is open.
\end{lemma}
\begin{proof}
    For the first direction we suppose that $O\subset V$ is open. Because $V_1$ and $V_2$ are open so are $O\cap V_1$ and $O\cap V_2$. But because both $\mc{H}$ and $\F$ are homeomorphisms and thus open maps, $\mc{H}(O\cap V_1)$ and $\mc{F}(O\cap V_2)$ must be open as well.

    For the other direction we assume that $\mc{H}(O\cap V_1)$ and $\mc{F}(O\cap V_2)$ are open. Because $\mc{H}$ and $\mc{F}$ are bijective and continuous, $O\cap V_1$ and $O\cap V_2$ must be open as well. Furthermore we have $V_1\cup V_2 = V$ and thus 
    \[
        O = O\cap V = O \cap (V_1\cup V_2) = (O\cap V_1) \cup (O\cap V_2)
    \] must be open, as desired.
\end{proof}

\begin{proposition}
    Given data \ref{rmk:data} we can determine the topology on $V$, i.e. for a subset $\mc{O}\subset V$ we can determine whether it is open, given the set $\mc{P}_K(O)$.
\end{proposition}
\begin{proof}Suppose we are given the data from \ref{rmk:data} and the light observation set $\mc{P}_K(\mc{O})=\{\mc{P}_K(q)\mid q\in \mc{O}\}$ of a subset $\mc{O}\subset V$. For any $\mc{P}_K(q)\in \mc{P}_K(\mc{O})$ we can first evaluate if $q\in V\setminus K$ and $q\in D$ by checking if $F_q$ is continuous in $a$ and if it has a unique minimum. If $q\in D$ we can construct $H_q$; note that $F_q$ and $H_q$ are completely determined by $\mc{P}_K(q)$ and the data. This allows us to construct $\mc{H}(\mc{O}\cap V_1)=\{H_q \mid q\in V \cap D\}$ and $\mc{F}(\mc{O}\cap V_2)=\{F_q \mid q\in V \cap (\jp\setminus K)\}$. Because we know the topology on $\widehat{V_1}$ and $\widehat{V_2}$ we can determine if $\mc{H}(\mc{O}\cap V_1)\subset \widehat{V_1}$ and $\mc{F}(\mc{O}\cap V_2)\subset\widehat{V_2}$ are open. By the previous lemma this allows us to determine whether $\mc{O}$ was open. Therefore we know all open subsets of $V$ and with it the topology of $V$.
\end{proof}

\section{Smooth and Conformal Reconstruction}
As mentioned in the introduction the smooth and conformal reconstruction in the boundary case was beyond the scope of this paper. We do however conjecture that the reconstruction remains possible in this case as well, and want to sketch a possible proof:
\begin{conjecture}[Full Boundary Reconstruction]
    Let $(M_j,g_j), p^\pm_j$ as in theorem \ref{thm:bdreconstr}. Let now $V_j\subset J(p_j^-,p_j^+) \setminus p_j^+$ be open sets. We assume that no null geodesic starting in $V_j$ has a null conjugate point on $K_j$. 
    
    Then, if 
    \[
    \widetilde{\Phi}(\mc{P}_{K_1}(V_1)) = \mc{P}_{K_2}(V_2)
    \]
    there exists a conformal diffeomorphism $\Phi:V_1\to V_2$ that preserves causality.
\end{conjecture}

The main challenge here is the differential reconstruction: We can again proceed by looking at $V_1 = D\cap V$ and $V_2=(\jp \setminus K)\cap V$ seperately. For the second case concerning $V_2$ we should be able to again use the interior reconstruction to determine the differential structure around point away from $K$.

As in the topology reconstruction the recovery of the differential structure on $D$ should be more challenging: We need to find locally smooth coordinates on $D$ which extend smoothly to the boundary and can be determined by the data. But here we actually already laid some groundwork: In the proof of proposition \ref{prop:boundarymin} we defined a map 
\begin{align*}
    X:\R_+\times \mc{S} &\to M \\
    (c,a,t)&\mapsto \exp_{\Theta(a,t)}(-c\nu_{a,t})
\end{align*}which for any $q_0\in K$, after suitably restricting the domain, was a diffeomorphism onto an open neighborhood $q_0\in O \subset \jp$. This implies that in a suitable neighborhood of the boundary $K$, the distance $c$ to $K$ as well as the location $a$ and value $t$ of the unique minimum define smooth coordinates. However, while for any $q\in V$ we can determine whether $F_q$ has a unqiue minimum and if it does the location and value of it as well from the light observation sets, there is no a priori way do determine the \emph{distance} of some $q\in V$ to $K$ from the light observations. 

To solve this issue we introduce a proxy for the distance which should work if $q\in V$ is close enough to the boundary: For $q\in D$ with unique minimum at $(a_q,t_q)\in \mc{S}$ we define the map
\[
    d(q)\coloneqq  \left(\frac{1}{\det \mc{H}_{F_q}(a_q)}\right)^{\frac{1}{c}} \text{ if }q\in \interior{\jp} \text{ and }d(q)\coloneqq 0 \text{ if }q\in K
\] where $\mc{H}_{F_q}$ again is the hessian of $F_q$ and $c\in N$ a suitable constant.
This map is well-defined because $a_q$ must be a regular point ensuring $F_q$ is smooth at $a_q$ and in the proof of proposition \ref{prop:globalminconv} we saw that $\mc{H}_{F_q}(a_q)$ must be positive definite making $\frac{1}{\det \mc{H}_{F_q}(a_q)}$ positive and finite. Furthermore we note that this definition is coordinate independent. Importantly, because we know $F_q$ we can determine $d(q)$ from the light observation sets as desired. We now conjecture that 
\begin{conjecture}
    For a suitable open neighborhood $\mc{O}$ of $K$, the map 
    \begin{align*}
        x:\mc{O}&\to \R \times \sn \times \R\\
        q &\mapsto (d(q),a_q,t_q)
    \end{align*} is a diffeomorphism onto its image.
\end{conjecture}
This is supported by lemma \ref{lem:minsmooth} which shows that the map $q\mapsto a_q$ is smooth on the interior, as required. Because the light observations allow us to determine $x$ on all of $V\cap D$ we can presumably identify all points where $x$ fails to be injective and so determine a suitable $\mc{O}$ from the data, allowing us to determine the differential structure of $V$ in a neighborhood of $K$ as desired.

Finally for the conformal reconstruction we note that for $q\in \jp\setminus K$ we can determine the light cone just as in the interior reconstruction case. And for point $q\in K$ we can calculate the light cone as the limit of neighboring cones.

\begin{remark}
    For the sake of completeness we also note that another approach might be the coordinates 
    \begin{align*}
        Z:D &\to \R \times \sn \times \R \\
        q & \mapsto \left(\max_{a\in \sn}F_q(a), \argmin_{a\in \sn}F_q(a), \min_{a\in \sn}F_q(a)\right).
    \end{align*}
    This is because, similar to the inverse determinant of the hessian at the minimum, the global maximum of $F_q$ might be a good proxy for the distance of $q\in V$ to $K$ as well.

    It remains to be seen which approach will prove more fruitful.
\end{remark}