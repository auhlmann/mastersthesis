\chapter{Interior Reconstruction}

\section{Topology Reconstruction}
We aim to reconstruct the topological and differential data of $V$. To that end we define the following functions.

For $q\in V$ we define the function $F_q:\sn\to\R$ by $a\mapsto f_a(q)$. We can then define the function 
\begin{align*}
    \mathcal{F}:V &\to (C(\sn),d_{\infty})\\
    q&\mapsto F_q
\end{align*} mapping a $q\in V$ to the function $F_q:\sn\to\R$. $(C(\sn),d_{\infty})$ is the space of continuous functions from $\sn$ to $\R$, together with the metric $d_\infty(f,g)=\max_{a\in \sn} \rvert f(a)-g(a) \lvert$.

The following proposition establishes that the canonical topological structure on $\mc{F}(V)$, i.e. the topology obtained by taking the subspace topology wrt. the topology induced by $d_\infty$ on $C(\sn)$, is the same as the pushforward under $\mc{F}$ of the topology on $V$, making $\mc{F}$ a homeomorphism.
((Explain that data allows us to determine $d_\infty$ ))
\begin{lemma}\label{lem:Fprop}
The map $\mathcal{F}:V\to\widehat{V}:=\mathcal{F}(V)$ is a well-defined continuous and injective.
\end{lemma}
\begin{proof}
First of all $\F:V\to (C(\sn),d_\infty)$ is well-defined by proposition \ref{prop:fcont}, i.e. for any $q\in V$, $F_q=f(q,\cdot)$ is continuous on $\sn$.

Because the topology induced on $C(\sn)$ by $d_\infty$ is uniform convergence, proposition \ref{prop:funif} implies that $\mc{F}$ is continuous.

Finally injectivity follows from the fact that for any $q,q'\in V$ we have $\F(q)=\F(q')\implies F_q = F_{q'} \implies \ee(q) = \ee(q')$ which implies $q = q'$ by proposition \ref{prop:einj}.
\end{proof}

However there is still some work required to show that also $\F^{-1}$ is continous on $\widehat{V}$:
\begin{proposition}\label{prop:frevcont} Let 
    $(q_n)_{n=1}^{\infty}$ be a sequence in $V$ and $q_0\in V$ such that $F_{q_n}\to F_{q_0}$ uniformly then $q_n \to q_0$ as $n\to \infty$.
\end{proposition}
\begin{proof}
    Let $(q_n)_{n=1}^\infty, q_0 \in V$ such that $F_{q_n}\to F_{q_0}$ uniformly. Note that because $\F$ is injective the choice of $q_n$ for $F_{q_n}=\F(q_n)$ is unambigous.

    Let $t_0 = \max_{a\in \sn} F_{q_0}(a)$, because $q_0\in V$, lemma \ref{lem:Kcharact}(3) implies that $t_0<1$. Hence there exists an $\varepsilon>0$ such that $t':=t_0 + \varepsilon < 1$. And because $F_{q_n}$ to $F_{q_0}$ uniformly there exists a $N\in \N$ such that $t_n:=\max_{a\in \sn} F_{q_n}(a)<t'$ for all $n \ge N$. 

    We now define 
    \[
        C_{t'}:=\{q\in \jp \mid \max_{a\in \sn} F_q(q)\leq t'\}   
    \] and after removing the first $N$ elements of $(q_n)_{n=1}^\infty$ we may assume $q_n, q_0\in C_{t'}$.

    We now show that $C_{t'}\subset \jp$ is closed: Let $p_n \to p_0 \in \jp$ with $p_n \in C_{t'}$. We must have $p_0\in \interior{\jp}$ because otherwise $\max_{a\in \sn} F_{p_n}(a)\to 1 > t'$. Because $p_n, p_0$ does not necessarily lie in $V$ we but we still want to use all the machinery we built up so far we now look at $V_0:= \interior{\jp}$. We can do this because all results were stated in terms of any arbitrary $V\subset \interior{\jp}$ which includes the case $V_0 = \interior{\jp}$. We then apply proposition \ref{prop:funif} to $V_0$, to get $F_{p_n} \to F_{p_0}$ uniformly. This in turn implies $\max_{a\in \sn}F_{p_n} \to \max_{a\in \sn}F_{p_0}$ and because $p_n\in C_{t'}$ we have $\max_{a\in \sn}F_{p_n}\leq t'$ for all $n$ and hence also $\max_{a\in \sn}F_{p_0}\leq t'$. This proves $p_0\in C_{t'}$ making $C_{t'}$ closed.

    Now $C_{t'}$ is a closed subset of a compact space and thus itself compact. Again using $V_0$ and the previous lemma we get that $\F:V_0 \to \F(V_0)$ is well-defined continuous and injective. We can then restrict $\F$ to $C_{t'}$ and all these properties are preserved. But now $\F:C_{t'}\to \F(C_{t'})$ is a continuous, injective map from a compact space to a hausdorff space, making it a homeomorphism. 
    
    Because $q_n,q_0\in C_{t'}$ for all $n$, we have $F_{q_n}=\F(q_n)\to F_{q_0} = \F(q_0)\in \F(C_{t'})$. Using that $\F^{-1}$ continuous on $\F(C_{t'})$ we get
    \[
        q_n = \mc{F}^{-1}(F_{q_n}) \to \mc{F}^{-1}(F_{q_0}) = q_0,
    \] as desired.
\end{proof}

And we get:
\begin{corollary}
    $\F:V\to \widehat{V}$ is a homeomorphism.
\end{corollary}


\section{Smooth Reconstruction}
Having established the topological structure of $V$ we next aim to establish coordinates on $\F(V)$ near any $\F(q)$ that make $\F(V)$ diffeomorphic to $V$.

\subsection{Preliminaries}

\begin{definition}[Coordinates on $V$]
We first define 
\[
    \mc{Z} = \{(q,p)\in V\times K \mid p\in \mc{E}_U^{reg}(q)\}.
\] 
Then for every $(q,p)\in \mc{Z}$ there is a unique $w\in L^+_qM$ such that $\gamma_{q,w}(1)=p$ and $\rho(q,w)>1$. Existence follows from lemma \ref{lem:observationtime} while uniqueness follows from the fact that $p\in \mc{E}_U^{reg}(q)$ and thus cannot be a cut point. 
We can then define the map
\begin{align*}
    \Omega:\mc{Z}&\mapsto L^+V\\
    (q,p)&\mapsto (q,w)
\end{align*}
Note that this map is injective.
Below we will $\mc{W}_\varepsilon(q_0,w_0)\subset TM$ be a $\varepsilon$-neighborhood of $(q_0,w_0)$ with respect to the Sasaki-metric induced on $TM$ by $g^+$.
\end{definition}

\begin{lemma}((Move to appendix?))The function
    \begin{align*}
        T_+:L^+\jp&\to \R \\
        (q,w)&\mapsto \sup \{ t\ge 0 \mid \gamma_{q,w}(t)\in J^-(p^+)\}
    \end{align*}
    is finite and upper semicontinuous.
\end{lemma}
\begin{corollary}
    Let $(q_n,w_n)$ be a sequence in $L^+\jp$ such that $X(q_n,w_n)=(q_n,p_n)\to (q_0,p_0)$ as $n\to \infty$ then $\lVert w_n \rVert_{g^+}$ is bounded for any riemannian metric on $M$.
\end{corollary}

\begin{lemma}
Let $(q_0,p_0)\in \mc{Z}$ and $(q_0,w_0)=\Omega(q_0,p_0)$. When $\varepsilon>0$ is small enough the map 
\begin{align*}
    X:\mc{W}_\varepsilon(q_0,w_0) &\to M\times M\\
    (q,w) &\mapsto (q,\exp_q(w))
\end{align*}
is open and defines a diffeomorphism $X:\mc{W}_\varepsilon(q_0,w_0)\to \U_\varepsilon(q_0,p_0) \coloneqq X(\mc{W}_\varepsilon(q_0,w_0))$. When $\varepsilon$ is small enough, $\Omega$ coincides in $\mc{Z}\cap \U_\varepsilon(q_0,p_0)$ with the inverse map of $X$. Moreover $\mc{Z}$ is a $(2n-1)$-dimensional manifold and the map $\Omega:\mc{Z}\to L^+M$ is smooth.
\end{lemma}
\begin{proof}
((Works the same with minor adjustments?))
\end{proof}

((Explain what we're doing now))

\begin{proposition}\label{prop:observationtimecoordinates}
Let $q\in V$ and $(q_0,p_j)\in \mc{Z}, j=1,\dots, n$ and $w_j\in L^+_{q_0}M$ such that $\gamma_{q_0,w_j}(1) = p_j$. Assume that $w_j, j=1,\dots, n$ are linearly independent. Then, if $a_j\in A$ and $\overrightarrow{a} = (a_j)^n_{j=1}$ are such that $p_j\in \mu_{a_j}$, there is a neighborhood $V_1\subset M$ of $q_0$ such that the corresponding observation time functions 
\[
\mathbf{f}_{\overrightarrow{a}}(q) = (f_{a_j}(q))^n_{j=1}
\]
define smooth coordinates on $V_1$. Moreover $\nabla f_{a_j}\rvert_{q_0}$, i.e. gradient of $f_{a_j}$ with respect to $q$ at $q_0$, satisfies $\nabla f_{a_j}\rvert_{q_0} = c_jw_j$ for some $c_j\neq 0$.
\end{proposition}
\begin{proof}
((Works almost the same, maybe clarify implicit function theorem stuff))
\end{proof}

\subsection{Reconstruction}

\begin{definition}[Observation Coordinates]
Let $\widehat{q}=\F(q)\in \widehat{V}$ and $\aa = (a_j)^n_{j=1}\subset \ca^n$ with $p_j = \mc{E}_{a_j}(q)$ such that $p_j\in \mc{E}_U^{reg}(q)$ for all $j=1,\dots,n$. Let $s_{a_j} = f_{a_j} \circ \mathcal{F}^{-1}$ and $\mathbf{s}_{\overrightarrow{a}}=\mathbf{f}_{\overrightarrow{a}}\circ\mc{F}^{-1}$. Let $W\subset\widehat{V}$ be an open neighborhood of $\widehat{q}$. We say that $(W,\mathbf{s}_\aa)$ are $C^0$-observation coordinates around $\widehat{q}$ if the map $\mathbf{s}_\aa:W\to \R^n$ is open and injective. Also we say that $(W,\mathbf{s}_\aa)$ are $C^\infty$-observation coordinates around $\widehat{q}$ if $\mathbf{s}_{\overrightarrow{a}}\circ\mc{F}:\mc{F}^{-1}(W)\to \R^n$ are smooth local coordinates on $V\subset M$.
\end{definition}
Note that by the invariance of domain theorem, the above $\mathbf{s}_{\overrightarrow{a}}:W\to \R^n$ is open if it is injective.
Although for a given $\overrightarrow{a}\in \ca^n$ there might be several sets $W$ for which $(W,\mathbf{s}_{\overrightarrow{a}})$ form $C^0$-observation coordinates to clarify the notation we will sometimes denote the coordinates $(W,\mathbf{s}_{\overrightarrow{a}})$ as $(W_{\overrightarrow{a}},\mathbf{s}_{\overrightarrow{a}})$. 

We will consider $\mc{F}(V)$ a topological space and denote $\mc{F}(V)=\widehat{V}$. We denote the points of this manifold by $\widehat{q}=\mc{F}(q)$. Next we construct a differentiable structure on $\widehat{V}$ that is compatible with that of $V$ and makes $\F$ a diffeomorphism.

\begin{proposition}\label{prop:findsmoothcoords}
Let  $\widehat{q}\in \widehat{V}$. 
Then there exist $C^\infty$-observation coordinates $(W_\aa,\mathbf{s}_\aa)$ around $\widehat{q}$.

Furthermore, given the data from \ref{rmk:data} we can determine all $C^0$-observation coordinates around $\widehat{q}$.

Finally given any $C^0$-observation coordinates $(W_\aa,\mathbf{s}_\aa)$ around $\widehat{q}$, the data \ref{rmk:data}, allows us to determine whether they are $C^\infty$-observation coordinates around $\widehat{q}$.
\end{proposition}
\begin{proof}
((Works the same way))
\end{proof}

\subsubsection{Construction of the conformal type of the metric}
We will denote by $\widehat{g}=\F_*g$ the metric on $\widehat{V}=\F$ that makes $\F:V\to \widehat{V}$ an isometry. Next we will show that the set $\F(V)$, the paths $\mu_a$ and the conformal class of the metric on $U$ determine the conformal class of $\widehat{g}$ on $\widehat{V}$.

\begin{lemma}\label{lem:constructmetric}
The data given in \ref{rmk:data} determine a metric $G$ on $\widehat{V}=\F(V)$ that is conformal to $\widehat{g}$ and a time orientation on $\widehat{V}$ that makes $\F:V\to \widehat{V}$ a causality preserving map.
\end{lemma}
\begin{proof}
((Works the same))
\end{proof}